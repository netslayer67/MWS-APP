import{r as o,a as V,d as G,aX as C,j as e,aT as M,aU as _,aV as k,aW as F,m as f,O as g,aY as H,aZ as R,a_ as L,a1 as y,aA as J,a2 as O}from"./index-CDbc_zXv.js";import{B as w}from"./badge-CvvOwRD5.js";import{I as z}from"./input-WSui1mWg.js";import{L as j,M as $}from"./label-BMAG_1va.js";import{S as A,a as S,b as D,c as U,d as m}from"./select-BrdGN_nq.js";import{B as v}from"./building-C8kgP8SH.js";import{G as W}from"./graduation-cap-SYtRdAI4.js";import{U as u}from"./users-KGmu_E7O.js";import{b as X}from"./index-Zu3apAeT.js";import{P as T}from"./plus-DwVGf1Qe.js";import{C as Y}from"./clock-BLTaO-w9.js";import"./chevron-down-BkaM3Wqy.js";const B=o.memo(({user:s,onClose:p})=>{const l=V(),{organizationMembers:x,userOrganizations:d,loading:N}=G(a=>a.users),[h,b]=o.useState("assignments"),[t,r]=o.useState(""),[n,c]=o.useState({name:"",type:"class",parentId:"",metadata:{grade:"",subject:"",capacity:30}});o.useEffect(()=>{s&&l(C(s._id||s.id))},[l,s]);const P=async()=>{if(!(!t||!s))try{await l(R({userId:s._id||s.id,organizationId:t,role:s.role==="teacher"?"teacher":"student"})).unwrap(),l(C(s._id||s.id)),r("")}catch(a){console.error("Failed to assign user:",a)}},E=async()=>{try{await l(L(n)).unwrap(),c({name:"",type:"class",parentId:"",metadata:{grade:"",subject:"",capacity:30}})}catch(a){console.error("Failed to create organization:",a)}},I=a=>{l(H(a))};return e.jsx(M,{open:!0,onOpenChange:p,children:e.jsxs(_,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(k,{children:e.jsxs(F,{className:"flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2"}),"Organization Management - ",s?.name]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex space-x-1 bg-muted/30 p-1 rounded-lg",children:[{id:"assignments",label:"Current Assignments",icon:"ðŸ“‹"},{id:"assign",label:"Assign to Organization",icon:"âž•"},{id:"create",label:"Create Organization",icon:"ðŸ—ï¸"}].map(a=>e.jsxs("button",{onClick:()=>b(a.id),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all ${h===a.id?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx("span",{className:"mr-2",children:a.icon}),a.label]},a.id))}),h==="assignments"&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Current Organization Assignments"}),d?.organizations?.length>0?e.jsx("div",{className:"grid gap-4",children:d.organizations.map(a=>e.jsxs("div",{className:"p-4 border rounded-lg bg-muted/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[a.type==="class"&&e.jsx(W,{className:"w-4 h-4 mr-2 text-blue-500"}),a.type==="department"&&e.jsx(v,{className:"w-4 h-4 mr-2 text-green-500"}),a.type==="team"&&e.jsx(u,{className:"w-4 h-4 mr-2 text-purple-500"}),e.jsx("span",{className:"font-medium",children:a.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground capitalize",children:a.role}),e.jsxs(g,{size:"sm",variant:"outline",onClick:()=>I(a.id),children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"View Members"]})]})]}),a.metadata&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.metadata.grade&&e.jsxs("span",{children:["Grade: ",a.metadata.grade," | "]}),a.metadata.subject&&e.jsxs("span",{children:["Subject: ",a.metadata.subject," | "]}),a.metadata.capacity&&e.jsxs("span",{children:["Capacity: ",a.metadata.capacity]})]}),a.isHead&&e.jsxs("div",{className:"mt-2 text-sm text-green-600 font-medium",children:[e.jsx(X,{className:"w-4 h-4 inline mr-1"}),"Organization Head"]})]},a.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(v,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No organization assignments found"})]}),x&&e.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-blue/5",children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),x.organization?.name," Members"]}),e.jsx("div",{className:"grid gap-2",children:x.members?.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-background/50 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:a.name}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.role,")"]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.department})]},a.id))})]})]}),h==="assign"&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Assign to Organization"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"organization",children:"Select Organization"}),e.jsxs(A,{value:t,onValueChange:r,children:[e.jsx(S,{children:e.jsx(D,{placeholder:"Choose an organization"})}),e.jsxs(U,{children:[e.jsx(m,{value:"org1",children:"Grade 10A - Mathematics"}),e.jsx(m,{value:"org2",children:"Grade 10B - Science"}),e.jsx(m,{value:"org3",children:"Junior High - English"})]})]})]}),e.jsxs(g,{onClick:P,disabled:!t||N,className:"w-full",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Assign User"]})]})]}),h==="create"&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Create New Organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"orgName",children:"Organization Name"}),e.jsx(z,{id:"orgName",value:n.name,onChange:a=>c(i=>({...i,name:a.target.value})),placeholder:"e.g., Grade 10A Mathematics"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"orgType",children:"Type"}),e.jsxs(A,{value:n.type,onValueChange:a=>c(i=>({...i,type:a})),children:[e.jsx(S,{children:e.jsx(D,{})}),e.jsxs(U,{children:[e.jsx(m,{value:"class",children:"Class"}),e.jsx(m,{value:"department",children:"Department"}),e.jsx(m,{value:"team",children:"Team"}),e.jsx(m,{value:"unit",children:"Unit"})]})]})]}),n.type==="class"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"grade",children:"Grade"}),e.jsx(z,{id:"grade",value:n.metadata.grade,onChange:a=>c(i=>({...i,metadata:{...i.metadata,grade:a.target.value}})),placeholder:"e.g., 10A"})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"subject",children:"Subject"}),e.jsx(z,{id:"subject",value:n.metadata.subject,onChange:a=>c(i=>({...i,metadata:{...i.metadata,subject:a.target.value}})),placeholder:"e.g., Mathematics"})]})]})]}),e.jsxs(g,{onClick:E,disabled:!n.name||N,className:"w-full",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Create Organization"]})]})]})]})})});B.displayName="OrganizationAssignmentModal";const Z=o.memo(({user:s,onClose:p})=>{const[l,x]=o.useState(!1);if(!s)return null;const d=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",N=t=>{if(!t)return"N/A";const{years:r,months:n,days:c}=t;return`${r} years, ${n} months, ${c} days`},h=t=>{switch(t){case"directorate":return"gold";case"head_unit":return"purple";case"teacher":case"se_teacher":return"blue";case"staff":return"green";case"support_staff":return"orange";case"student":return"gray";default:return"secondary"}},b=t=>{switch(t){case"directorate":return"Directorate";case"head_unit":return"Head Unit";case"teacher":return"Teacher";case"se_teacher":return"SE Teacher";case"support_staff":return"Support Staff";case"student":return"Student";default:return t?.charAt(0).toUpperCase()+t?.slice(1)}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{open:!0,onOpenChange:p,children:e.jsxs(_,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(k,{children:e.jsxs(F,{className:"flex items-center",children:[e.jsx(y,{className:"w-5 h-5 mr-2"}),"User Details"]})}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsx("p",{className:"text-foreground font-medium",children:s.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Username"}),e.jsx("p",{className:"text-foreground",children:s.username||"Not set"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Email Address"]}),e.jsx("p",{className:"text-foreground",children:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),e.jsx(w,{variant:h(s.role),className:"text-sm",children:b(s.role)})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Organization"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Department"}),e.jsx("p",{className:"text-foreground",children:s.department||"Not assigned"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Unit"}),e.jsx("p",{className:"text-foreground",children:s.unit||"Not assigned"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Job Level"}),e.jsx("p",{className:"text-foreground",children:s.jobLevel||"Not specified"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Job Position"}),e.jsx("p",{className:"text-foreground",children:s.jobPosition||"Not specified"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Employment Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(w,{variant:s.employmentStatus==="Permanent"?"default":s.employmentStatus==="Contract"?"secondary":"outline",children:s.employmentStatus||"Unknown"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Account Status"}),e.jsx(w,{variant:s.isActive?"default":"destructive",children:s.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Working Period"}),e.jsx("p",{className:"text-foreground text-sm",children:N(s.workingPeriod)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Join Date"]}),e.jsx("p",{className:"text-foreground",children:d(s.joinDate)})]}),s.endDate&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"End Date"]}),e.jsx("p",{className:"text-foreground",children:d(s.endDate)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"System Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"User ID"}),e.jsx("p",{className:"text-foreground font-mono text-sm",children:s.id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-foreground text-sm",children:s.updatedAt?d(s.updatedAt):"Unknown"})]})]}),s.createdAt&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Account Created"}),e.jsx("p",{className:"text-foreground text-sm",children:d(s.createdAt)})]})]}),s.classes&&s.classes.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Teaching Assignments"}),e.jsx("div",{className:"space-y-2",children:s.classes.map((t,r)=>{const n=[t.grade,t.className||t.subject].filter(Boolean).join(" â€¢ ");return e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Role: ",t.role||"Teacher"]})]})})},r)})})]}),(s.reportsTo||s.subordinates&&s.subordinates.length>0)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Organizational Hierarchy"}),s.reportsTo&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Reports To"}),e.jsx("div",{className:"p-3 bg-muted/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"w-4 h-4 mr-2 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.reportsTo.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.reportsTo.jobPosition}),s.reportsTo.department&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.reportsTo.department})]})]})})]}),s.subordinates&&s.subordinates.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground",children:["Direct Reports (",s.subordinates.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:s.subordinates.map((t,r)=>e.jsx("div",{className:"p-3 bg-muted/20 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"w-4 h-4 mr-2 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.jobPosition}),t.department&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.department})]})]})},r))})]})]}),s.role==="head_unit"&&s.department&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Department Overview"}),e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["As Head Unit of ",s.department,", you oversee:"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Department:"}),e.jsx("p",{className:"text-muted-foreground",children:s.department})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Unit:"}),e.jsx("p",{className:"text-muted-foreground",children:s.unit||"N/A"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"* Full member details available in the main dashboard"})]})]}),(s.role==="teacher"||s.role==="se_teacher"||s.role==="head_unit"||s.role==="student")&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Organization Assignments"]}),e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:s.role==="teacher"||s.role==="se_teacher"?"Manage this teacher's class assignments, subjects, and homeroom responsibilities.":s.role==="head_unit"?"View and manage department members under this head unit's supervision.":"View this student's class assignments and academic group memberships."}),e.jsxs(g,{onClick:()=>x(!0),className:"w-full",children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),"Manage Assignments"]})]})]}),e.jsx("div",{className:"flex justify-end pt-6 border-t",children:e.jsx(g,{onClick:p,children:"Close"})})]})]})}),l&&e.jsx(B,{user:s,onClose:()=>x(!1)})]})});Z.displayName="UserDetailsModal";export{Z as default};
