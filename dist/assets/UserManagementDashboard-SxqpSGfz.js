const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UserStatsOverview-s1st1ZBE.js","assets/index-BeQwOtyQ.js","assets/index-DGRqQqkd.css","assets/users-BVc-u3T_.js","assets/crown-DTLFpFvV.js","assets/graduation-cap-CfXKwyWW.js","assets/user-check-DEb2rbvH.js","assets/building-DZs_ogcB.js","assets/UserTable-D73ogEk9.js","assets/index-CZajb2CL.js","assets/badge-CKD0dT5b.js","assets/eye-KbYtPAUo.js","assets/UserFilters-CK0tfOVm.js","assets/input-DwpHeulS.js","assets/select-8ieQIdtG.js","assets/chevron-down-B-g9NK3J.js","assets/funnel-JNZh20hC.js","assets/plus-DaQpZkaA.js","assets/download-BHbZywUL.js","assets/search-94GVSrmF.js","assets/UserForm-B0vsEG7R.js","assets/label-sGYZoAUB.js","assets/save-D1LHQOhS.js","assets/OrganizationChart-7wxb8vVy.js","assets/UserDetailsModal-BJUIIvzV.js","assets/clock-iFkKRRSX.js"])))=>i.map(i=>d[i]);
import{r as a,u as L,d as M,b as w,N as h,Z as p,$ as E,a0 as I,a1 as V,a2 as $,a3 as H,j as e,o as W,m as n,A as v,_ as c}from"./index-BeQwOtyQ.js";import{A as S}from"./AnimatedPage-C0IhUWUM.js";const Y=a.lazy(()=>c(()=>import("./UserStatsOverview-s1st1ZBE.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Z=a.lazy(()=>c(()=>import("./UserTable-D73ogEk9.js"),__vite__mapDeps([8,1,2,9,10,11]))),q=a.lazy(()=>c(()=>import("./UserFilters-CK0tfOVm.js"),__vite__mapDeps([12,1,2,13,14,9,15,10,16,17,18,19]))),B=a.lazy(()=>c(()=>import("./UserForm-B0vsEG7R.js"),__vite__mapDeps([20,1,2,13,21,14,9,15,22]))),G=a.lazy(()=>c(()=>import("./OrganizationChart-7wxb8vVy.js"),__vite__mapDeps([23,1,2,7,4,5,3]))),J=a.lazy(()=>c(()=>import("./UserDetailsModal-BJUIIvzV.js"),__vite__mapDeps([24,1,2,10,13,21,14,9,15,7,5,3,17,25]))),m=a.memo(()=>e.jsx("div",{className:"glass glass-card p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted/30 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-2/3"})]})}));m.displayName="LoadingFallback";const K=a.memo(()=>{const t=L(),{toast:r}=M(),{users:y,organizationStructure:l,pagination:f,filters:i,loading:D,error:N,lastUpdated:A}=w(s=>s.users),{user:x}=w(s=>s.auth),[z,u]=a.useState(!1),[g,j]=a.useState(null),[_,U]=a.useState(null),[d,k]=a.useState("overview"),b=x&&(x.role==="directorate"||x.role==="superadmin"||x.role==="admin");a.useEffect(()=>{b&&(t(h(i)),t(p()))},[t,b,i]);const C=a.useCallback(s=>{t(E(s))},[t]),F=a.useCallback(async s=>{try{await t(I(s)).unwrap(),r({title:"Success",description:"User created successfully"}),u(!1),t(h(i)),t(p())}catch(o){r({title:"Error",description:o||"Failed to create user",variant:"destructive"})}},[t,r,i]),O=a.useCallback(async(s,o)=>{try{await t(V({userId:s,userData:o})).unwrap(),r({title:"Success",description:"User updated successfully"}),j(null),u(!1),t(h(i)),t(p())}catch(T){r({title:"Error",description:T||"Failed to update user",variant:"destructive"})}},[t,r,i]),P=a.useCallback(async s=>{if(window.confirm("Are you sure you want to deactivate this user?"))try{await t($(s)).unwrap(),r({title:"Success",description:"User deactivated successfully"}),t(h(i)),t(p())}catch(o){r({title:"Error",description:o||"Failed to deactivate user",variant:"destructive"})}},[t,r,i]),R=a.useCallback(s=>{t(E({...i,page:s}))},[t,i]);return a.useEffect(()=>()=>{t(H())},[t]),b?e.jsxs(S,{children:[e.jsxs(W,{children:[e.jsx("title",{children:"User Management — Millennia World School"}),e.jsx("meta",{name:"description",content:"Advanced user management system for school administration"})]}),e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 w-64 h-64 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-accent/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"User Management Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users, roles, and organizational structure"})]}),e.jsx(v,{children:N&&e.jsx(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:e.jsx("p",{className:"text-destructive text-sm",children:N})})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex space-x-1 bg-muted/30 p-1 rounded-lg",children:[{id:"overview",label:"Overview",icon:"📊"},{id:"users",label:"Users",icon:"👥"},{id:"organization",label:"Organization",icon:"🏢"},{id:"analytics",label:"Analytics",icon:"📈"}].map(s=>e.jsxs("button",{onClick:()=>k(s.id),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all ${d===s.id?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx("span",{className:"mr-2",children:s.icon}),s.label]},s.id))})}),e.jsxs(v,{mode:"wait",children:[d==="overview"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{organizationStructure:l,totalUsers:f.totalUsers,lastUpdated:A})})},"overview"),d==="users"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(q,{filters:i,onFiltersChange:C,onAddUser:()=>u(!0)})}),e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Z,{users:y,loading:D,pagination:f,onPageChange:R,onEditUser:j,onDeleteUser:P,onViewUser:U})})]})},"users"),d==="organization"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(G,{organizationStructure:l,users:y})})},"organization"),d==="analytics"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Department Analytics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l?.stats?.byDepartment?.map(s=>e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s._id}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"members"})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Role Distribution"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:l?.stats?.byRole?.map(s=>e.jsxs("div",{className:"text-center p-4 bg-muted/20 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s._id})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Employment Status"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:l?.stats?.byEmploymentStatus?.map(s=>e.jsxs("div",{className:"text-center p-4 bg-muted/20 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s._id})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Management Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-700 mb-2",children:"Leadership Structure"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Directorate members oversee ",l?.stats?.totalUsers||0," total users across ",l?.stats?.byDepartment?.length||0," departments."]})]}),e.jsxs("div",{className:"p-4 bg-green/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-700 mb-2",children:"Teaching Staff"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l?.stats?.byRole?.find(s=>s._id==="teacher")?.count||0," teachers and ",l?.stats?.byRole?.find(s=>s._id==="se_teacher")?.count||0," SE teachers are actively managing classroom assignments."]})]})]})]})]})},"analytics")]}),e.jsxs(v,{children:[(z||g)&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(B,{user:g,onSubmit:g?O:F,onCancel:()=>{u(!1),j(null)}})}),_&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(J,{user:_,onClose:()=>U(null)})})]})]})]})]}):e.jsx(S,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"glass glass-card p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to access the User Management Dashboard."})]})})})});K.displayName="UserManagementDashboard";export{K as default};
