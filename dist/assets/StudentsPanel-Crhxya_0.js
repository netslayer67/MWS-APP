import{r as s,j as e,m as P,X as Q,b as L,e as D}from"./index-BAvDP42J.js";import{S as E}from"./StudentsTable-DGktmWL2.js";import{u as B}from"./teacherDashboardUtils-J3i_RWGW.js";import{e as O,p as H}from"./interventionUtils-Dp4HTZyD.js";import{F as R}from"./funnel-g3w0Q9em.js";import{S as z}from"./search-DUKK0aNk.js";import"./shield-check-CKrMDfjh.js";const h="px-4 py-3 rounded-2xl bg-white/80 dark:bg-white/10 border border-primary/20 text-sm text-foreground placeholder:text-muted-foreground/70 focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-transparent transition-all w-full",q=["wpm","%","pts","score"],_=s.memo(({student:r,onClose:l,onSubmit:u,submitting:n=!1})=>{const i=s.useMemo(()=>new Date().toISOString().split("T")[0],[]),[o,m]=s.useState({date:i,performed:"yes",scoreValue:"",scoreUnit:"score",notes:"",badge:"ðŸŽ‰ Progress Party"});if(!r)return null;const c=(a,f)=>{m(b=>({...b,[a]:f}))},g=a=>{a.preventDefault(),u?.(r,o)};return e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-center justify-center px-4 mtss-theme",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:l,"aria-hidden":"true"}),e.jsxs(P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-2xl rounded-[28px] overflow-hidden border border-white/40 bg-white/95 dark:bg-slate-900/90 shadow-[0_25px_80px_rgba(15,23,42,0.35)]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#34d399]/80 via-[#22d3ee]/80 to-[#60a5fa]/80 text-white p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"uppercase text-xs tracking-[0.4em] opacity-80",children:"Quick Update"}),e.jsx("h3",{className:"text-2xl font-bold",children:r.name}),e.jsx("p",{className:"text-sm opacity-90",children:"Share today's check-in and celebrations"})]}),e.jsx("button",{onClick:l,"aria-label":"Close",className:"p-2 bg-white/30 rounded-full hover:bg-white/50 transition",disabled:n,children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsxs("form",{className:"p-6 space-y-4",onSubmit:g,children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Date"}),e.jsx("input",{type:"date",className:h,value:o.date,onChange:a=>c("date",a.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Intervention Performed?"}),e.jsxs("select",{className:h,value:o.performed,onChange:a=>c("performed",a.target.value),children:[e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Status or Score"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",className:`${h} flex-1`,placeholder:"e.g. 78",value:o.scoreValue,onChange:a=>c("scoreValue",a.target.value)}),e.jsx("select",{className:`${h} w-28`,value:o.scoreUnit,onChange:a=>c("scoreUnit",a.target.value),children:q.map(a=>e.jsx("option",{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Celebration Emoji"}),e.jsxs("select",{className:h,value:o.badge,onChange:a=>c("badge",a.target.value),children:[e.jsx("option",{value:"ðŸŽ‰ Progress Party",children:"ðŸŽ‰ Progress Party"}),e.jsx("option",{value:"âœ¨ Stellar Boost",children:"âœ¨ Stellar Boost"}),e.jsx("option",{value:"ðŸŒˆ Focus Mode",children:"ðŸŒˆ Focus Mode"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Notes & Observations"}),e.jsx("textarea",{className:`${h} min-h-[120px]`,placeholder:"Describe the student's progress, challenges, or celebrations...",value:o.notes,onChange:a=>c("notes",a.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsx(P.button,{type:"submit",className:"px-5 py-3 rounded-full bg-gradient-to-r from-[#ff58c2] to-[#ffb347] text-white font-semibold shadow-[0_15px_40px_rgba(255,88,194,0.25)] disabled:opacity-60",whileHover:{scale:n?1:1.03},whileTap:{scale:n?1:.97},disabled:n,children:n?"Saving...":"Save Update"}),e.jsx("button",{type:"button",onClick:l,className:"px-5 py-3 rounded-full bg-white/80 dark:bg-white/10 text-foreground font-semibold border border-border/60 disabled:opacity-60",disabled:n,children:"Cancel"})]})]})]})]})});_.displayName="QuickUpdateModal";const K=["All","Tier 1","Tier 2","Tier 3"],w=10,X=({activeTier:r,setActiveTier:l,query:u,setQuery:n})=>e.jsxs("div",{className:"rounded-[28px] border border-white/40 bg-white/90 dark:bg-white/5 p-5 flex flex-col gap-4 shadow-[0_10px_32px_rgba(15,23,42,0.12)]","data-aos":"fade-up","data-aos-delay":"40",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-muted-foreground",children:[e.jsx(R,{className:"w-4 h-4"}),"Quick filters"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:K.map(i=>e.jsx("button",{onClick:()=>l(i),className:`mtss-filter-chip ${r===i?"mtss-filter-chip--active":""}`,"data-aos":"zoom-in","data-aos-delay":"80",children:i},i))}),e.jsxs("div",{className:"relative","data-aos":"fade-up","data-aos-delay":"100",children:[e.jsx(z,{className:"w-4 h-4 absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"Search kids or boost type...",value:u,onChange:i=>n(i.target.value),className:"w-full pl-11 pr-4 py-2.5 rounded-full bg-white/70 dark:bg-white/10 border border-primary/20 focus:ring-2 focus:ring-primary/40 focus:outline-none placeholder:text-muted-foreground/70 dark:placeholder:text-white/40"})]})]}),Y=({visible:r,total:l})=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3","data-aos":"fade-up","data-aos-delay":"60",children:[e.jsxs("div",{children:[e.jsx("p",{className:"uppercase text-xs text-muted-foreground tracking-[0.4em]",children:"Crew Roster"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Kids on your radar today"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("strong",{children:r})," of ",l," filtered students"]})]}),G=({visible:r,total:l,onLoadMore:u})=>e.jsx("div",{className:"flex flex-col items-center gap-2 text-xs text-muted-foreground py-3","data-aos":"fade-up","data-aos-delay":"160",children:r<l?e.jsxs("button",{type:"button",onClick:u,className:"px-4 py-2 rounded-full bg-white/80 dark:bg-white/10 border border-primary/30 text-sm font-semibold text-primary shadow-sm hover:-translate-y-0.5 transition",children:["Load 10 more kids (",r,"/",l,")"]}):e.jsx("span",{className:"px-3 py-1 rounded-full bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-200 border border-emerald-200/70 dark:border-emerald-500/30",children:"All kids loaded"})}),J=s.memo(({students:r,TierPill:l,ProgressBadge:u,onRefresh:n})=>{const i=L(),{toast:o}=D(),[m,c]=s.useState("All"),[g,a]=s.useState(""),[f,b]=s.useState({type:null,student:null}),[T,k]=s.useState(!1),[S,C]=s.useState(w),v=s.useDeferredValue(g.trim().toLowerCase()),p=s.useMemo(()=>r.filter(t=>{const d=O(t.interventions),j=H(d)?.tier||t.tier,M=m==="All"||j===m;if(!v)return M;const V=d.map(I=>I.label).join(" "),A=`${t.name} ${t.type||""} ${t.grade||""} ${t.className||""} ${V}`.toLowerCase();return M&&A.includes(v)}),[r,m,v]),y=s.useMemo(()=>p.slice(0,Math.min(S,p.length)),[p,S]);s.useEffect(()=>{C(w)},[m,v,r.length]);const U=s.useCallback(t=>{i(`/mtss/student/${t.slug}`)},[i]),$=s.useCallback((t,d)=>b({type:t,student:d}),[]),N=s.useCallback(()=>b({type:null,student:null}),[]),F=s.useCallback(async(t,d)=>{if(!t?.assignmentId){o({title:"No active intervention",description:`${t?.name||"Student"} isn't linked to an active intervention yet.`,variant:"destructive"});return}k(!0);try{const x=d.notes?.trim()||"",j=d.scoreValue!==""?Number(d.scoreValue):void 0;await B(t.assignmentId,{checkIns:[{date:d.date,summary:x||"Quick update",nextSteps:x||void 0,value:Number.isFinite(j)?j:void 0,unit:d.scoreUnit,performed:d.performed==="yes",celebration:d.badge}]}),o({title:"Progress update saved",description:`${t.name}'s update was recorded!`}),N(),n?.()}catch(x){o({title:"Failed to save update",description:x?.response?.data?.message||x.message||"Please try again in a moment.",variant:"destructive"})}finally{k(!1)}},[o,N,n]);return e.jsxs("div",{className:"space-y-6 mtss-theme",children:[e.jsx(X,{activeTier:m,setActiveTier:c,query:g,setQuery:a}),e.jsxs("section",{className:"rounded-[32px] border border-white/40 bg-white/95 dark:bg-slate-900/40 p-6 space-y-4 shadow-[0_14px_48px_rgba(15,23,42,0.14)]","data-aos":"fade-up","data-aos-delay":"80",children:[e.jsx(Y,{visible:y.length,total:p.length}),e.jsx("div",{"data-aos":"fade-up","data-aos-delay":"120",children:e.jsx(E,{students:y,TierPill:l,ProgressBadge:u,showActions:!0,onView:U,onUpdate:t=>$("update",t)})}),e.jsx(G,{visible:y.length,total:p.length,onLoadMore:()=>C(t=>Math.min(p.length,t+w))})]}),f.type==="update"&&e.jsx(_,{student:f.student,onClose:N,onSubmit:F,submitting:T})]})});J.displayName="StudentsPanel";export{J as default};
