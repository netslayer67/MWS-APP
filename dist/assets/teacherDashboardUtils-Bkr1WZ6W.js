import{c as C,ad as h,ac as U}from"./index-D-EiwK_h.js";import{S as L}from"./shield-check-DRs9tJTL.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],_=C("clipboard-check",x),g=e=>e?.data?.data||{},b=(e={},r={})=>({params:r,...e}),W=(e={},r={})=>h.get("/mtss/mentor-assignments",b(r,e)).then(g),q=(e={},r={})=>h.get("/mtss/strategies",b(r,e)).then(g),V=(e={},r={})=>h.get("/mtss/students",b(r,e)).then(g),Y=(e,r={})=>h.get(`/mtss/students/${e}`,r).then(g),Q=(e={},r={})=>h.get("/mtss/mentors",b(r,e)).then(g),X=(e,r={})=>h.post("/mtss/mentor-assignments",e,r).then(g),Z=(e,r,a={})=>h.put(`/mtss/mentor-assignments/${e}`,r,a).then(g),w=[{key:"active",label:"Active Interventions",sub:"Kids in a boost bubble",icon:L,accent:"from-[#0ea5e9]/90 via-[#818cf8]/85 to-[#34d399]/80"},{key:"due",label:"Updates Due",sub:"Check-ins waiting today",icon:_,accent:"from-[#fcd34d]/90 via-[#fb923c]/85 to-[#38bdf8]/80"},{key:"success",label:"Success Rate",sub:"Kids hitting targets",icon:U,accent:"from-[#22d3ee]/90 via-[#a855f7]/85 to-[#f472b6]/80"}],$={active:"On Track",paused:"Needs Attention",completed:"Completed",closed:"Closed"},S={active:4,paused:3,completed:2,closed:1},N={"Junior High":["Grade 7","Grade 8","Grade 9"],Elementary:["Grade 1","Grade 2","Grade 3","Grade 4","Grade 5","Grade 6"],Kindergarten:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],Pelangi:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"]},f=e=>e?e.toString().split("-")[0].trim():"",ee=(e={})=>{const a=(Array.isArray(e?.classes)?e.classes:[]).map(i=>f(i.grade)).filter(Boolean),u=N[e?.unit]||[],n=a.length?a:u,l=Array.from(new Set(n.map(f).filter(Boolean)));return{allowedGrades:l,label:l.length?l.join(", "):e?.unit||"All Grades"}},p=(e,r={month:"short",day:"numeric"})=>{if(!e)return"—";try{return new Intl.DateTimeFormat("en-US",r).format(new Date(e))}catch{return"—"}},D=e=>e?e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""):`student-${Math.random().toString(36).slice(2,6)}`,E=(e,r)=>{if(!e)return"Ongoing";const a=new Date(e),u=r?new Date(r):new Date,n=Math.max(1,Math.round((u-a)/(1e3*60*60*24*7)));return`${n} wk${n>1?"s":""}`},B=e=>{if(!e)return"Tier 2";const r=e.toString().toLowerCase();return r.includes("3")?"Tier 3":r.includes("1")?"Tier 1":"Tier 2"},P=e=>e?.focusAreas?.length?e.focusAreas[0]:e?.tier==="tier3"?"Intensive Support":"Literacy & SEL",R=(e,r)=>{const a=[e?.metricLabel,e?.notes,e?.focusAreas?.join(" "),r?.type].filter(Boolean).join(" ").toLowerCase();return/attendance|present|absen/.test(a)?"%":/reading|fluency|literacy|wpm/.test(a)?"wpm":/math|numeracy|accuracy|score/.test(a)?"score":/behavior|sel|conduct|check-in|checkin/.test(a)?"pts":"score"},j=e=>{if(e?.status!=="active")return!1;const r=e?.checkIns?.slice(-1)[0]?.date;return r?(Date.now()-new Date(r).getTime())/(1e3*60*60*24)>=7:!0},O=(e={})=>{const r=e.checkIns||[];if(r.length){const l=r.length;return r.map((i,t)=>{const s=Math.round((t+1)/l*100),c=p(i.date);return{label:c,date:c,reading:s,goal:100,value:s}})}const a=e.goals||[];if(a.length){const l=a.length;let i=0;return a.map((t,s)=>{t.completed&&(i+=1);const c=Math.round(i/l*100),o=t.description||`Goal ${s+1}`;return{label:o,date:o,reading:c,goal:100,value:c}})}const u=e.status==="completed"?100:0,n=p(e.startDate);return[{label:n,date:n,reading:u,goal:100,value:u}]},F=(e={})=>(e.checkIns||[]).slice(-6).reverse().map(r=>({date:p(r.date,{month:"short",day:"numeric",year:"numeric"}),score:"—",notes:r.summary||r.nextSteps||"Check-in recorded"})),H=e=>{const r=e?.checkIns?.slice(-1)[0]?.date||e?.startDate;if(!r)return"Awaiting update";const a=new Date(r);return a.setDate(a.getDate()+7),p(a)},te=(e=[])=>{const r=e.filter(s=>s.status==="active").length,a=e.filter(j).length,u=e.reduce((s,c)=>s+(c.goals?.length||0),0),n=e.reduce((s,c)=>s+(c.goals?.filter(o=>o.completed).length||0),0),l=u||e.length||1,i=e.filter(s=>s.status==="completed").length,t=Math.round((n||i)/l*100);return[{...w[0],value:r},{...w[1],value:a},{...w[2],value:`${Number.isFinite(t)?t:0}%`}]},re=(e=[],r="MTSS Mentor")=>{const a=new Map;e.forEach(t=>{const s=P(t),c=B(t.tier),o=t.status||"active",G=H(t),k=O(t),v=F(t),m=t.goals||[],T=m.filter(d=>d.completed).length;(t.studentIds||[]).forEach(d=>{const y=d?._id?.toString?.()||d?.id||d;if(!y)return;const I=f(d?.currentGrade||d?.classes?.[0]?.grade||d?.unit||d?.class||"-"),M=R(t,d),K={id:y,assignmentId:t._id?.toString?.()||null,slug:d?.slug||D(d?.name),name:d?.name||"Student",grade:I,type:s,tier:c,progress:$[o]||"On Track",nextUpdate:G,statusKey:o,profile:{teacher:r,mentor:t.mentorId?.name||r,type:s,strategy:t.focusAreas?.join(", ")||`Support focus - ${c}`,started:p(t.startDate),duration:E(t.startDate,t.endDate),baseline:m.length?0:null,current:m.length?T:t.checkIns?.length||(o==="completed"?1:0),target:m.length||Math.max(t.checkIns?.length||1,1),progressUnit:M,chart:k,history:v}},A=a.get(y);(!A||S[o]>S[A.statusKey])&&a.set(y,K)})});const n=Array.from(a.values()).sort((t,s)=>S[s.statusKey]-S[t.statusKey]),l=n[0]?.profile?.chart||[],i=n[0]?`${n[0].tier} ${n[0].type}`:null;return{students:n.map(({statusKey:t,...s})=>s),spotlightChart:l,focusLabel:i}},ae=(e=[],r=[],a={allowedGrades:[]})=>{const u=new Map(r.map(t=>[t.id?.toString?.()||t.slug||t.name,t])),n=a.allowedGrades||[],l=t=>!n.length||n.includes(f(t)),i=e.map(t=>{const s=t.id?.toString?.()||t._id?.toString?.()||t.slug||t.name,c=f(t.grade||t.currentGrade||t.className||"-");if(!l(c))return null;const o=u.get(s);return{id:s,slug:t.slug||D(t.name),name:t.name,grade:c,className:t.className,type:o?.type||t.type||"Universal Supports",tier:o?.tier||t.tier||"Tier 1",progress:o?.progress||t.progress||"Not Assigned",nextUpdate:o?.nextUpdate||t.nextUpdate||"Not scheduled",assignmentId:o?.assignmentId||null,profile:o?.profile||t.profile}}).filter(Boolean);return!i.length&&r.length?r:i},se=()=>{try{return JSON.parse(localStorage.getItem("auth_user")||"null")}catch{return null}};export{_ as C,V as a,te as b,ae as c,ee as d,Q as e,W as f,se as g,X as h,Y as i,q as j,re as m,f as n,Z as u};
