import{r as d,j as e,T as c}from"./index-BeQwOtyQ.js";import z from"./ExportButton-3nmDXr4C.js";import{U as T}from"./UserListModal-pUTwf5ht.js";import{T as W}from"./target-COXJBIfx.js";import{U as D}from"./users-BVc-u3T_.js";import{R as b}from"./CategoricalChart-BMqhUz2Q.js";import{P as N,a as w}from"./PieChart-sikPtFhh.js";import{C as v}from"./tooltipContext-DiIpVtEU.js";const E=d.memo(({data:o={},period:y})=>{const[n,i]=d.useState({isOpen:!1,title:"",users:[],totalUsers:0,type:""}),s=d.useMemo(()=>{if(!o)return null;const t=o.totalUsers||0,l=o.totalCheckins||0,R=o.submissionRate||0,m=o.flaggedUsers?.length||0,x=t>0?Math.round(m/t*100):0,L=100-x,M=R,u=o.moodDistribution||{},h=Object.values(u).reduce((r,a)=>r+a,0),$=Object.entries(u).map(([r,a])=>({mood:r.charAt(0).toUpperCase()+r.slice(1),count:a,percentage:h>0?Math.round(a/h*100):0})).sort((r,a)=>a.percentage-r.percentage),g=o.weatherDistribution||{},p=Object.values(g).reduce((r,a)=>r+a,0),O=Object.entries(g).map(([r,a])=>({weather:r.charAt(0).toUpperCase()+r.slice(1),count:a,percentage:p>0?Math.round(a/p*100):0})).sort((r,a)=>a.percentage-r.percentage),f=o.roleBreakdown||[],j=f.reduce((r,a)=>r+(a.count||0),0),A=f.map(r=>({role:r.role||"Unknown",count:r.count||0,percentage:j>0?Math.round(r.count/j*100):0})).sort((r,a)=>a.percentage-r.percentage);return{participationRate:M,flaggedPercentage:x,readinessPercentage:L,moodPercentages:$,weatherPercentages:O,rolePercentages:A,totalUsers:t,totalCheckins:l,flaggedUsers:m,moodLists:o.moodLists||{},weatherLists:o.weatherLists||{},roleLists:o.roleLists||{}}},[o]),P=t=>{i({isOpen:!0,title:`${t.mood} Mood Users`,users:s.moodLists[t.mood.toLowerCase()]||[],totalUsers:s.totalCheckins,type:"mood"})},U=t=>{i({isOpen:!0,title:`${t.weather} Weather Users`,users:s.weatherLists[t.weather.toLowerCase()]||[],totalUsers:s.totalCheckins,type:"weather"})},C=t=>{i({isOpen:!0,title:`${t.role} Role Users`,users:s.roleLists[t.role.toLowerCase()]||[],totalUsers:s.totalCheckins,type:"role"})},k=()=>{i({isOpen:!1,title:"",users:[],totalUsers:0,type:""})};return s?e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:"Overview Analytics"})]}),e.jsx(z,{period:y})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Participation Rate"}),e.jsx(D,{className:"w-4 h-4 text-emerald-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[s.participationRate,"%"]}),e.jsx("div",{className:"w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 transition-all duration-500 ease-out",style:{width:`${s.participationRate}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.totalCheckins," of ",s.totalUsers," users"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Emotional Readiness"}),e.jsx(c,{className:"w-4 h-4 text-emerald-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[s.readinessPercentage,"%"]}),e.jsx("div",{className:"w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 transition-all duration-500 ease-out",style:{width:`${s.readinessPercentage}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.totalUsers-s.flaggedUsers," of ",s.totalUsers," users ready"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-white/20 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Top Mood"}),e.jsx(c,{className:"w-4 h-4 text-blue-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[s.moodPercentages[0]?.percentage||0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s.moodPercentages[0]?.mood||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.moodPercentages[0]?.count||0," responses"]}),s.moodPercentages[0]?.count===0&&e.jsx("div",{className:"mt-2 w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gray-400 to-gray-300 w-full"})})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Top Weather"}),e.jsx(c,{className:"w-4 h-4 text-purple-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[s.weatherPercentages[0]?.percentage||0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s.weatherPercentages[0]?.weather||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.weatherPercentages[0]?.count||0," responses"]}),s.weatherPercentages[0]?.count===0&&e.jsx("div",{className:"mt-2 w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gray-400 to-gray-300 w-full"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Mood Distribution"}),e.jsx("div",{className:"h-48",children:e.jsx(b,{width:"100%",height:"100%",children:e.jsx(N,{children:e.jsx(w,{data:s.moodPercentages.slice(0,5),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"count",onClick:P,style:{cursor:"pointer"},children:s.moodPercentages.slice(0,5).map((t,l)=>e.jsx(v,{fill:`hsl(${l*60}, 70%, 50%)`,style:{cursor:"pointer"}},`mood-${l}`))})})})}),e.jsx("div",{className:"mt-2 space-y-1",children:s.moodPercentages.slice(0,5).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${l*60}, 70%, 50%)`}}),e.jsx("span",{className:"text-foreground capitalize",children:t.mood})]}),e.jsxs("span",{className:"text-muted-foreground",children:[t.percentage,"% (",t.count,")"]})]},t.mood))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Weather Distribution"}),e.jsx("div",{className:"h-48",children:e.jsx(b,{width:"100%",height:"100%",children:e.jsx(N,{children:e.jsx(w,{data:s.weatherPercentages.slice(0,5),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"count",onClick:U,style:{cursor:"pointer"},children:s.weatherPercentages.slice(0,5).map((t,l)=>e.jsx(v,{fill:`hsl(${l*45+180}, 70%, 50%)`,style:{cursor:"pointer"}},`weather-${l}`))})})})}),e.jsx("div",{className:"mt-2 space-y-1",children:s.weatherPercentages.slice(0,5).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${l*45+180}, 70%, 50%)`}}),e.jsx("span",{className:"text-foreground capitalize",children:t.weather})]}),e.jsxs("span",{className:"text-muted-foreground",children:[t.percentage,"% (",t.count,")"]})]},t.weather))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Role Distribution"}),e.jsx("div",{className:"space-y-2",children:s.rolePercentages.slice(0,5).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between cursor-pointer hover:bg-muted/20 p-1 rounded transition-colors",onClick:()=>C(t),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${l*72+90}, 70%, 50%)`}}),e.jsx("span",{className:"text-sm text-foreground capitalize",children:t.role})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-muted/30 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent transition-all duration-500 ease-out",style:{width:`${t.percentage}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground w-8 text-right",children:[t.percentage,"%"]})]})]},t.role))})]})]})]}),e.jsx(T,{isOpen:n.isOpen,onClose:k,title:n.title,users:n.users,totalUsers:n.totalUsers,type:n.type})]}):null});E.displayName="PercentageAnalytics";export{E as default};
