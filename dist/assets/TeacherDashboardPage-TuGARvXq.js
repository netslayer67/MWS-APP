const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardOverview-BemdTvw0.js","assets/index-B1azmWwg.js","assets/index-D2nyVmn2.css","assets/StudentsTable-BHK1312E.js","assets/interventionUtils-Dp4HTZyD.js","assets/chevron-left-TB_yw64x.js","assets/CategoricalChart-aA7aERj5.js","assets/LineChart-BHCfHX5b.js","assets/ActivePoints-MEc8OUnh.js","assets/ErrorBarContext-GazER3Rh.js","assets/CartesianChart-DWkmeYzH.js","assets/StudentsPanel-gGv1l_AB.js","assets/teacherDashboardUtils-CwqoFmsG.js","assets/shield-check-DDGHQKx1.js","assets/funnel-C8KzFS57.js","assets/search-CaxCeGa8.js","assets/InterventionFormPanel-DRnAOUFe.js","assets/ProgressFormPanel-Cvp08Tqf.js"])))=>i.map(i=>d[i]);
import{c as U,e as z,E as K,r as s,j as e,z as B,P as Y,L as X,_ as D}from"./index-B1azmWwg.js";import{P as L,T as V}from"./StatusPills-Dg7uUhRE.js";import{C as Z,U as ee}from"./users-round-DEZa2hQG.js";import{g as te,d as se,b as $,a as ae,c as re,f as ne,e as oe,m as ie,h as de,u as le}from"./teacherDashboardUtils-CwqoFmsG.js";import{A as ce}from"./arrow-right-C2efW_lx.js";import"./shield-check-DDGHQKx1.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],me=U("circle-plus",ue);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]],ge=U("file-check-2",he),R=[{key:"dashboard",label:"Dashboard",icon:Z},{key:"students",label:"My Students",icon:ee},{key:"create",label:"Create Intervention",icon:me},{key:"submit",label:"Submit Progress",icon:ge}],M={base:"px-4 py-3 rounded-2xl bg-white/80 dark:bg-white/10 border border-primary/20 text-sm text-foreground dark:text-white placeholder:text-muted-foreground/70 dark:placeholder:text-white/50 focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-transparent transition-all"};M.textarea=`${M.base} min-h-[80px]`;M.notes=`${M.base} min-h-[120px]`;const q=()=>({studentId:"",studentName:"",grade:"",type:"",strategyId:"",tier:"Tier 2",goal:"",notes:"",startDate:"",duration:"",monitorFrequency:"",monitorMethod:"",baselineValue:"",baselineUnit:"score",targetValue:"",targetUnit:"score"}),H=()=>({studentId:"",assignmentId:"",studentName:"",date:"",performed:"yes",scoreValue:"",scoreUnit:"score",badge:"ðŸŽ‰ Progress Party",notes:""}),be=t=>{const{toast:r}=z(),a=K(),[l,u]=s.useState("dashboard"),[b,i]=s.useState(()=>q()),[g,p]=s.useState(()=>H()),[y,x]=s.useState(!1),[n,w]=s.useState(!1);s.useEffect(()=>{const o=new URLSearchParams(a.search).get("tab");o&&t.some(h=>h.key===o)&&u(o)},[a.search,t]);const N=s.useCallback((d,o)=>{i(h=>({...h,[d]:o}))},[]),S=s.useCallback((d,o)=>{p(h=>({...h,[d]:o}))},[]),k=s.useCallback(async(d,o)=>{if(d.preventDefault(),y)return;if(["studentId","type","tier","startDate","monitorFrequency","monitorMethod"].filter(f=>!(o?.[f]||b[f])).length){r({title:"Complete the required fields",description:"Student, type, tier, start date, frequency, and method are required.",variant:"destructive"});return}try{x(!0),await new Promise(f=>setTimeout(f,600)),r({title:"Intervention saved",description:"Student plan locked inâ€”keep tracking their joyful progress."})}finally{x(!1)}},[b,y,r]),m=s.useCallback(d=>{d.preventDefault(),r({title:"Progress submitted",description:"Your monitoring update is live on the MTSS dashboard."})},[r]),c=s.useCallback(()=>{i(q())},[]),j=s.useCallback(()=>{p(H())},[]);return{activeTab:l,setActiveTab:u,interventionForm:b,progressForm:g,handleInterventionChange:N,handleProgressChange:S,handleSavePlan:k,handleSubmitProgress:m,resetInterventionForm:c,resetProgressForm:j,submittingPlan:y,setSubmittingPlan:x,submittingProgress:n,setSubmittingProgress:w}},pe={male:"Mr.",female:"Ms."},O=t=>pe[t?.toLowerCase?.()]||"",G=t=>{const r=["Hey %NAME%, let's light up today's boosts.","Morning %NAME%, ready to spark joyful wins?","%NAME%, today's plan is setâ€”let's uplift every student.","Cheers %NAME%, another day to glow-up kids' progress.","Let's dive in %NAME%, the boost studio is humming."],a=new Date,l=(a.getDate()+a.getMonth())%r.length;return r[l].replace("%NAME%",t)},xe=t=>{const r=t?.username||t?.name||"MTSS Mentor",a=O(t?.gender),l=a?`${a} ${r}`:r;return{teacher:l,school:t?.jobPosition||t?.unit||"Millennia21 Schools",tierFocus:"Personalized supports",greeting:G(l),gradeLabel:t?.unit||"All Grades"}},fe=()=>{const t=s.useMemo(()=>te(),[]),r=s.useMemo(()=>xe(t),[t]),a=s.useMemo(()=>se(t),[t]),[l,u]=s.useState(()=>$()),[b,i]=s.useState([]),[g,p]=s.useState([]),[y,x]=s.useState(r),[n,w]=s.useState(!0),[N,S]=s.useState(null),k=s.useCallback(async m=>{w(!0),S(null);try{const c=ae(a),j=re(a),d=c.length&&(a.shouldFilterServer||a.unit!=="Junior High"),o={limit:a.unit==="Junior High"?500:200};d&&(o.grade=c.join(",")),j.length&&(o.className=j.join(","));const[h,C]=await Promise.all([ne({limit:150},m?{signal:m}:{}),oe(o,m?{signal:m}:{})]),f=h.assignments||h||[],_=$(f),v=t?.username||t?.name||r.teacher,P=t?.gender,T=ie(f,v),W=C?.students||[],F=de(W,T.students,a),I=O(P),A=I?`${I} ${v}`:v;u(_);const J=F.length?F:T.students;i(J),p(T.spotlightChart.length?T.spotlightChart:[{label:"Start",date:"Start",reading:0,goal:100,value:0}]),x(E=>({...E,...r,teacher:A||r.teacher,greeting:G(A||r.teacher),tierFocus:T.focusLabel||E.tierFocus||"Tiered Supports",gradeLabel:a.label}))}catch(c){c?.name!=="CanceledError"&&c?.name!=="AbortError"&&S(c?.response?.data?.message||c?.message||"Failed to load MTSS data")}finally{w(!1)}},[r,a]);return s.useEffect(()=>{const m=new AbortController;return k(m.signal),()=>m.abort()},[k]),{statCards:l,students:b,progressData:g.length?g:[{label:"Start",date:"Start",reading:0,goal:100,value:0}],heroBadge:y,loading:n,error:N,refresh:()=>k()}},Q=({heroBadge:t,tabs:r,activeTab:a,onTabChange:l})=>e.jsxs("div",{className:"relative overflow-hidden rounded-[44px] border border-white/20 dark:border-white/5 bg-gradient-to-br from-[#dbeafe] via-[#fdf2f8] to-[#fef3c7] dark:from-[#111827] dark:via-[#1f2937] dark:to-[#312e81] shadow-[0_45px_120px_rgba(15,23,42,0.35)]",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute -top-10 -left-6 w-64 h-64 bg-gradient-to-br from-[#f472b6]/40 via-transparent to-transparent blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-80 h-80 bg-gradient-to-br from-[#22d3ee]/30 via-transparent to-transparent blur-[120px]"})]}),e.jsxs("div",{className:"relative px-6 py-8 sm:px-10 text-slate-900 dark:text-white",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_auto] lg:items-start",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.35em] text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/70 dark:bg-white/10 text-rose-500",children:e.jsx(B,{className:"w-3.5 h-3.5"})}),"MTSS Studio"]}),e.jsx("div",{className:"inline-flex px-3 py-1 rounded-full bg-white/80 dark:bg-white/10 border border-white/60 dark:border-white/20 tracking-[0.3em] uppercase text-[11px] font-semibold text-slate-600 dark:text-slate-200",children:t.school}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-black leading-tight bg-gradient-to-r from-[#0f172a] via-[#334155] to-[#1d4ed8] dark:from-white dark:via-[#c7d2fe] dark:to-[#f472b6] text-transparent bg-clip-text",children:t.greeting||`Hey ${t.teacher}, let's light up today's boosts.`})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 px-4 py-3 rounded-3xl bg-white/70 dark:bg-white/5 border border-white/50 dark:border-white/10 shadow-inner max-w-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[0.65rem] uppercase tracking-[0.3em] text-slate-500 dark:text-slate-300",children:"Teacher"}),e.jsx("p",{className:"text-base font-semibold",children:t.teacher})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[0.65rem] uppercase tracking-[0.3em] text-slate-500 dark:text-slate-300",children:"Today"}),e.jsx("p",{className:"text-base font-semibold",children:t.dateLabel||"Ready to roll"})]})]})]}),e.jsx("div",{className:"mt-8 grid grid-cols-2 sm:grid-cols-4 gap-3",children:r.map(u=>{const b=u.icon,i=a===u.key;return e.jsxs("button",{onClick:()=>l(u.key),className:`flex items-center justify-between gap-2 rounded-3xl px-4 py-3 text-sm font-semibold transition shadow-[0_12px_35px_rgba(15,23,42,0.15)] border ${i?"bg-gradient-to-r from-[#22d3ee] via-[#3b82f6] to-[#a855f7] text-white border-transparent":"bg-white/75 dark:bg-white/10 text-slate-600 dark:text-slate-200 border-white/70 dark:border-white/15 hover:bg-white hover:dark:bg-white/15"}`,"aria-pressed":i,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex h-8 w-8 items-center justify-center rounded-full ${i?"bg-white/30 text-white":"bg-white/80 dark:bg-white/10 text-slate-500 dark:text-slate-200"}`,children:e.jsx(b,{className:"w-4 h-4"})}),u.label]}),e.jsx(ce,{className:`w-4 h-4 transition-transform ${i?"translate-x-1":""}`})]},u.key)})})]})]});Q.displayName="TeacherHeroSection";const ve=s.memo(Q),ye=s.lazy(()=>D(()=>import("./DashboardOverview-BemdTvw0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ke=s.lazy(()=>D(()=>import("./StudentsPanel-gGv1l_AB.js"),__vite__mapDeps([11,1,2,3,4,12,13,14,15]))),we=s.lazy(()=>D(()=>import("./InterventionFormPanel-DRnAOUFe.js"),__vite__mapDeps([16,1,2,12,13]))),Se=s.lazy(()=>D(()=>import("./ProgressFormPanel-Cvp08Tqf.js"),__vite__mapDeps([17,1,2,12,13]))),je=()=>e.jsx("div",{className:"glass glass-card p-8 text-center text-muted-foreground animate-pulse",children:"Loading panel..."}),Ne=s.memo(()=>{const{toast:t}=z(),{statCards:r,students:a,progressData:l,heroBadge:u,loading:b,error:i,refresh:g}=fe(),{activeTab:p,setActiveTab:y,interventionForm:x,progressForm:n,handleInterventionChange:w,handleProgressChange:N,handleSavePlan:S,resetProgressForm:k,submittingPlan:m,setSubmittingProgress:c,submittingProgress:j}=be(R),{base:d,textarea:o,notes:h}=M,C=s.useCallback(async _=>{if(_.preventDefault(),!n.studentId||!n.date||n.scoreValue===""){t({title:"Complete the required fields",description:"Student, date, and score are required to submit progress.",variant:"destructive"});return}const v=a.find(P=>P.id===n.studentId);if(!v){t({title:"Select a student",description:"Choose a student before logging progress.",variant:"destructive"});return}if(!v.assignmentId){t({title:"No active intervention",description:`${v.name} is not linked to an active intervention yet.`,variant:"destructive"});return}try{c(!0),await le(v.assignmentId,{checkIns:[{date:n.date||new Date,summary:n.notes||"Progress update logged via dashboard",nextSteps:n.notes,value:n.scoreValue?Number(n.scoreValue):void 0,unit:n.scoreUnit,performed:n.performed==="yes"}]}),t({title:"Progress saved",description:`${v.name}'s update is now on the dashboard.`}),k(),g()}catch(P){t({title:"Failed to save progress",description:P?.response?.data?.message||P.message||"Unable to record update now.",variant:"destructive"})}finally{c(!1)}},[n,a,t,k,g,c]),f=s.useMemo(()=>{switch(p){case"dashboard":return e.jsx(ye,{statCards:r,students:a,progressData:l,TierPill:V,ProgressBadge:L});case"students":return e.jsx(ke,{students:a,TierPill:V,ProgressBadge:L,onRefresh:g});case"create":return e.jsx(we,{formState:x,onChange:w,onSubmit:_=>S(_,x),baseFieldClass:d,textareaClass:o,students:a,submitting:m});case"submit":return e.jsx(Se,{formState:n,onChange:N,onSubmit:C,baseFieldClass:d,textareaClass:h,students:a,submitting:j});default:return null}},[p,x,n,w,N,S,C,d,o,h,r,a,l,g]);return e.jsxs("div",{className:"mtss-theme mtss-animated-bg min-h-screen relative overflow-hidden text-foreground dark:text-white transition-colors",children:[(m||j)&&e.jsx(Y,{}),e.jsx("div",{className:"mtss-bg-overlay"}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 h-64 bg-gradient-to-b from-white/70 via-[#fef2f2]/40 to-transparent dark:from-white/10 dark:via-white/5"}),e.jsx("div",{className:"absolute -bottom-24 left-12 w-[28rem] h-[28rem] bg-gradient-to-br from-[#22d3ee]/35 via-[#a855f7]/25 to-[#f472b6]/20 dark:from-[#0ea5e9]/25 dark:via-[#a855f7]/20 dark:to-[#f472b6]/15 blur-[200px]"})]}),e.jsxs("div",{className:"relative z-20 container-tight px-4 sm:px-6 py-8 lg:py-14 space-y-8 lg:space-y-10",children:[e.jsx("section",{className:"mtss-gradient-border overflow-hidden rounded-3xl border border-white/40 dark:border-white/10 shadow-[0_25px_60px_rgba(148,163,184,0.25)]","data-aos":"fade-up","data-aos-duration":"700",children:e.jsx(ve,{heroBadge:u,tabs:R,activeTab:p,onTabChange:y})}),(b||i)&&e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-white/60 dark:bg-white/5 px-4 py-3 flex items-center justify-between gap-4 text-sm text-muted-foreground","data-aos":"fade-up",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[b&&e.jsx(X,{className:"w-4 h-4 animate-spin text-primary"}),e.jsx("span",{children:i||"Syncing live MTSS data..."})]}),i&&e.jsx("button",{onClick:g,className:"text-primary font-semibold hover:underline",children:"Retry"})]}),e.jsx(s.Suspense,{fallback:e.jsx(je,{}),children:f})]})]})});Ne.displayName="TeacherDashboardPage";export{Ne as default};
