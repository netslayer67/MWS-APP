const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PrimaryNavButtons-CLy7VZR3.js","assets/index-BAvDP42J.js","assets/index-BquX13V4.css","assets/target-CB1ow6Ps.js","assets/DashboardHeader-BHNAdV08.js","assets/utils-NGAVZCJh.js","assets/ContentSections-m5EvzrWU.js","assets/DecorativeElements-YZ40MNdG.js","assets/PerformanceMonitor-N5O-SJJp.js"])))=>i.map(i=>d[i]);
import{c as X,r as a,j as e,X as O,Y as Z,C as E,a as G,b as J,d as T,h as K,i as Q,E as ee,D as se,Z as U,$ as D,a0 as R,a1 as ae,_ as w}from"./index-BAvDP42J.js";import{s as x}from"./socketService-B4WowktR.js";import{F as te}from"./funnel-g3w0Q9em.js";import{U as re}from"./users-w-z2oeKI.js";import{B as le}from"./building-DBBjUsWJ.js";import{S as oe}from"./shield-check-CKrMDfjh.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ne=X("triangle-alert",de),I=a.memo(({onFiltersChange:m,currentFilters:o={}})=>{const[i,t]=a.useState(!1),[u,b]=a.useState(o),v=[{value:"student",label:"Students"},{value:"staff",label:"Staff"},{value:"teacher",label:"Teachers"},{value:"admin",label:"Admins"},{value:"directorate",label:"Directorate"}],l=[{value:"Academic",label:"Academic"},{value:"Student Affairs",label:"Student Affairs"},{value:"Finance",label:"Finance"},{value:"HR",label:"Human Resources"},{value:"IT",label:"Information Technology"},{value:"Operations",label:"Operations"}],c=[{value:"happy",label:"Happy"},{value:"excited",label:"Excited"},{value:"calm",label:"Calm"},{value:"hopeful",label:"Hopeful"},{value:"tired",label:"Tired"},{value:"anxious",label:"Anxious"},{value:"sad",label:"Sad"},{value:"overwhelmed",label:"Overwhelmed"}],d=[{value:"sunny",label:"Sunny"},{value:"cloudy",label:"Cloudy"},{value:"rain",label:"Rain"},{value:"storm",label:"Storm"},{value:"tornado",label:"Tornado"},{value:"snow",label:"Snow"}],r=(s,g)=>{const h={...u};h[s]||(h[s]=[]),h[s].includes(g)?h[s]=h[s].filter(C=>C!==g):h[s].push(g),h[s].length===0&&delete h[s],b(h),m(h)},f=()=>{b({}),m({})},p=Object.values(u).reduce((s,g)=>s+g.length,0);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>t(!i),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${p>0?"bg-primary text-primary-foreground border-primary":"bg-card text-foreground border-border hover:bg-card/80"}`,children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Advanced Filters"}),p>0&&e.jsx("span",{className:"bg-destructive text-destructive-foreground text-xs px-2 py-1 rounded-full",children:p})]}),i&&e.jsxs("div",{className:"absolute top-full mt-2 right-0 z-50 w-96 bg-card border border-border rounded-xl shadow-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Filter Dashboard Data"}),e.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-muted rounded",children:e.jsx(O,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(re,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Role"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.role?.includes(s.value)||!1,onChange:()=>r("role",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(le,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Department"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:l.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.department?.includes(s.value)||!1,onChange:()=>r("department",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Moods"})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:c.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.mood?.includes(s.value)||!1,onChange:()=>r("mood",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Weather Types"})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:d.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.weather?.includes(s.value)||!1,onChange:()=>r("weather",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Support Status"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.needsSupport?.includes("true")||!1,onChange:()=>r("needsSupport","true"),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:"Needs Support"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.needsSupport?.includes("false")||!1,onChange:()=>r("needsSupport","false"),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:"No Support Needed"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-border",children:[e.jsx("button",{onClick:f,className:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Clear All"}),e.jsx("button",{onClick:()=>t(!1),className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Apply Filters"})]})]})]})});I.displayName="AdvancedFilters";const P=a.memo(({socketService:m,user:o})=>{const[i,t]=a.useState([]),[u,b]=a.useState(!1);a.useEffect(()=>{if(!m||!o)return;const d=p=>{const s={id:Date.now(),type:"info",title:"New Check-in Submitted",message:`${p.userName||"Someone"} just submitted their emotional check-in`,timestamp:new Date,icon:E,color:"text-blue-500",bgColor:"bg-blue-50",borderColor:"border-blue-200"};v(s)},r=p=>{const s={id:Date.now(),type:"warning",title:"Support Needed",message:`${p.userName} has indicated they need support`,timestamp:new Date,icon:ne,color:"text-red-500",bgColor:"bg-red-50",borderColor:"border-red-200"};v(s)},f=p=>{const s={id:Date.now(),type:"success",title:"Dashboard Updated",message:"New data has been added to the dashboard",timestamp:new Date,icon:E,color:"text-green-500",bgColor:"bg-green-50",borderColor:"border-green-200"};v(s)};return m.onNewCheckin(d),m.onUserFlagged(r),m.onDashboardUpdate(f),()=>{m.offNewCheckin(d),m.offUserFlagged(r),m.offDashboardUpdate(f)}},[m,o]);const v=d=>{t(r=>[d,...r].slice(0,10)),b(!0),setTimeout(()=>{b(!1)},5e3)},l=d=>{t(r=>r.filter(f=>f.id!==d)),i.length<=1&&b(!1)},c=()=>{t([]),b(!1)};return i.length===0?null:e.jsxs("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs("button",{onClick:()=>b(!u),className:"relative p-2 bg-primary text-primary-foreground rounded-full shadow-lg hover:bg-primary/90 transition-colors",children:[e.jsx(Z,{className:"w-4 h-4"}),i.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs rounded-full w-5 h-5 flex items-center justify-center",children:i.length})]})}),u&&e.jsxs("div",{className:"glass glass-card shadow-2xl max-h-96 overflow-hidden",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Notifications"}),e.jsx("button",{onClick:c,className:"text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Clear all"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:i.map(d=>{const r=d.icon;return e.jsx("div",{className:`p-4 border-b border-border/50 last:border-b-0 ${d.bgColor} transition-all duration-300`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:`w-4 h-4 mt-0.5 ${d.color}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:d.title}),e.jsx("button",{onClick:()=>l(d.id),className:"ml-2 p-1 rounded transition-colors hover:bg-secondary/25",children:e.jsx(O,{className:"w-3 h-3 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:d.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:d.timestamp.toLocaleTimeString()})]})]})},d.id)})}),e.jsx("div",{className:"p-3 bg-muted/20 border-t border-border",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Real-time updates active"})})]})]})]})});P.displayName="RealTimeNotifications";a.lazy(()=>w(()=>import("./PrimaryNavButtons-CLy7VZR3.js"),__vite__mapDeps([0,1,2,3])));const ie=a.lazy(()=>w(()=>import("./DashboardHeader-BHNAdV08.js"),__vite__mapDeps([4,1,2,5]))),ce=a.lazy(()=>w(()=>import("./ContentSections-m5EvzrWU.js"),__vite__mapDeps([6,1,2]))),ue=a.lazy(()=>w(()=>import("./DecorativeElements-YZ40MNdG.js"),__vite__mapDeps([7,1,2]))),me=a.lazy(()=>w(()=>import("./PerformanceMonitor-N5O-SJJp.js"),__vite__mapDeps([8,1,2]))),M=a.memo(function(){const o=G(),i=J(),{user:t}=T(n=>n.auth),{stats:u,loading:b,error:v,selectedPeriod:l,selectedDate:c}=T(n=>n.dashboard),d=a.useMemo(()=>new Date().toISOString().split("T")[0],[]),[r,f]=a.useState(c||d),p=a.useMemo(()=>K(t),[t]),s=a.useMemo(()=>Q(t),[t]),g=a.useMemo(()=>ee(t),[t]),h=se(t),C=p==="head_unit",k=["directorate","admin","superadmin"].includes(p||""),[he,z]=a.useState(!1),[L,H]=a.useState({}),S=a.useRef(!1);a.useEffect(()=>{const n=setTimeout(()=>z(!0),100);return()=>clearTimeout(n)},[]),a.useEffect(()=>{c&&f(c)},[c]);const N=a.useMemo(()=>!c||l==="all"?null:c,[c,l]);a.useEffect(()=>{if(t){if(s){if(k&&l==="today"&&!S.current){S.current=!0,o(U("all"));return}console.log("Fetching dashboard stats for period:",l,"User:",t),o(D({period:l,date:N})),x.connect(),x.joinDashboard(t.id);const n=j=>{console.log("Real-time dashboard update:",j),o(D({period:l,date:N}))},_=j=>{console.log("New check-in received:",j),o(D({period:l,date:N,force:!0})),console.log("Dashboard updated with new check-in data")},F=j=>{console.log("User flagged for support:",j)},A=j=>{console.log("Support request handled, removing from flagged users:",j),o(ae(j))};return x.onDashboardUpdate(n),x.onNewCheckin(_),x.onUserFlagged(F),x.onSupportRequestHandled(A),()=>{x.offDashboardUpdate(n),x.offNewCheckin(_),x.offUserFlagged(F),x.offSupportRequestHandled(A),x.leaveDashboard()}}console.log("User not authorized for dashboard:",{user:t}),i("/support-hub",{replace:!0})}},[s,o,k,i,l,N,t]);const V=a.useCallback(n=>{o(U(n)),n==="all"&&c&&o(R(null))},[o,c]),$=a.useCallback(n=>{H(n),o(D({period:l,date:N,filters:n}))},[o,N,l]);a.useCallback(()=>{i("/mtss")},[i]),a.useCallback(()=>{i("/support-hub")},[i]);const y=a.memo(()=>e.jsxs("div",{className:"glass glass-card",children:[e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted/30 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-2/3"})]})]}));y.displayName="LoadingFallback";const q=a.useMemo(()=>typeof window<"u"?window.innerWidth<768:!1,[]),B=a.useCallback(n=>{f(n)},[]),W=a.useCallback(()=>{r&&(o(R(r)),l!=="all"&&o(D({period:l,date:r})))},[o,r,l]),Y=a.useMemo(()=>l==="all"||!r?!0:r===c,[r,c,l]);return e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsx(a.Suspense,{fallback:null,children:e.jsx(ue,{isMobile:q})}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[h&&g&&e.jsxs("div",{className:"glass glass-card p-4 mb-4 flex items-start gap-3 border border-amber-200/70 bg-amber-50/70 dark:bg-amber-500/10",children:[e.jsx(oe,{className:"w-5 h-5 text-amber-600 dark:text-amber-300 mt-0.5"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Delegated dashboard access"}),e.jsxs("p",{children:["You're viewing the Emotional Check-in Dashboard with the same visibility as"," ",e.jsx("span",{className:"font-medium text-foreground",children:g.delegatedFromName||g.delegatedFromEmail||"the assigned directorate lead"}),". All actions remain logged under your account."]})]})]}),e.jsx(a.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(ie,{selectedPeriod:l,onPeriodChange:V,selectedDate:r,onDateChange:B,onApplyDate:W,isApplyDisabled:Y,isHeadUnit:C,userUnit:t?.unit||t?.department,isDirectorate:k})}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(I,{onFiltersChange:$,currentFilters:L})}),e.jsx(a.Suspense,{fallback:e.jsx(y,{})}),u?e.jsx(a.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(ce,{realData:u,loading:b,selectedPeriod:l,userId:t?.id,isHeadUnit:C,isDirectorate:k})}):e.jsx(y,{})]}),e.jsx(P,{socketService:x,user:t}),e.jsx(a.Suspense,{fallback:null,children:e.jsx(me,{})})]})});M.displayName="EmotionalCheckinDashboard";const ve=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}));export{ve as E,ne as T};
