import{r,u as A,b as M,aN as U,j as e,Q as n,m as N,B as g}from"./index-BeQwOtyQ.js";import{C as c,a as m,b as x,c as h}from"./card-D-goIzvr.js";import{B as l}from"./badge-CKD0dT5b.js";import{C as D}from"./chevron-up-iT0nc1jZ.js";import{C as E}from"./chevron-down-B-g9NK3J.js";import{U as L}from"./users-BVc-u3T_.js";const B=r.memo(function({userId:o}){const p=A(),{userCheckinHistory:a,loading:d}=M(s=>s.dashboard),[u,v]=r.useState(new Set),[j,C]=r.useState(0),y=20;r.useEffect(()=>{o&&p(U({userId:o,limit:y,offset:j}))},[p,o,j]);const b=r.useCallback(s=>{v(t=>{const i=new Set(t);return i.has(s)?i.delete(s):i.add(s),i})},[]),w=r.useCallback(()=>{a?.pagination?.hasMore&&C(s=>s+y)},[a?.pagination?.hasMore]),f=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),S=s=>({sunny:"‚òÄÔ∏è","partly-cloudy":"‚õÖ",cloudy:"‚òÅÔ∏è",rainy:"üåßÔ∏è",stormy:"‚õàÔ∏è",snowy:"‚ùÑÔ∏è"})[s]||"‚õÖ";return d&&!a?e.jsxs(c,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5"}),"Check-in History"]})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,t)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-1/4 mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-3/4"})]},t))})})]}):a?.checkins?.length?e.jsxs(c,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5"}),"Check-in History",e.jsxs(l,{variant:"secondary",className:"ml-auto",children:[a.pagination.total," total"]})]})}),e.jsxs(h,{children:[e.jsx("div",{className:"space-y-4",children:a.checkins.map((s,t)=>e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:S(s.weatherType)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:f(s.date)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Submitted ",f(s.submittedAt)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",className:"text-xs",children:["P: ",s.presenceLevel,"/10"]}),e.jsxs(l,{variant:"outline",className:"text-xs",children:["C: ",s.capacityLevel,"/10"]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>b(s.id),className:"h-6 w-6 p-0",children:u.has(s.id)?e.jsx(D,{className:"w-4 h-4"}):e.jsx(E,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:s.selectedMoods.map((i,H)=>e.jsx(l,{variant:"secondary",className:"text-xs",children:i},H))}),u.has(s.id)&&e.jsxs(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 pt-3 border-t space-y-2",children:[s.details&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Details:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.details})]}),s.aiAnalysis&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"AI Analysis:"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.aiAnalysis.emotionalState&&e.jsxs("p",{children:["Emotional State: ",s.aiAnalysis.emotionalState]}),s.aiAnalysis.needsSupport&&e.jsx("p",{className:"text-amber-600",children:"‚ö†Ô∏è Support needed"})]})]}),s.supportContact&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsxs("span",{children:["Support Contact: ",s.supportContact.name]})]})]})]},s.id))}),a?.pagination?.hasMore&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx(g,{onClick:w,disabled:d,variant:"outline",children:d?"Loading...":"Load More"})})]})]}):e.jsxs(c,{children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5"}),"Check-in History"]})}),e.jsx(h,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(n,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No check-in history available"})]})})]})});B.displayName="UserHistorySection";export{B as default};
