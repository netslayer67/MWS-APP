const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UserStatsOverview-DfINqQ3F.js","assets/index-C4XCgjPq.js","assets/index-BquX13V4.css","assets/users-Boh882ZV.js","assets/crown-DBHzM0cs.js","assets/graduation-cap-DzcTIdXz.js","assets/user-check-eFKFCf74.js","assets/building-DBYcEZea.js","assets/UserTable-hdKMSRww.js","assets/index-D2-TsWSy.js","assets/badge-BVe2bCoF.js","assets/eye-Cb1e3bCD.js","assets/chevron-left-BcT6RbuN.js","assets/UserFilters-CN5qtonc.js","assets/input-B1lEK93_.js","assets/select-CZxT4su_.js","assets/chevron-down-UWFmKXbN.js","assets/funnel-Maf2PZts.js","assets/plus-CELH-p4z.js","assets/download-Bsnpdz7_.js","assets/search-Bwg04Xb1.js","assets/UserForm-2erbpS16.js","assets/label-C8TjdQxV.js","assets/save-A9VS7mzR.js","assets/OrganizationChart--60T4EQl.js","assets/UserDetailsModal-DmLojpyP.js","assets/clock-DKS6QAC5.js"])))=>i.map(i=>d[i]);
import{r as a,a as L,e as M,d as w,aa as h,ab as p,ac as E,ad as I,ae as V,af as B,ag as H,j as e,z as W,m as n,B as v,_ as c}from"./index-C4XCgjPq.js";import{A as S}from"./AnimatedPage-zx-kDCmb.js";const Y=a.lazy(()=>c(()=>import("./UserStatsOverview-DfINqQ3F.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),$=a.lazy(()=>c(()=>import("./UserTable-hdKMSRww.js"),__vite__mapDeps([8,1,2,9,10,11,12]))),q=a.lazy(()=>c(()=>import("./UserFilters-CN5qtonc.js"),__vite__mapDeps([13,1,2,14,15,9,16,10,17,18,19,20]))),G=a.lazy(()=>c(()=>import("./UserForm-2erbpS16.js"),__vite__mapDeps([21,1,2,14,22,15,9,16,23]))),J=a.lazy(()=>c(()=>import("./OrganizationChart--60T4EQl.js"),__vite__mapDeps([24,1,2,7,4,5,3]))),K=a.lazy(()=>c(()=>import("./UserDetailsModal-DmLojpyP.js"),__vite__mapDeps([25,1,2,10,14,22,15,9,16,7,5,3,18,26]))),m=a.memo(()=>e.jsx("div",{className:"glass glass-card p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted/30 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-2/3"})]})}));m.displayName="LoadingFallback";const Q=a.memo(()=>{const t=L(),{toast:r}=M(),{users:y,organizationStructure:l,pagination:f,filters:i,loading:D,error:N,lastUpdated:A}=w(s=>s.users),{user:x}=w(s=>s.auth),[z,u]=a.useState(!1),[g,j]=a.useState(null),[_,U]=a.useState(null),[d,k]=a.useState("overview"),b=x&&(x.role==="directorate"||x.role==="superadmin"||x.role==="admin");a.useEffect(()=>{b&&(t(h(i)),t(p()))},[t,b,i]);const C=a.useCallback(s=>{t(E(s))},[t]),F=a.useCallback(async s=>{try{await t(I(s)).unwrap(),r({title:"Success",description:"User created successfully"}),u(!1),t(h(i)),t(p())}catch(o){r({title:"Error",description:o||"Failed to create user",variant:"destructive"})}},[t,r,i]),O=a.useCallback(async(s,o)=>{try{await t(V({userId:s,userData:o})).unwrap(),r({title:"Success",description:"User updated successfully"}),j(null),u(!1),t(h(i)),t(p())}catch(T){r({title:"Error",description:T||"Failed to update user",variant:"destructive"})}},[t,r,i]),P=a.useCallback(async s=>{if(window.confirm("Are you sure you want to deactivate this user?"))try{await t(B(s)).unwrap(),r({title:"Success",description:"User deactivated successfully"}),t(h(i)),t(p())}catch(o){r({title:"Error",description:o||"Failed to deactivate user",variant:"destructive"})}},[t,r,i]),R=a.useCallback(s=>{t(E({...i,page:s}))},[t,i]);return a.useEffect(()=>()=>{t(H())},[t]),b?e.jsxs(S,{children:[e.jsxs(W,{children:[e.jsx("title",{children:"User Management â€” Millennia World School"}),e.jsx("meta",{name:"description",content:"Advanced user management system for school administration"})]}),e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 w-64 h-64 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-accent/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"User Management Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users, roles, and organizational structure"})]}),e.jsx(v,{children:N&&e.jsx(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:e.jsx("p",{className:"text-destructive text-sm",children:N})})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex space-x-1 bg-muted/30 p-1 rounded-lg",children:[{id:"overview",label:"Overview",icon:"ðŸ“Š"},{id:"users",label:"Users",icon:"ðŸ‘¥"},{id:"organization",label:"Organization",icon:"ðŸ¢"},{id:"analytics",label:"Analytics",icon:"ðŸ“ˆ"}].map(s=>e.jsxs("button",{onClick:()=>k(s.id),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all ${d===s.id?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx("span",{className:"mr-2",children:s.icon}),s.label]},s.id))})}),e.jsxs(v,{mode:"wait",children:[d==="overview"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{organizationStructure:l,totalUsers:f.totalUsers,lastUpdated:A})})},"overview"),d==="users"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(q,{filters:i,onFiltersChange:C,onAddUser:()=>u(!0)})}),e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx($,{users:y,loading:D,pagination:f,onPageChange:R,onEditUser:j,onDeleteUser:P,onViewUser:U})})]})},"users"),d==="organization"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(J,{organizationStructure:l,users:y})})},"organization"),d==="analytics"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Department Analytics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l?.stats?.byDepartment?.map(s=>e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s._id}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"members"})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Role Distribution"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:l?.stats?.byRole?.map(s=>e.jsxs("div",{className:"text-center p-4 bg-muted/20 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s._id})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Employment Status"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:l?.stats?.byEmploymentStatus?.map(s=>e.jsxs("div",{className:"text-center p-4 bg-muted/20 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s._id})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Management Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-700 mb-2",children:"Leadership Structure"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Directorate members oversee ",l?.stats?.totalUsers||0," total users across ",l?.stats?.byDepartment?.length||0," departments."]})]}),e.jsxs("div",{className:"p-4 bg-green/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-700 mb-2",children:"Teaching Staff"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l?.stats?.byRole?.find(s=>s._id==="teacher")?.count||0," teachers and ",l?.stats?.byRole?.find(s=>s._id==="se_teacher")?.count||0," SE teachers are actively managing classroom assignments."]})]})]})]})]})},"analytics")]}),e.jsxs(v,{children:[(z||g)&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(G,{user:g,onSubmit:g?O:F,onCancel:()=>{u(!1),j(null)}})}),_&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(K,{user:_,onClose:()=>U(null)})})]})]})]})]}):e.jsx(S,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"glass glass-card p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to access the User Management Dashboard."})]})})})});Q.displayName="UserManagementDashboard";export{Q as default};
