import{c as D,r as i,j as t,A as z,o as u,X as A}from"./index-BCPYO0q9.js";import{C as P}from"./clock-B4oT_F4U.js";import{S as E}from"./shield-check-CDnYePuH.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],M=D("circle-alert",L),O=(n="")=>String(n||"").replace(/[^0-9]/g,"").slice(0,9),q=({isOpen:n,onClose:j,jobFee:p=1e5,role:o="worker",initialOffers:x=[],onSendOffer:N,onAccept:f,onReject:k,onAcceptedFinal:v})=>{const[d,c]=i.useState(x),[m,g]=i.useState(""),[b,l]=i.useState(null),y=i.useRef(!1);i.useEffect(()=>{n&&!y.current&&(c(x||[]),l(null)),y.current=n},[n,x]);const h=(e,a)=>{const s=Number(e);if(!s||isNaN(s))return;const r={id:Date.now(),amount:s,by:a,status:"pending",createdAt:Date.now(),expiresAt:Date.now()+6e4};c(I=>[...I,r]),l(`Rp${s.toLocaleString("id-ID")} dikirim oleh ${a==="worker"?"Pekerja":"Klien"}`);try{N?.(s)}catch{}};i.useEffect(()=>{const e=setInterval(()=>{c(a=>a.map(s=>s.status==="pending"&&s.expiresAt<Date.now()?{...s,status:"expired"}:s))},4e3);return()=>clearInterval(e)},[]);const w=e=>{const a=d.find(s=>s.id===e);c(s=>s.map(r=>r.id===e?{...r,status:"accepted"}:r)),l("Penawaran diterima ✔️");try{a&&(f?.(a),v?.(a))}catch{}},C=e=>{const a=d.find(s=>s.id===e);c(s=>s.map(r=>r.id===e?{...r,status:"rejected"}:r)),l("Penawaran ditolak ✖️");try{a&&k?.(a)}catch{}},S=[.8,1,1.2];return t.jsx(z,{children:n&&t.jsx(u.div,{className:"fixed inset-0 z-[9999] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md px-2 sm:px-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:t.jsxs(u.div,{className:"relative w-full max-w-md rounded-2xl bg-background/80 dark:bg-zinc-900/70 backdrop-blur-2xl p-4 sm:p-6 shadow-xl border border-border",initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},transition:{duration:.35,ease:"easeOut"},children:[t.jsx("button",{className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground transition-colors duration-300",onClick:j,children:t.jsx(A,{size:20})}),t.jsx("h2",{className:"text-base sm:text-lg font-semibold mb-3 text-foreground",children:"Negosiasi"}),b&&t.jsxs("div",{className:"mb-3 flex items-center gap-1.5 text-xs sm:text-sm text-accent",children:[t.jsx(M,{size:14})," ",b]}),t.jsxs("div",{className:"space-y-2 max-h-52 overflow-y-auto pr-1 custom-scrollbar",children:[d.map(e=>{const a=o==="client"&&e.by==="worker"||o==="worker"&&e.by==="client";return t.jsxs(u.div,{className:`p-2 sm:p-3 rounded-xl border flex justify-between items-center text-xs sm:text-sm transition-colors duration-300 ${e.status==="accepted"?"bg-green-500/20 border-green-500/40":e.status==="rejected"?"bg-red-500/20 border-red-500/40":e.status==="expired"?"bg-muted/30 border-muted/40":"bg-secondary/20 border-secondary/40"}`,initial:{opacity:0,y:6},animate:{opacity:1,y:0},children:[t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium",children:["Rp",(Number(e.amount)||0).toLocaleString("id-ID")]}),t.jsx("p",{className:"text-[11px] text-muted-foreground",children:e.by==="worker"?"Pekerja":"Klien"})]}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[e.status==="pending"&&a&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"px-2 py-1 rounded-lg bg-accent text-[11px] text-secondary hover:bg-accent/90 transition-colors duration-300",onClick:()=>w(e.id),children:"Terima"}),t.jsx("button",{className:"px-2 py-1 rounded-lg bg-red-500 text-[11px] text-secondary hover:bg-red-600 transition-colors duration-300",onClick:()=>C(e.id),children:"Tolak"})]}),e.status==="pending"&&t.jsx(P,{size:13,className:"text-muted-foreground"}),e.status==="accepted"&&t.jsx(E,{size:14,className:"text-green-500"})]})]},e.id)}),d.length===0&&t.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center",children:"Belum ada penawaran."})]}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsx("div",{className:"flex gap-2",children:S.map(e=>t.jsxs("button",{onClick:()=>h(Math.round(p*e),o),className:"flex-1 py-1.5 rounded-lg bg-primary text-primary-foreground text-xs sm:text-sm hover:bg-primary/90 transition-colors duration-300",children:["Rp",Math.round(p*e).toLocaleString("id-ID")]},e))}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",inputMode:"numeric",value:m,onChange:e=>g(O(e.target.value)),placeholder:"Nominal",className:"flex-1 px-2 sm:px-3 py-1.5 rounded-lg bg-muted/40 border border-border text-xs sm:text-sm focus:ring-2 focus:ring-accent outline-none transition-colors duration-300"}),t.jsx("button",{onClick:()=>{m&&(h(Number(m),o),g(""))},className:"px-3 sm:px-4 py-1.5 rounded-lg bg-accent text-secondary text-xs sm:text-sm hover:bg-accent/90 transition-colors duration-300",children:"Kirim"})]})]})]})})})};export{q as N};
