const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardOverview-DOpQyBDv.js","assets/index-D-EiwK_h.js","assets/index-Dl2AnsQb.css","assets/StudentsTable-D9-oy8oY.js","assets/CategoricalChart-B29ee3bE.js","assets/LineChart-Chi1t25j.js","assets/ActivePoints-CKX_-Otj.js","assets/ErrorBarContext-BW0NbrYC.js","assets/CartesianChart-Bm0th9ZG.js","assets/StudentsPanel-WLilFfp2.js","assets/teacherDashboardUtils-Bkr1WZ6W.js","assets/shield-check-DRs9tJTL.js","assets/funnel-CdPmx85V.js","assets/search-BOWZ9Ge8.js","assets/InterventionFormPanel-Bb7Vt1Ro.js","assets/ProgressFormPanel-Dh3NybYt.js"])))=>i.map(i=>d[i]);
import{c as U,e as V,B,r as s,j as e,x as K,P as Y,m as J,L as Q,_ as M}from"./index-D-EiwK_h.js";import{P as F,T as E}from"./StatusPills-DwA6HrHU.js";import{C as X,U as Z}from"./users-round-Ds6cCV_E.js";import{g as ee,d as te,b as L,f as se,a as ae,m as re,c as ne,u as oe}from"./teacherDashboardUtils-Bkr1WZ6W.js";import{A as ie}from"./arrow-right-Byxe_hdi.js";import"./shield-check-DRs9tJTL.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],le=U("circle-plus",de);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]],me=U("file-check-2",ce),$=[{key:"dashboard",label:"Dashboard",icon:X},{key:"students",label:"My Students",icon:Z},{key:"create",label:"Create Intervention",icon:le},{key:"submit",label:"Submit Progress",icon:me}],T={base:"px-4 py-3 rounded-2xl bg-white/80 dark:bg-white/10 border border-primary/20 text-sm text-foreground dark:text-white placeholder:text-muted-foreground/70 dark:placeholder:text-white/50 focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-transparent transition-all"};T.textarea=`${T.base} min-h-[80px]`;T.notes=`${T.base} min-h-[120px]`;const R=()=>({studentId:"",studentName:"",grade:"",type:"",strategyId:"",tier:"Tier 2",goal:"",notes:"",startDate:"",duration:"",monitorFrequency:"",monitorMethod:"",baselineValue:"",baselineUnit:"score",targetValue:"",targetUnit:"score"}),q=()=>({studentId:"",assignmentId:"",studentName:"",date:"",performed:"yes",scoreValue:"",scoreUnit:"score",badge:"ðŸŽ‰ Progress Party",notes:""}),ue=t=>{const{toast:a}=V(),r=B(),[l,c]=s.useState("dashboard"),[b,i]=s.useState(()=>R()),[g,p]=s.useState(()=>q()),[y,x]=s.useState(!1),[n,S]=s.useState(!1);s.useEffect(()=>{const o=new URLSearchParams(r.search).get("tab");o&&t.some(h=>h.key===o)&&c(o)},[r.search,t]);const C=s.useCallback((d,o)=>{i(h=>({...h,[d]:o}))},[]),j=s.useCallback((d,o)=>{p(h=>({...h,[d]:o}))},[]),k=s.useCallback(async(d,o)=>{if(d.preventDefault(),y)return;if(["studentId","type","tier","startDate","monitorFrequency","monitorMethod"].filter(w=>!(o?.[w]||b[w])).length){a({title:"Complete the required fields",description:"Student, type, tier, start date, frequency, and method are required.",variant:"destructive"});return}try{x(!0),await new Promise(w=>setTimeout(w,600)),a({title:"Intervention saved",description:"Student plan locked inâ€”keep tracking their joyful progress."})}finally{x(!1)}},[b,y,a]),m=s.useCallback(d=>{d.preventDefault(),a({title:"Progress submitted",description:"Your monitoring update is live on the MTSS dashboard."})},[a]),u=s.useCallback(()=>{i(R())},[]),N=s.useCallback(()=>{p(q())},[]);return{activeTab:l,setActiveTab:c,interventionForm:b,progressForm:g,handleInterventionChange:C,handleProgressChange:j,handleSavePlan:k,handleSubmitProgress:m,resetInterventionForm:u,resetProgressForm:N,submittingPlan:y,setSubmittingPlan:x,submittingProgress:n,setSubmittingProgress:S}},ge={male:"Mr.",female:"Ms."},H=t=>ge[t?.toLowerCase?.()]||"",z=t=>{const a=["Hey %NAME%, let's light up today's boosts.","Morning %NAME%, ready to spark joyful wins?","%NAME%, today's plan is setâ€”let's uplift every student.","Cheers %NAME%, another day to glow-up kids' progress.","Let's dive in %NAME%, the boost studio is humming."],r=new Date,l=(r.getDate()+r.getMonth())%a.length;return a[l].replace("%NAME%",t)},he=t=>{const a=t?.username||t?.name||"MTSS Mentor",r=H(t?.gender),l=r?`${r} ${a}`:a;return{teacher:l,school:t?.jobPosition||t?.unit||"Millennia21 Schools",tierFocus:"Personalized supports",greeting:z(l),gradeLabel:t?.unit||"All Grades"}},be=()=>{const t=s.useMemo(()=>ee(),[]),a=s.useMemo(()=>he(t),[t]),r=s.useMemo(()=>te(t),[t]),[l,c]=s.useState(()=>L()),[b,i]=s.useState([]),[g,p]=s.useState([]),[y,x]=s.useState(a),[n,S]=s.useState(!0),[C,j]=s.useState(null),k=s.useCallback(async m=>{S(!0),j(null);try{const u=r.allowedGrades.length?{grade:r.allowedGrades.join(","),limit:150}:{limit:150},[N,d]=await Promise.all([se({limit:200},m?{signal:m}:{}),ae(u,m?{signal:m}:{})]),o=N.assignments||N||[],h=L(o),f=re(o,a.teacher),w=d?.students||[],_=ne(w,f.students,r),v=o?.[0]?.mentorId||o?.[0],P=v?.username||t?.username||v?.name||a.teacher,G=t?.gender||v?.gender,D=H(G),I=D?`${D} ${P}`:P;c(h);const W=_.length?_:f.students;i(W),p(f.spotlightChart.length?f.spotlightChart:[{label:"Start",date:"Start",reading:0,goal:100,value:0}]),x(A=>({...A,...a,teacher:I||a.teacher,greeting:z(I||a.teacher),tierFocus:f.focusLabel||A.tierFocus||"Tiered Supports",gradeLabel:r.label}))}catch(u){u?.name!=="CanceledError"&&u?.name!=="AbortError"&&j(u?.response?.data?.message||u?.message||"Failed to load MTSS data")}finally{S(!1)}},[a,r]);return s.useEffect(()=>{const m=new AbortController;return k(m.signal),()=>m.abort()},[k]),{statCards:l,students:b,progressData:g.length?g:[{label:"Start",date:"Start",reading:0,goal:100,value:0}],heroBadge:y,loading:n,error:C,refresh:()=>k()}},O=({heroBadge:t,tabs:a,activeTab:r,onTabChange:l})=>e.jsxs("div",{className:"relative overflow-hidden rounded-[44px] border border-white/20 dark:border-white/5 bg-gradient-to-br from-[#dbeafe] via-[#fdf2f8] to-[#fef3c7] dark:from-[#111827] dark:via-[#1f2937] dark:to-[#312e81] shadow-[0_45px_120px_rgba(15,23,42,0.35)]",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute -top-10 -left-6 w-64 h-64 bg-gradient-to-br from-[#f472b6]/40 via-transparent to-transparent blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-80 h-80 bg-gradient-to-br from-[#22d3ee]/30 via-transparent to-transparent blur-[120px]"})]}),e.jsxs("div",{className:"relative px-6 py-8 sm:px-10 text-slate-900 dark:text-white",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_auto] lg:items-start",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.35em] text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/70 dark:bg-white/10 text-rose-500",children:e.jsx(K,{className:"w-3.5 h-3.5"})}),"MTSS Studio"]}),e.jsx("div",{className:"inline-flex px-3 py-1 rounded-full bg-white/80 dark:bg-white/10 border border-white/60 dark:border-white/20 tracking-[0.3em] uppercase text-[11px] font-semibold text-slate-600 dark:text-slate-200",children:t.school}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-black leading-tight bg-gradient-to-r from-[#0f172a] via-[#334155] to-[#1d4ed8] dark:from-white dark:via-[#c7d2fe] dark:to-[#f472b6] text-transparent bg-clip-text",children:t.greeting||`Hey ${t.teacher}, let's light up today's boosts.`})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 px-4 py-3 rounded-3xl bg-white/70 dark:bg-white/5 border border-white/50 dark:border-white/10 shadow-inner max-w-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[0.65rem] uppercase tracking-[0.3em] text-slate-500 dark:text-slate-300",children:"Teacher"}),e.jsx("p",{className:"text-base font-semibold",children:t.teacher})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[0.65rem] uppercase tracking-[0.3em] text-slate-500 dark:text-slate-300",children:"Today"}),e.jsx("p",{className:"text-base font-semibold",children:t.dateLabel||"Ready to roll"})]})]})]}),e.jsx("div",{className:"mt-8 grid grid-cols-2 sm:grid-cols-4 gap-3",children:a.map(c=>{const b=c.icon,i=r===c.key;return e.jsxs("button",{onClick:()=>l(c.key),className:`flex items-center justify-between gap-2 rounded-3xl px-4 py-3 text-sm font-semibold transition shadow-[0_12px_35px_rgba(15,23,42,0.15)] border ${i?"bg-gradient-to-r from-[#22d3ee] via-[#3b82f6] to-[#a855f7] text-white border-transparent":"bg-white/75 dark:bg-white/10 text-slate-600 dark:text-slate-200 border-white/70 dark:border-white/15 hover:bg-white hover:dark:bg-white/15"}`,"aria-pressed":i,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex h-8 w-8 items-center justify-center rounded-full ${i?"bg-white/30 text-white":"bg-white/80 dark:bg-white/10 text-slate-500 dark:text-slate-200"}`,children:e.jsx(b,{className:"w-4 h-4"})}),c.label]}),e.jsx(ie,{className:`w-4 h-4 transition-transform ${i?"translate-x-1":""}`})]},c.key)})})]})]});O.displayName="TeacherHeroSection";const pe=s.memo(O),xe=s.lazy(()=>M(()=>import("./DashboardOverview-DOpQyBDv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),fe=s.lazy(()=>M(()=>import("./StudentsPanel-WLilFfp2.js"),__vite__mapDeps([9,1,2,3,10,11,12,13]))),ve=s.lazy(()=>M(()=>import("./InterventionFormPanel-Bb7Vt1Ro.js"),__vite__mapDeps([14,1,2,10,11]))),ye=s.lazy(()=>M(()=>import("./ProgressFormPanel-Dh3NybYt.js"),__vite__mapDeps([15,1,2,10,11]))),ke=()=>e.jsx("div",{className:"glass glass-card p-8 text-center text-muted-foreground animate-pulse",children:"Loading panel..."}),we=s.memo(()=>{const{toast:t}=V(),{statCards:a,students:r,progressData:l,heroBadge:c,loading:b,error:i,refresh:g}=be(),{activeTab:p,setActiveTab:y,interventionForm:x,progressForm:n,handleInterventionChange:S,handleProgressChange:C,handleSavePlan:j,resetProgressForm:k,submittingPlan:m,setSubmittingProgress:u,submittingProgress:N}=ue($),{base:d,textarea:o,notes:h}=T,f=s.useCallback(async _=>{if(_.preventDefault(),!n.studentId||!n.date||n.scoreValue===""){t({title:"Complete the required fields",description:"Student, date, and score are required to submit progress.",variant:"destructive"});return}const v=r.find(P=>P.id===n.studentId);if(!v){t({title:"Select a student",description:"Choose a student before logging progress.",variant:"destructive"});return}if(!v.assignmentId){t({title:"No active intervention",description:`${v.name} is not linked to an active intervention yet.`,variant:"destructive"});return}try{u(!0),await oe(v.assignmentId,{checkIns:[{date:n.date||new Date,summary:n.notes||"Progress update logged via dashboard",nextSteps:n.notes,value:n.scoreValue?Number(n.scoreValue):void 0,unit:n.scoreUnit,performed:n.performed==="yes"}]}),t({title:"Progress saved",description:`${v.name}'s update is now on the dashboard.`}),k(),g()}catch(P){t({title:"Failed to save progress",description:P?.response?.data?.message||P.message||"Unable to record update now.",variant:"destructive"})}finally{u(!1)}},[n,r,t,k,g,u]),w=s.useMemo(()=>{switch(p){case"dashboard":return e.jsx(xe,{statCards:a,students:r,progressData:l,TierPill:E,ProgressBadge:F});case"students":return e.jsx(fe,{students:r,TierPill:E,ProgressBadge:F,onRefresh:g});case"create":return e.jsx(ve,{formState:x,onChange:S,onSubmit:_=>j(_,x),baseFieldClass:d,textareaClass:o,students:r,submitting:m});case"submit":return e.jsx(ye,{formState:n,onChange:C,onSubmit:f,baseFieldClass:d,textareaClass:h,students:r,submitting:N});default:return null}},[p,x,n,S,C,j,f,d,o,h,a,r,l,g]);return e.jsxs("div",{className:"mtss-theme mtss-animated-bg min-h-screen relative overflow-hidden text-foreground dark:text-white transition-colors",children:[(m||N)&&e.jsx(Y,{}),e.jsx("div",{className:"mtss-bg-overlay"}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 h-64 bg-gradient-to-b from-white/70 via-[#fef2f2]/40 to-transparent dark:from-white/10 dark:via-white/5"}),e.jsx("div",{className:"absolute -bottom-24 left-12 w-[28rem] h-[28rem] bg-gradient-to-br from-[#22d3ee]/35 via-[#a855f7]/25 to-[#f472b6]/20 dark:from-[#0ea5e9]/25 dark:via-[#a855f7]/20 dark:to-[#f472b6]/15 blur-[200px]"})]}),e.jsxs("div",{className:"relative z-20 container-tight px-4 sm:px-6 py-8 lg:py-14 space-y-8 lg:space-y-10",children:[e.jsx(J.section,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mtss-gradient-border overflow-hidden rounded-3xl border border-white/40 dark:border-white/10 shadow-[0_25px_60px_rgba(148,163,184,0.25)]","data-aos":"fade-up","data-aos-duration":"700",children:e.jsx(pe,{heroBadge:c,tabs:$,activeTab:p,onTabChange:y})}),(b||i)&&e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-white/60 dark:bg-white/5 px-4 py-3 flex items-center justify-between gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[b&&e.jsx(Q,{className:"w-4 h-4 animate-spin text-primary"}),e.jsx("span",{children:i||"Syncing live MTSS data..."})]}),i&&e.jsx("button",{onClick:g,className:"text-primary font-semibold hover:underline",children:"Retry"})]}),e.jsx(s.Suspense,{fallback:e.jsx(ke,{}),children:w})]})]})});we.displayName="TeacherDashboardPage";export{we as default};
