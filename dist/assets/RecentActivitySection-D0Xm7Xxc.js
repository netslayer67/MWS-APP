import{r as i,aB as q,aM as ge,j as e,U as H,X as ve,Q as je,S as W,T as ye,a as be}from"./index-BeQwOtyQ.js";import{T as z}from"./EmotionalCheckinDashboard-DbEewALQ.js";import{c as R,l as J,bh as Q,bi as Z,bj as Ne,bk as we,bu as Pe,ar as V,w as ee,aQ as te,y as Ae,b8 as Ie,C as Se,b9 as De,G as Ee,u as se,aK as Le,au as Ce,A as ke,U as _,bv as ae,L as re,j as ne,bw as G,am as X,D as Te,J as Oe,F as D,N as We,be as Me,X as Re,x as _e,a as Fe,R as Ke}from"./CategoricalChart-BMqhUz2Q.js";import{u as Ue,G as Be,C as ze,a as Ve,X as Ge,Y as Xe,T as $e}from"./CartesianChart-BRX7XIZz.js";import{A as Ye,D as qe}from"./ActivePoints-hEmJ1Vin.js";import{S as He}from"./ErrorBarContext-BLoWLUfG.js";import{E as Je}from"./eye-KbYtPAUo.js";import{C as Qe}from"./clock-iFkKRRSX.js";import"./socketService-CrK7Ga1g.js";import"./funnel-JNZh20hC.js";import"./users-BVc-u3T_.js";import"./building-DZs_ogcB.js";var le=(t,a,r,s)=>Q(t,"xAxis",a,s),ie=(t,a,r,s)=>Z(t,"xAxis",a,s),oe=(t,a,r,s)=>Q(t,"yAxis",r,s),de=(t,a,r,s)=>Z(t,"yAxis",r,s),Ze=R([J,le,oe,ie,de],(t,a,r,s,o)=>Pe(t,"xAxis")?V(a,s,!1):V(r,o,!1)),et=(t,a,r,s,o)=>o;function tt(t){return t.type==="line"}var st=R([we,et],(t,a)=>t.filter(tt).find(r=>r.id===a)),at=R([J,le,oe,ie,de,st,Ze,Ne],(t,a,r,s,o,d,m,u)=>{var{chartData:x,dataStartIndex:l,dataEndIndex:f}=u;if(!(d==null||a==null||r==null||s==null||o==null||s.length===0||o.length===0||m==null)){var{dataKey:p,data:n}=d,c;if(n!=null&&n.length>0?c=n:c=x?.slice(l,f+1),c!=null)return At({layout:t,xAxis:a,yAxis:r,xAxisTicks:s,yAxisTicks:o,dataKey:p,bandSize:m,displayedData:c})}}),rt=["id"],nt=["type","layout","connectNulls","needClip"],lt=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function $(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,s)}return r}function j(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?$(Object(r),!0).forEach(function(s){it(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function it(t,a,r){return(a=ot(a))in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function ot(t){var a=dt(t,"string");return typeof a=="symbol"?a:a+""}function dt(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,a);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function F(t,a){if(t==null)return{};var r,s,o=ct(t,a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(s=0;s<d.length;s++)r=d[s],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function ct(t,a){if(t==null)return{};var r={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(a.indexOf(s)!==-1)continue;r[s]=t[s]}return r}function I(){return I=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},I.apply(null,arguments)}var mt=t=>{var{dataKey:a,name:r,stroke:s,legendType:o,hide:d}=t;return[{inactive:d,dataKey:a,type:o,color:s,value:se(r,a),payload:t}]};function ut(t){var{dataKey:a,data:r,stroke:s,strokeWidth:o,fill:d,name:m,hide:u,unit:x}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:s,strokeWidth:o,fill:d,dataKey:a,nameKey:void 0,name:se(m,a),hide:u,type:t.tooltipType,color:t.stroke,unit:x}}}var ce=(t,a)=>"".concat(a,"px ").concat(t-a,"px");function xt(t,a){for(var r=t.length%2!==0?[...t,0]:t,s=[],o=0;o<a;++o)s=[...s,...r];return s}var pt=(t,a,r)=>{var s=r.reduce((p,n)=>p+n);if(!s)return ce(a,t);for(var o=Math.floor(t/s),d=t%s,m=a-t,u=[],x=0,l=0;x<r.length;l+=r[x],++x)if(l+r[x]>d){u=[...r.slice(0,x),d-l];break}var f=u.length%2===0?[0,m]:[m];return[...xt(r,o),...u,...f].map(p=>"".concat(p,"px")).join(", ")};function ht(t,a){var r;if(i.isValidElement(t))r=i.cloneElement(t,a);else if(typeof t=="function")r=t(a);else{var s=q("recharts-line-dot",typeof t!="boolean"?t.className:"");r=i.createElement(qe,I({},a,{className:s}))}return r}function ft(t,a){return t==null?!1:a?!0:t.length===1}function gt(t){var{clipPathId:a,points:r,props:s}=t,{dot:o,dataKey:d,needClip:m}=s;if(!ft(r,o))return null;var{id:u}=s,x=F(s,rt),l=ae(o),f=_e(x),p=_(o,!0),n=r.map((g,h)=>{var v=j(j(j({key:"dot-".concat(h),r:3},f),p),{},{index:h,cx:g.x,cy:g.y,dataKey:d,value:g.value,payload:g.payload,points:r});return ht(o,v)}),c={clipPath:m?"url(#clipPath-".concat(l?"":"dots-").concat(a,")"):void 0};return i.createElement(re,I({className:"recharts-line-dots",key:"dots"},c),n)}function vt(t){var{showLabels:a,children:r,points:s}=t,o=i.useMemo(()=>s?.map(d=>{var m={x:d.x,y:d.y,width:0,height:0};return j(j({},m),{},{value:d.value,payload:d.payload,viewBox:m,parentViewBox:void 0,fill:void 0})}),[s]);return i.createElement(Me,{value:a?o:null},r)}function Y(t){var{clipPathId:a,pathRef:r,points:s,strokeDasharray:o,props:d}=t,{type:m,layout:u,connectNulls:x,needClip:l}=d,f=F(d,nt),p=j(j({},_(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(a,")"):void 0,points:s,type:m,layout:u,connectNulls:x,strokeDasharray:o??d.strokeDasharray});return i.createElement(i.Fragment,null,s?.length>1&&i.createElement(Re,I({},p,{pathRef:r})),i.createElement(gt,{points:s,clipPathId:a,props:d}))}function jt(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function yt(t){var{clipPathId:a,props:r,pathRef:s,previousPointsRef:o,longestAnimatedLengthRef:d}=t,{points:m,strokeDasharray:u,isAnimationActive:x,animationBegin:l,animationDuration:f,animationEasing:p,animateNewValues:n,width:c,height:g,onAnimationEnd:h,onAnimationStart:v}=r,b=o.current,P=Te(r,"recharts-line-"),[N,E]=i.useState(!1),L=!N,k=i.useCallback(()=>{typeof h=="function"&&h(),E(!1)},[h]),T=i.useCallback(()=>{typeof v=="function"&&v(),E(!0)},[v]),A=jt(s.current),C=d.current;return i.createElement(vt,{points:m,showLabels:L},r.children,i.createElement(Oe,{animationId:P,begin:l,duration:f,isActive:x,easing:p,onAnimationEnd:k,onAnimationStart:T,key:P},w=>{var xe=D(C,A+C,w),O=Math.min(xe,A),S;if(x)if(u){var pe="".concat(u).split(/[,\s]+/gim).map(y=>parseFloat(y));S=pt(O,A,pe)}else S=ce(A,O);else S=u==null?void 0:String(u);if(b){var he=b.length/m.length,K=w===1?m:m.map((y,fe)=>{var U=Math.floor(fe*he);if(b[U]){var B=b[U];return j(j({},y),{},{x:D(B.x,y.x,w),y:D(B.y,y.y,w)})}return n?j(j({},y),{},{x:D(c*2,y.x,w),y:D(g/2,y.y,w)}):j(j({},y),{},{x:y.x,y:y.y})});return o.current=K,i.createElement(Y,{props:r,points:K,clipPathId:a,pathRef:s,strokeDasharray:S})}return w>0&&A>0&&(o.current=m,d.current=O),i.createElement(Y,{props:r,points:m,clipPathId:a,pathRef:s,strokeDasharray:S})}),i.createElement(We,{label:r.label}))}function bt(t){var{clipPathId:a,props:r}=t,s=i.useRef(null),o=i.useRef(0),d=i.useRef(null);return i.createElement(yt,{props:r,clipPathId:a,previousPointsRef:s,longestAnimatedLengthRef:o,pathRef:d})}var Nt=(t,a)=>({x:t.x,y:t.y,value:t.value,errorVal:ne(t.payload,a)});class wt extends i.Component{render(){var a,{hide:r,dot:s,points:o,className:d,xAxisId:m,yAxisId:u,top:x,left:l,width:f,height:p,id:n,needClip:c}=this.props;if(r)return null;var g=q("recharts-line",d),h=n,{r:v=3,strokeWidth:b=2}=(a=_(s,!1))!==null&&a!==void 0?a:{r:3,strokeWidth:2},P=ae(s),N=v*2+b;return i.createElement(i.Fragment,null,i.createElement(re,{className:g},c&&i.createElement("defs",null,i.createElement(Be,{clipPathId:h,xAxisId:m,yAxisId:u}),!P&&i.createElement("clipPath",{id:"clipPath-dots-".concat(h)},i.createElement("rect",{x:l-N/2,y:x-N/2,width:f+N,height:p+N}))),i.createElement(He,{xAxisId:m,yAxisId:u,data:o,dataPointFormatter:Nt,errorBarOffset:0},i.createElement(bt,{props:this.props,clipPathId:h}))),i.createElement(Ye,{activeDot:this.props.activeDot,points:o,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var me={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Ee.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function Pt(t){var a=ee(t,me),{activeDot:r,animateNewValues:s,animationBegin:o,animationDuration:d,animationEasing:m,connectNulls:u,dot:x,hide:l,isAnimationActive:f,label:p,legendType:n,xAxisId:c,yAxisId:g,id:h}=a,v=F(a,lt),{needClip:b}=Ue(c,g),P=Le(),N=Ce(),E=te(),L=ke(w=>at(w,c,g,E,h));if(N!=="horizontal"&&N!=="vertical"||L==null||P==null)return null;var{height:k,width:T,x:A,y:C}=P;return i.createElement(wt,I({},v,{id:h,connectNulls:u,dot:x,activeDot:r,animateNewValues:s,animationBegin:o,animationDuration:d,animationEasing:m,isAnimationActive:f,hide:l,label:p,legendType:n,xAxisId:c,yAxisId:g,points:L,layout:N,height:k,width:T,left:A,top:C,needClip:b}))}function At(t){var{layout:a,xAxis:r,yAxis:s,xAxisTicks:o,yAxisTicks:d,dataKey:m,bandSize:u,displayedData:x}=t;return x.map((l,f)=>{var p=ne(l,m);if(a==="horizontal"){var n=G({axis:r,ticks:o,bandSize:u,entry:l,index:f}),c=X(p)?null:s.scale(p);return{x:n,y:c,value:p,payload:l}}var g=X(p)?null:r.scale(p),h=G({axis:s,ticks:d,bandSize:u,entry:l,index:f});return g==null||h==null?null:{x:g,y:h,value:p,payload:l}}).filter(Boolean)}function It(t){var a=ee(t,me),r=te();return i.createElement(Ae,{id:a.id,type:"line"},s=>i.createElement(i.Fragment,null,i.createElement(Ie,{legendPayload:mt(a)}),i.createElement(Se,{fn:ut,args:a}),i.createElement(De,{type:"line",id:s,data:a.data,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,hide:a.hide,isPanorama:r}),i.createElement(Pt,I({},a,{id:s}))))}var M=i.memo(It);M.displayName="Line";var St=["axis"],Dt=i.forwardRef((t,a)=>i.createElement(ze,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:St,tooltipPayloadSearcher:Fe,categoricalChartProps:t,ref:a}));const ue=i.memo(({user:t,isOpen:a,onClose:r})=>{const[s,o]=i.useState(null),[d,m]=i.useState(!1),[u,x]=i.useState("month");i.useEffect(()=>{a&&t?.id&&l()},[a,t,u]);const l=async()=>{if(t?.id){m(!0);try{console.log("Fetching trends for user:",t.id,"period:",u);const n=await ge(t.id,u);console.log("User trends response:",n.data),o(n.data)}catch(n){console.error("Error fetching user trends:",n),o(null)}finally{m(!1)}}};if(!a||!t)return null;const f=({active:n,payload:c,label:g})=>{if(n&&c&&c.length){const h=c[0]?.payload;return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg max-w-xs",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:new Date(g).toLocaleDateString()}),c.map((v,b)=>e.jsxs("p",{className:"text-sm",style:{color:v.color},children:[v.name,": ",v.value,"/10"]},b)),h&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-border/50",children:[h.selectedMoods&&h.selectedMoods.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Moods: ",h.selectedMoods.join(", ")]}),h.weatherType&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Weather: ",h.weatherType]}),h.needsSupport&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:"Support requested"})]})]})}return null},p=[{id:"week",label:"Week"},{id:"month",label:"Month"},{id:"semester",label:"Semester"}];return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:t.name}),e.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:[t.role," • ",t.department]})]})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-muted rounded-lg transition-colors",children:e.jsx(ve,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)] space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(je,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Period:"}),e.jsx("div",{className:"flex gap-1",children:p.map(n=>e.jsx("button",{onClick:()=>x(n.id),className:`px-3 py-1 text-xs rounded-full transition-colors ${u===n.id?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:n.label},n.id))})]}),s&&s.summary&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(W,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Avg Presence"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[s.summary.averagePresence?.toFixed(1)||0,"/10"]})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Avg Capacity"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[s.summary.averageCapacity?.toFixed(1)||0,"/10"]})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(z,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Support Needed"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[s.summary.supportNeededCount||0," times"]})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(W,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Emotional Stability"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[s.summary.emotionalStability?(s.summary.emotionalStability*100).toFixed(0):0,"%"]})]})]}),s&&s.summary&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground mb-3",children:"Mood Patterns"}),s.summary.moodPatterns&&Object.keys(s.summary.moodPatterns).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(s.summary.moodPatterns).sort(([,n],[,c])=>c-n).slice(0,5).map(([n,c])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:n}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${c/Math.max(...Object.values(s.summary.moodPatterns))*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground w-6 text-right",children:c})]})]},n))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No mood data available"})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground mb-3",children:"Weather Patterns"}),s.summary.weatherPatterns&&Object.keys(s.summary.weatherPatterns).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(s.summary.weatherPatterns).sort(([,n],[,c])=>c-n).slice(0,5).map(([n,c])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:n.replace("-"," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${c/Math.max(...Object.values(s.summary.weatherPatterns))*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground w-6 text-right",children:c})]})]},n))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No weather data available"})]})]}),s&&s.summary&&s.summary.insights&&s.summary.insights.length>0&&e.jsxs("div",{className:"glass glass-card p-4 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground mb-3",children:"AI Insights"}),e.jsx("div",{className:"space-y-2",children:s.summary.insights.map((n,c)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-muted/20 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-foreground",children:n})]},c))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Emotional Trends"}),d?e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading trends..."})}):s?.trends&&s.trends.length>0?e.jsx("div",{className:"h-64",children:e.jsx(Ke,{width:"100%",height:"100%",children:e.jsxs(Dt,{data:s.trends,children:[e.jsx(Ve,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(Ge,{dataKey:"date",className:"text-xs",tick:{fill:"currentColor"},tickFormatter:n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(Xe,{domain:[0,10],className:"text-xs",tick:{fill:"currentColor"}}),e.jsx($e,{content:e.jsx(f,{})}),e.jsx(M,{type:"monotone",dataKey:"presenceLevel",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2},name:"Presence"}),e.jsx(M,{type:"monotone",dataKey:"capacityLevel",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2},name:"Capacity"})]})})}):e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"No trend data available"})})]}),s?.weeklyAverages&&s.weeklyAverages.length>0&&e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Weekly Emotional Trends"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:s.weeklyAverages.map((n,c)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-card/40 rounded-lg border border-border/40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-lg",children:n.dominantWeather==="sunny"?"☀️":n.dominantWeather==="cloudy"?"☁️":n.dominantWeather==="rain"?"🌧️":n.dominantWeather==="storm"?"⛈️":n.dominantWeather==="tornado"?"🌪️":"❄️"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-foreground",children:["Week of ",n.week]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.dominantMoods?.join(", ")," • ",n.checkinCount," check-ins"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["P: ",n.avgPresence,"/10"]}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["C: ",n.avgCapacity,"/10"]})]})]},c))})]}),s?.trends&&s.trends.length>0&&e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Recent Check-ins"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:s.trends.slice(-10).reverse().map((n,c)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-card/40 rounded-lg border border-border/40",children:[e.jsx("div",{className:"text-lg flex-shrink-0",children:n.weatherType==="sunny"?"☀️":n.weatherType==="cloudy"?"☁️":n.weatherType==="rain"?"🌧️":n.weatherType==="storm"?"⛈️":n.weatherType==="tornado"?"🌪️":"❄️"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:new Date(n.date).toLocaleDateString()}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["P: ",n.presenceLevel,"/10"]}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["C: ",n.capacityLevel,"/10"]})]})]}),n.selectedMoods&&n.selectedMoods.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Moods: ",n.selectedMoods.join(", ")]}),n.details&&e.jsxs("p",{className:"text-sm text-foreground italic",children:['"',n.details.length>100?n.details.substring(0,100)+"...":n.details,'"']}),n.needsSupport&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Support requested"]})})]})]},c))})]})]})]})})});ue.displayName="UserDetailModal";const Et=i.memo(({activities:t=[]})=>{const a=be(),[r,s]=i.useState(null),[o,d]=i.useState(!1);if(!t||t.length===0)return null;const m=l=>{a(`/emotional-wellness/${l.userId}`)},u=l=>{s({id:l.userId,name:l.userName,role:l.role,department:l.department,weatherType:l.weatherType,presenceLevel:l.presenceLevel,capacityLevel:l.capacityLevel,selectedMoods:l.selectedMoods,submittedAt:l.submittedAt}),d(!0)},x=l=>({sunny:"☀️",cloudy:"☁️",rain:"🌧️",storm:"⛈️",tornado:"🌪️",snow:"❄️"})[l]||"🌤️";return e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(W,{className:"w-4 h-4 text-primary"}),e.jsxs("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:["Recent Activity (",t.length,")"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.map((l,f)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-card/20 border border-border/20 hover:bg-card/40 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center flex-shrink-0",children:e.jsx(H,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("button",{onClick:()=>m(l),className:"font-medium text-foreground text-sm hover:text-primary transition-colors text-left cursor-pointer",children:l.userName}),e.jsx("span",{className:"text-xs text-muted-foreground capitalize px-2 py-1 rounded-full bg-muted/50",children:l.role}),e.jsx("span",{className:"text-lg",children:x(l.weatherType)}),e.jsx("button",{onClick:()=>u(l),className:"ml-auto p-1 hover:bg-muted/50 rounded transition-colors",title:"View details",children:e.jsx(Je,{className:"w-3 h-3 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-2",children:[e.jsxs("span",{children:["Presence: ",l.presenceLevel,"/10"]}),e.jsxs("span",{children:["Capacity: ",l.capacityLevel,"/10"]}),l.department&&e.jsx("span",{className:"capitalize",children:l.department}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.status==="handled"?"bg-green-100 text-green-800":l.status==="acknowledged"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:l.status==="handled"?"Handled":l.status==="acknowledged"?"Acknowledged":"Pending"})]}),l.status!=="pending"&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Status:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.status==="handled"?"bg-green-100 text-green-800":l.status==="acknowledged"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:l.status==="handled"?"✅ Handled":l.status==="acknowledged"?"👁️ Acknowledged":"⏳ Pending"}),l.respondedAt&&e.jsx("span",{className:"text-muted-foreground",children:new Date(l.respondedAt).toLocaleDateString()})]}),l.responseDetails&&e.jsxs("div",{className:"mt-1 p-2 bg-muted/20 rounded text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Follow-up:"})," ",l.responseDetails]})]}),l.status!=="pending"&&l.responseDetails&&e.jsxs("div",{className:"mt-2 p-2 bg-muted/20 rounded text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Follow-up:"})," ",l.responseDetails]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Qe,{className:"w-3 h-3"}),e.jsx("span",{children:new Date(l.submittedAt).toLocaleString()})]}),l.selectedMoods&&l.selectedMoods.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[l.selectedMoods.slice(0,3).map((p,n)=>e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary capitalize",children:p},n)),l.selectedMoods.length>3&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",l.selectedMoods.length-3," more"]})]})]})]},l.id||f))})]}),e.jsx(ue,{user:r,isOpen:o,onClose:()=>{d(!1),s(null)}})]})});Et.displayName="RecentActivitySection";export{Et as default};
