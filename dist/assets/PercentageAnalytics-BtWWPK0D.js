import{r as p,C as d,j as e,V as f}from"./index-lnI9yl67.js";import B from"./ExportButton-CboTwPCN.js";import{U as G}from"./UserListModal-B_OzpQkU.js";import{T as c}from"./EmotionalCheckinDashboard-ue2k9TXg.js";import{T as _}from"./target-C7epHUhn.js";import{U as H}from"./users-DabiYGED.js";import{C as K}from"./clock-CUiCAvu7.js";import{R as U}from"./CategoricalChart-CzyExel_.js";import{P,a as k}from"./PieChart-Er6M5sig.js";import{C as A}from"./tooltipContext-DfFGRDbd.js";import"./circle-alert-qVM58wI_.js";import"./cloud-LEGmGAAm.js";import"./smile-CQrNu_WB.js";import"./socketService-DK54WtJ1.js";import"./funnel-dqau3Pax.js";import"./building-YMY9fLcF.js";const q=p.memo(({data:o={},period:R})=>{const[l,n]=p.useState({isOpen:!1,title:"",users:[],totalUsers:0,type:""}),t=p.useMemo(()=>{if(!o)return null;const s=o.totalUsers||0,a=o.totalCheckins||0,S=o.submissionRate||0,m=o.flaggedUsers?.length||0,j=s>0?Math.round(m/s*100):0,T=100-j,W=S,b=o.moodDistribution||{},z=o.aiMoodIndicators||{},N=Object.values(b).reduce((r,i)=>r+i,0),x=Object.entries(b).map(([r,i])=>({mood:r.charAt(0).toUpperCase()+r.slice(1),count:i,percentage:N>0?Math.round(i/N*100):0,isAIGenerated:z[r]||r.includes("ai")||r.includes("AI")||r.includes("detected")})).sort((r,i)=>i.percentage-r.percentage),v=o.weatherDistribution||{},D=o.aiWeatherIndicators||{},w=Object.values(v).reduce((r,i)=>r+i,0),E=Object.entries(v).map(([r,i])=>({weather:r.charAt(0).toUpperCase()+r.slice(1),count:i,percentage:w>0?Math.round(i/w*100):0,isAIGenerated:D[r]||r.includes("ai")||r.includes("AI")||r.includes("pattern")||r.includes("analyzed")})).sort((r,i)=>i.percentage-r.percentage),y=o.unitBreakdown||[],C=y.reduce((r,i)=>r+(i.submitted||0),0),F=y.map(r=>({unit:r.unit||"Unknown",count:r.submitted||0,percentage:C>0?Math.round(r.submitted/C*100):0})).sort((r,i)=>i.percentage-r.percentage),u=[],h=[],g=s>0?m/s*100:0;return g>20&&u.push({type:"high",title:"High Support Need",message:`${g.toFixed(1)}% of users indicated they need support. Consider proactive outreach.`,icon:c,color:"text-red-500"}),x.some(r=>["sad","anxious","overwhelmed"].includes(r.mood.toLowerCase()))&&u.push({type:"medium",title:"Emotional Well-being Concerns",message:"Negative mood patterns detected. Monitor closely and consider additional support resources.",icon:c,color:"text-yellow-500"}),g<10&&h.push({title:"Strong Team Resilience",message:"Low support requests indicate good overall team well-being.",icon:d,color:"text-green-500"}),x.some(r=>["happy","excited","calm"].includes(r.mood.toLowerCase()))&&h.push({title:"Positive Team Dynamics",message:"Strong presence of positive moods suggests healthy team environment.",icon:d,color:"text-green-500"}),{participationRate:W,flaggedPercentage:j,readinessPercentage:T,moodPercentages:x,weatherPercentages:E,unitPercentages:F,totalUsers:s,totalCheckins:a,flaggedUsers:m,riskFactors:u,positiveIndicators:h,moodLists:o.moodLists||{},weatherLists:o.weatherLists||{},unitLists:o.unitLists||{},notSubmittedUsers:o.notSubmittedUsers||[]}},[o]),M=s=>{n({isOpen:!0,title:`${s.mood} Mood Users`,users:t.moodLists[s.mood.toLowerCase()]||[],totalUsers:t.totalCheckins,type:"mood"})},$=s=>{n({isOpen:!0,title:`${s.weather} Weather Users`,users:t.weatherLists[s.weather.toLowerCase()]||[],totalUsers:t.totalCheckins,type:"weather"})},I=s=>{n({isOpen:!0,title:`${s.unit} Unit Users`,users:t.unitLists[s.unit.toLowerCase()]||[],totalUsers:t.totalCheckins,type:"unit"})},L=()=>{const s=t.totalUsers-t.totalCheckins;n({isOpen:!0,title:`Users Who Haven't Submitted Yet (${s})`,users:t.notSubmittedUsers||[],totalUsers:t.totalUsers,type:"not-submitted"})},O=()=>{n({isOpen:!1,title:"",users:[],totalUsers:0,type:""})};return t?e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:"Overview Analytics"})]}),e.jsx(B,{period:R})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm cursor-pointer hover:bg-card/60 transition-colors",onClick:L,title:"Click to see users who haven't submitted yet",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Participation Rate"}),e.jsx(H,{className:"w-4 h-4 text-emerald-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[t.participationRate,"%"]}),e.jsx("div",{className:"w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 transition-all duration-500 ease-out",style:{width:`${t.participationRate}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.totalCheckins," of ",t.totalUsers," users"]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1 font-medium",children:"Click to view not submitted users"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Emotional Readiness"}),e.jsx(f,{className:"w-4 h-4 text-emerald-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[t.readinessPercentage,"%"]}),e.jsx("div",{className:"w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 transition-all duration-500 ease-out",style:{width:`${t.readinessPercentage}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.totalUsers-t.flaggedUsers," of ",t.totalUsers," users ready"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-white/20 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Top Mood"}),e.jsx(f,{className:"w-4 h-4 text-blue-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[t.moodPercentages[0]?.percentage||0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:t.moodPercentages[0]?.mood||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.moodPercentages[0]?.count||0," responses"]}),t.moodPercentages[0]?.count===0&&e.jsx("div",{className:"mt-2 w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gray-400 to-gray-300 w-full"})})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Top Weather"}),e.jsx(f,{className:"w-4 h-4 text-purple-500"})]}),e.jsxs("div",{className:"text-2xl font-bold text-foreground mb-1",children:[t.weatherPercentages[0]?.percentage||0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:t.weatherPercentages[0]?.weather||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.weatherPercentages[0]?.count||0," responses"]}),t.weatherPercentages[0]?.count===0&&e.jsx("div",{className:"mt-2 w-full bg-muted/30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gray-400 to-gray-300 w-full"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-foreground mb-3 flex items-center gap-2",children:[e.jsx(c,{className:"w-4 h-4 text-red-500"}),"Risk Factors"]}),e.jsx("div",{className:"space-y-2",children:t.riskFactors?.length>0?t.riskFactors.slice(0,2).map((s,a)=>e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(c,{className:`w-4 h-4 mt-0.5 ${s.color}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.message})]})]})},a)):e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-4 h-4 text-green-500"}),e.jsx("p",{className:"text-sm text-green-700",children:"No significant risk factors detected"})]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-foreground mb-3 flex items-center gap-2",children:[e.jsx(d,{className:"w-4 h-4 text-green-500"}),"Positive Indicators"]}),e.jsx("div",{className:"space-y-2",children:t.positiveIndicators?.length>0?t.positiveIndicators.slice(0,2).map((s,a)=>e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(d,{className:`w-4 h-4 mt-0.5 ${s.color}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.message})]})]})},a)):e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-yellow-500"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Monitoring for positive indicators"})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Mood Distribution"}),e.jsx("div",{className:"h-48",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsx(P,{children:e.jsx(k,{data:t.moodPercentages.slice(0,5),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"count",onClick:(s,a)=>M(t.moodPercentages.slice(0,5)[a]),style:{cursor:"pointer"},children:t.moodPercentages.slice(0,5).map((s,a)=>e.jsx(A,{fill:`hsl(${a*60}, 70%, 50%)`,style:{cursor:"pointer"}},`mood-${a}`))})})})}),e.jsx("div",{className:"mt-2 space-y-1",children:t.moodPercentages.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${a*60}, 70%, 50%)`}}),e.jsxs("span",{className:"text-foreground capitalize",children:[s.mood,s.isAIGenerated&&e.jsx("span",{className:"ml-1 text-xs text-blue-600 font-medium",children:"(AI)"})]})]}),e.jsxs("span",{className:"text-muted-foreground",children:[s.percentage,"% (",s.count,")"]})]},s.mood))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Weather Distribution"}),e.jsx("div",{className:"h-48",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsx(P,{children:e.jsx(k,{data:t.weatherPercentages.slice(0,5),cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:2,dataKey:"count",onClick:(s,a)=>$(t.weatherPercentages.slice(0,5)[a]),style:{cursor:"pointer"},children:t.weatherPercentages.slice(0,5).map((s,a)=>e.jsx(A,{fill:`hsl(${a*45+180}, 70%, 50%)`,style:{cursor:"pointer"}},`weather-${a}`))})})})}),e.jsx("div",{className:"mt-2 space-y-1",children:t.weatherPercentages.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${a*45+180}, 70%, 50%)`}}),e.jsxs("span",{className:"text-foreground capitalize",children:[s.weather,s.isAIGenerated&&e.jsx("span",{className:"ml-1 text-xs text-blue-600 font-medium",children:"(AI)"})]})]}),e.jsxs("span",{className:"text-muted-foreground",children:[s.percentage,"% (",s.count,")"]})]},s.weather))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Unit Distribution"}),e.jsx("div",{className:"space-y-2",children:t.unitPercentages.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between cursor-pointer hover:bg-muted/20 p-1 rounded transition-colors",onClick:()=>I(s),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${a*72+90}, 70%, 50%)`}}),e.jsx("span",{className:"text-sm text-foreground capitalize",children:s.unit})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-muted/30 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-accent transition-all duration-500 ease-out",style:{width:`${s.percentage}%`}})}),e.jsxs("span",{className:"text-xs text-muted-foreground w-8 text-right",children:[s.percentage,"%"]})]})]},s.unit))})]})]})]}),e.jsx(G,{isOpen:l.isOpen,onClose:O,title:l.title,users:l.users,totalUsers:l.totalUsers,type:l.type})]}):null});q.displayName="PercentageAnalytics";export{q as default};
