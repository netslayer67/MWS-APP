import{r as d,j as e,a3 as j,a5 as y}from"./index-BAvDP42J.js";import{U as b}from"./UserListModal-DmYBXVqw.js";import{R as N}from"./CategoricalChart-D6Cr5XWB.js";import{A as g,a as p}from"./AreaChart-CiWixNpU.js";import{C as v,X as C,T as O}from"./CartesianChart-UUvDUv8V.js";import{Y as w}from"./YAxis-C3M7tnLj.js";import"./circle-alert-D_BG5dHR.js";import"./users-w-z2oeKI.js";import"./cloud-Bn5XFfqP.js";import"./smile-C66Sjx_r.js";import"./ActivePoints-Bok-0DiS.js";const T=i=>{if(!i)return null;const o=new Date(i);return Number.isNaN(o.getTime())?null:o.toISOString().split("T")[0]},U=d.memo(({userData:i=[],selectedUser:o=null,period:S="week"})=>{const[l,m]=d.useState({isOpen:!1,title:"",users:[],totalUsers:0,type:""}),c=d.useMemo(()=>{if(!i||i.length===0)return[];const t={};return i.forEach(s=>{const a=T(s.date||s.submittedAt);a&&(t[a]||(t[a]={date:a,presence:[],capacity:[],count:0,users:[]}),t[a].presence.push(s.presenceLevel),t[a].capacity.push(s.capacityLevel),t[a].count++,t[a].users.push(s))}),Object.values(t).map(s=>({date:s.date,presence:s.presence.reduce((a,r)=>a+r,0)/s.presence.length,capacity:s.capacity.reduce((a,r)=>a+r,0)/s.capacity.length,submissions:s.count,users:s.users||[]})).sort((s,a)=>new Date(s.date)-new Date(a.date))},[i]),x=t=>{t&&t.users&&m({isOpen:!0,title:`Submissions on ${t.date}`,users:t.users,totalUsers:t.submissions,type:"submissions"})},u=()=>{m({isOpen:!1,title:"",users:[],totalUsers:0,type:""})},f=({active:t,payload:s,label:a})=>{if(t&&s&&s.length){const r=c.find(n=>n.date===a);return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:a}),s.map((n,h)=>e.jsxs("p",{className:"text-sm",style:{color:n.color},children:[n.name,": ",n.value.toFixed(1),n.dataKey==="submissions"?"":"/10"]},h)),r&&r.submissions>0&&e.jsxs("button",{onClick:()=>x(r),className:"mt-2 text-xs text-primary hover:underline",children:["View ",r.submissions," submissions"]})]})}return null};return c.length===0?e.jsxs("div",{className:"glass glass-card p-6 text-center",children:[e.jsx(j,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No trend data available"})]}):e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:o?`${o.name}'s Trends`:"Organization Trends"})]}),e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(g,{data:c,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"presenceGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"capacityGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})]}),e.jsx(v,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(C,{dataKey:"date",className:"text-xs",tick:{fill:"currentColor"},tickFormatter:t=>{const s=new Date(t);return Number.isNaN(s.getTime())?t:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})}}),e.jsx(w,{domain:[0,10],className:"text-xs",tick:{fill:"currentColor"}}),e.jsx(O,{content:e.jsx(f,{})}),e.jsx(p,{type:"monotone",dataKey:"presence",stroke:"#10b981",fillOpacity:1,fill:"url(#presenceGradient)",strokeWidth:2,name:"Presence"}),e.jsx(p,{type:"monotone",dataKey:"capacity",stroke:"#3b82f6",fillOpacity:1,fill:"url(#capacityGradient)",strokeWidth:2,name:"Capacity"})]})})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Presence Level"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-muted-foreground",children:"Capacity Level"})]})]})]}),e.jsx(b,{isOpen:l.isOpen,onClose:u,title:l.title,users:l.users,totalUsers:l.totalUsers,type:l.type})]})});U.displayName="UserTrendChart";export{U as default};
