import{j as e,p as F,G as Q,r as t,b as V,e as P,ad as U}from"./index-Z8dj6zX8.js";import{S as D}from"./StudentsTable-ptlcni7x.js";import{Q as R}from"./TeacherDashboardPage-DWrgXosF.js";import{e as B,g as H}from"./interventionSelection-Vcld4Os_.js";import{F as q}from"./funnel-C7lZLzFW.js";import{L as G}from"./layers-CBMJ1bUq.js";import{T as K}from"./triangle-alert-DrWh8ZzH.js";import{S as O}from"./search-D6rES5NY.js";import"./eye-w1BYG8Fq.js";import"./users-round-BrpbYPuy.js";import"./teacherGradeUtils-COfj_G-K.js";import"./teacherSegmentUtils-BaJgF7HQ.js";import"./teacherMappingUtils-CCkqxUdi.js";import"./shield-check-CUyGZ8fJ.js";import"./arrow-right-CMkz8YtS.js";import"./StatusPills-rQV5uUX4.js";const N=[{key:"All",label:"All",icon:G,active:"bg-gradient-to-r from-[#6366f1] via-[#8b5cf6] to-[#a78bfa] text-white shadow-[0_6px_20px_rgba(99,102,241,0.35)] dark:shadow-[0_6px_24px_rgba(99,102,241,0.5)]",idle:"bg-white/60 dark:bg-white/[0.08] border-indigo-200/60 dark:border-indigo-400/30 text-indigo-700 dark:text-indigo-200 hover:bg-white/80 dark:hover:bg-white/[0.14] hover:border-indigo-300 dark:hover:border-indigo-400/50"},{key:"Tier 1",label:"T1",icon:F,active:"bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 text-white shadow-[0_6px_20px_rgba(20,184,166,0.35)] dark:shadow-[0_6px_24px_rgba(20,184,166,0.5)]",idle:"bg-white/60 dark:bg-white/[0.08] border-emerald-200/60 dark:border-emerald-400/30 text-emerald-700 dark:text-emerald-200 hover:bg-white/80 dark:hover:bg-white/[0.14] hover:border-emerald-300 dark:hover:border-emerald-400/50"},{key:"Tier 2",label:"T2",icon:K,active:"bg-gradient-to-r from-amber-500 via-orange-500 to-rose-400 text-white shadow-[0_6px_20px_rgba(249,115,22,0.35)] dark:shadow-[0_6px_24px_rgba(249,115,22,0.5)]",idle:"bg-white/60 dark:bg-white/[0.08] border-amber-200/60 dark:border-amber-400/30 text-amber-700 dark:text-amber-200 hover:bg-white/80 dark:hover:bg-white/[0.14] hover:border-amber-300 dark:hover:border-amber-400/50"},{key:"Tier 3",label:"T3",icon:Q,active:"bg-gradient-to-r from-rose-500 via-pink-500 to-fuchsia-500 text-white shadow-[0_6px_20px_rgba(244,63,94,0.35)] dark:shadow-[0_6px_24px_rgba(244,63,94,0.5)]",idle:"bg-white/60 dark:bg-white/[0.08] border-rose-200/60 dark:border-rose-400/30 text-rose-700 dark:text-rose-200 hover:bg-white/80 dark:hover:bg-white/[0.14] hover:border-rose-300 dark:hover:border-rose-400/50"}];N.map(o=>o.key);const k=10,Y=({activeTier:o,setActiveTier:i,query:m,setQuery:b})=>e.jsxs("div",{className:"relative overflow-hidden rounded-2xl sm:rounded-[28px] border border-white/50 dark:border-white/[0.12] bg-white/70 dark:bg-white/[0.06] backdrop-blur-xl p-3 sm:p-5 flex flex-col gap-2.5 sm:gap-4 shadow-[0_8px_32px_rgba(15,23,42,0.08),inset_0_1px_0_rgba(255,255,255,0.5)] dark:shadow-[0_8px_32px_rgba(0,0,0,0.3),inset_0_1px_0_rgba(255,255,255,0.08)]","data-aos":"fade-up","data-aos-delay":"40",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 h-[1px] bg-gradient-to-r from-transparent via-white/70 dark:via-white/20 to-transparent"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-[1px] bg-gradient-to-r from-transparent via-black/5 dark:via-white/5 to-transparent"})]}),e.jsxs("div",{className:"relative flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1.5 text-[10px] sm:text-xs font-semibold uppercase tracking-[0.2em] sm:tracking-[0.3em] text-slate-500 dark:text-slate-300 whitespace-nowrap",children:[e.jsx(q,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Quick filters"})]}),e.jsx("div",{className:"flex flex-1 gap-1.5 sm:gap-2",children:N.map(r=>{const l=o===r.key,d=r.icon;return e.jsxs("button",{onClick:()=>i(r.key),className:`flex-1 inline-flex items-center justify-center gap-1 sm:gap-1.5 px-2 py-1.5 sm:px-3.5 sm:py-2 rounded-xl sm:rounded-2xl text-[10px] sm:text-xs font-bold uppercase tracking-wider border backdrop-blur-md transition-all duration-200 ${l?`${r.active} border-transparent scale-[1.03]`:`${r.idle} shadow-[inset_0_1px_0_rgba(255,255,255,0.4)] dark:shadow-[inset_0_1px_0_rgba(255,255,255,0.06)] hover:scale-[1.02]`}`,children:[e.jsx(d,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5 flex-shrink-0"}),e.jsx("span",{className:"sm:hidden",children:r.label}),e.jsx("span",{className:"hidden sm:inline",children:r.key})]},r.key)})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search kids or boost type...",value:m,onChange:r=>b(r.target.value),className:"w-full pl-9 sm:pl-11 pr-3 sm:pr-4 py-2 sm:py-2.5 rounded-xl sm:rounded-2xl text-xs sm:text-sm bg-white/50 dark:bg-white/[0.07] backdrop-blur-md border border-white/60 dark:border-white/[0.12] text-slate-800 dark:text-white focus:ring-2 focus:ring-primary/40 focus:outline-none placeholder:text-slate-400 dark:placeholder:text-slate-400 shadow-[inset_0_1px_0_rgba(255,255,255,0.4)] dark:shadow-[inset_0_1px_0_rgba(255,255,255,0.05)] transition-all"})]})]}),z=({visible:o,total:i})=>e.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3","data-aos":"fade-up","data-aos-delay":"60",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"uppercase text-[9px] sm:text-xs text-muted-foreground tracking-[0.3em] sm:tracking-[0.4em]",children:"Crew Roster"}),e.jsx("h2",{className:"text-base sm:text-2xl font-bold text-slate-900 dark:text-white truncate",children:"Kids on your radar today"})]}),e.jsxs("div",{className:"text-[10px] sm:text-sm text-muted-foreground whitespace-nowrap flex-shrink-0",children:[e.jsx("strong",{children:o}),"/",i]})]}),J=({visible:o,total:i,onLoadMore:m})=>e.jsx("div",{className:"flex flex-col items-center gap-2 text-xs text-muted-foreground py-3","data-aos":"fade-up","data-aos-delay":"160",children:o<i?e.jsxs("button",{type:"button",onClick:m,className:"px-4 py-2 rounded-full bg-white/80 dark:bg-white/10 border border-primary/30 text-sm font-semibold text-primary shadow-sm hover:-translate-y-0.5 transition",children:["Load 10 more kids (",o,"/",i,")"]}):e.jsx("span",{className:"px-3 py-1 rounded-full bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-200 border border-emerald-200/70 dark:border-emerald-500/30",children:"All kids loaded"})}),W=t.memo(({students:o,TierPill:i,ProgressBadge:m,onRefresh:b})=>{const r=V(),{toast:l}=P(),[d,S]=t.useState("All"),[v,T]=t.useState(""),[w,f]=t.useState({type:null,student:null}),[C,_]=t.useState(!1),[y,j]=t.useState(k),h=t.useDeferredValue(v.trim().toLowerCase()),c=t.useMemo(()=>o.filter(a=>{const s=B(a.interventions),p=H(s,a.profile,a),n=p?.tier||a.tier,x=d==="All"||n===d;if(!h)return x;const M=s.map(E=>E.label).join(" "),I=`${a.name} ${a.type||""} ${a.grade||""} ${a.className||""} ${p?.label||""} ${M}`.toLowerCase();return x&&I.includes(h)}),[o,d,h]),g=t.useMemo(()=>c.slice(0,Math.min(y,c.length)),[c,y]);t.useEffect(()=>{j(k)},[d,h,o.length]);const $=t.useCallback(a=>{r(`/mtss/student/${a.slug}`)},[r]),A=t.useCallback((a,s)=>f({type:a,student:s}),[]),u=t.useCallback(()=>f({type:null,student:null}),[]),L=t.useCallback(async(a,s)=>{const p=s?.assignmentId||a?.assignmentId;if(!p){l({title:"No active intervention",description:`${a?.name||"Student"} isn't linked to an active intervention yet.`,variant:"destructive"});return}_(!0);try{const n=s.notes?.trim()||"",x=s.scoreValue!==""?Number(s.scoreValue):void 0;await U(p,{checkIns:[{date:s.date,summary:n||"Quick update",nextSteps:n||void 0,value:Number.isFinite(x)?x:void 0,unit:s.scoreUnit,performed:s.performed==="yes",celebration:s.badge}]}),l({title:"Progress update saved",description:`${a.name}'s update was recorded!`}),u(),b?.()}catch(n){l({title:"Failed to save update",description:n?.response?.data?.message||n.message||"Please try again in a moment.",variant:"destructive"})}finally{_(!1)}},[l,u,b]);return e.jsxs("div",{className:"space-y-6 mtss-theme",children:[e.jsx(Y,{activeTier:d,setActiveTier:S,query:v,setQuery:T}),e.jsxs("section",{className:"rounded-[32px] border border-white/40 bg-white/95 dark:bg-slate-900/40 p-6 space-y-4 shadow-[0_14px_48px_rgba(15,23,42,0.14)]","data-aos":"fade-up","data-aos-delay":"80",children:[e.jsx(z,{visible:g.length,total:c.length}),e.jsx("div",{"data-aos":"fade-up","data-aos-delay":"120",children:e.jsx(D,{students:g,TierPill:i,ProgressBadge:m,showActions:!0,onView:$,onUpdate:a=>A("update",a)})}),e.jsx(J,{visible:g.length,total:c.length,onLoadMore:()=>j(a=>Math.min(c.length,a+k))})]}),w.type==="update"&&e.jsx(R,{student:w.student,onClose:u,onSubmit:L,submitting:C})]})});W.displayName="StudentsPanel";export{W as default};
