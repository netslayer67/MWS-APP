import{b as z,N as U,a as B,d as T,r as f,a2 as A,j as e,z as K,m as w,F as O,p as W,a5 as G,H as _}from"./index-BAvDP42J.js";import{C as k,b as D,c as F,a as C}from"./card-BXWjnyF9.js";import{B as M}from"./badge-x5vQCzvW.js";import{s as P}from"./socketService-B4WowktR.js";import{n as v}from"./id-BI_6IGNA.js";const ee=()=>{const H=z(),{userId:I}=U(),Y=B(),{user:g}=T(n=>n.auth),{checkinHistory:h}=T(n=>n.checkin),u=f.useMemo(()=>v(I)||v(g)||v(g?.id)||v(g?._id),[I,g]),c=f.useMemo(()=>!h||!u?[]:(Array.isArray(h)?h:h.data?.checkins||h.checkins||[]).filter(a=>v(a.userId)===u),[h,u]);console.log("EmotionalPatternsPage Debug:",{currentUser:v(g),targetUserId:u,checkinHistoryLength:h?.data?.checkins?.length||h?.length||0,userCheckinsLength:c.length,checkinHistoryKeys:h?Object.keys(h):[],firstCheckin:c[0]});const l=f.useMemo(()=>{if(c.length===0)return null;const n=c.reduce((s,t)=>(s[t.weatherType]=(s[t.weatherType]||0)+1,s),{}),a=Object.entries(n).sort(([,s],[,t])=>t-s).slice(0,5),o={};c.forEach(s=>{s.selectedMoods?.forEach(t=>{o[t]=(o[t]||0)+1})});const j=Object.entries(o).sort(([,s],[,t])=>t-s).slice(0,10),x=c.filter(s=>s.capacityLevel<5).length,r=c.filter(s=>s.presenceLevel<5).length,L=c.filter(s=>s.capacityLevel>=8).length,$=c.filter(s=>s.presenceLevel>=8).length,m=c.slice(0,28),i=m.length>0?{presence:m.reduce((s,t)=>s+t.presenceLevel,0)/m.length,capacity:m.reduce((s,t)=>s+t.capacityLevel,0)/m.length}:null;return{weatherPatterns:a,moodPatterns:j,challenges:{lowCapacityDays:x,lowPresenceDays:r,highCapacityDays:L,highPresenceDays:$},weeklyAvg:i,totalCheckins:c.length}},[c]),q=f.useMemo(()=>{if(!l)return null;const{challenges:n,weeklyAvg:a,totalCheckins:o,weatherPatterns:j,moodPatterns:x}=l;let r=[];if(o>0){const L=g?.name||"You";if(r.push(`ðŸŽ¯ ${L} has completed ${o} emotional check-in${o>1?"s":""} with remarkable consistency. This shows a strong commitment to mental health and self-awareness.`),a){const i=a.presence,s=a.capacity;let t="";i>=8?t=`Your mental presence is exceptional (${i.toFixed(1)}/10) - this shows very high focus and engagement with work and your surroundings.`:i>=6?t=`Your presence is stable (${i.toFixed(1)}/10) with room for improvement. Consider mindfulness techniques to enhance daily focus.`:i>=4?t=`Your presence is moderate (${i.toFixed(1)}/10). This may be related to workload or external factors.`:t=`Your presence needs special attention (${i.toFixed(1)}/10). Consider identifying and addressing the factors affecting it.`,r.push(`ðŸ§  ${t}`);let d="";s>=8?d=`Your energy capacity is very high (${s.toFixed(1)}/10) - this shows exceptional mental resilience and ability to handle challenges well.`:s>=6?d=`Your capacity is good (${s.toFixed(1)}/10) with a solid foundation for productivity.`:s>=4?d=`Your capacity is moderate (${s.toFixed(1)}/10). Consider energy management strategies like regular breaks and good nutrition.`:d=`Your energy capacity needs attention (${s.toFixed(1)}/10). This may indicate fatigue or need for additional support.`,r.push(`âš¡ ${d}`)}if(j&&j.length>0){const i=j[0][0],s=j[0][1]/o*100,t={sunny:`Your emotional weather is dominated by sunny days (${s.toFixed(1)}%), showing consistent optimism and positive energy.`,"light-rain":`You often experience light rain days (${s.toFixed(1)}%), which shows your ability to handle small challenges calmly.`,rainy:`Rainy weather appears quite often (${s.toFixed(1)}%), indicating periods of deep reflection and emotional processing.`,thunderstorms:`Emotional storms appear (${s.toFixed(1)}%), showing high emotional intensity and ability to navigate turbulence.`,windy:`Strong winds often occur (${s.toFixed(1)}%), indicating periods of instability that require grounding.`,snowy:`Snow covers your emotional landscape (${s.toFixed(1)}%), showing a need for warmth and support.`,foggy:`Emotional fog is quite thick (${s.toFixed(1)}%), indicating periods of uncertainty that require clarification.`,cloudy:`Clouds dominate (${s.toFixed(1)}%), showing stable but subdued moods.`};r.push(`ðŸŒ¤ï¸ ${t[i]||`Pola cuaca emosi Anda unik dengan dominasi ${i} (${s.toFixed(1)}%).`}`)}if(x&&x.length>0){const s=x.slice(0,3).map(([p,N])=>{const S=(N/o*100).toFixed(1);return`${p} (${S}%)`}).join(", ");r.push(`ðŸ˜Š Your mood patterns show a strong tendency towards: ${s}. This reflects your unique personality and emotional responses.`);const t=["happy","excited","hopeful","calm","grateful"],d=["anxious","tired","lonely","sad","angry"],y=x.filter(([p])=>t.includes(p)).reduce((p,[,N])=>p+N,0),E=x.filter(([p])=>d.includes(p)).reduce((p,[,N])=>p+N,0);y>E*1.5?r.push(`âœ¨ Deep analysis shows you have a strong positive tendency, with a positive emotions vs challenges ratio of ${(y/E).toFixed(1)}:1. This is a great strength!`):E>y*1.5?r.push("ðŸ” Your emotional patterns show significant periods of challenge. This is an opportunity for resilience development and personal growth."):r.push("âš–ï¸ Your emotional balance is quite good, with healthy variation between positive experiences and challenges. This shows mature emotional intelligence.")}const $=n.lowCapacityDays+n.lowPresenceDays,m=n.highCapacityDays+n.highPresenceDays;if($>m?r.push(`ðŸ“Š Challenge analysis shows you experience more days with low performance (${$} vs ${m} high days). This may be related to sleep patterns, nutrition, or workload. Recommendation: Review your daily routine and consider consulting with mental health professionals.`):m>o*.6&&r.push(`ðŸ† Your emotional performance is outstanding! ${m} days with high capacity/presence from ${o} total check-ins shows exceptional mental resilience. Continue the practices that support your well-being.`),o>=7){const i=c.slice(0,7),s=i.reduce((d,y)=>d+y.presenceLevel,0)/i.length,t=i.reduce((d,y)=>d+y.capacityLevel,0)/i.length;s<a?.presence-1?r.push("ðŸ”® Prediction: Your presence has decreased in the last week. This may be an early signal for intervention - consider additional rest or relaxation techniques."):t>a?.capacity+1&&r.push("ðŸ“ˆ Positive trend detected! Your capacity is increasing. Analysis shows your practices are effective - continue!")}r.push(`ðŸ’¡ Personal Recommendation: Based on your unique patterns, focus on ${n.lowCapacityDays>n.lowPresenceDays?"energy management":"focus improvement"} to optimize your emotional performance.`),o>=14&&r.push(`ðŸŒ± Growth Insight: With ${o} check-ins, you have built a solid foundation for mental health. Continue this consistency to see more meaningful long-term patterns.`)}return r},[l,g?.name]);f.useEffect(()=>{if(g&&u){Y(A({page:1,limit:50,userId:u})),P.connect(),P.joinPersonal(u);const n=a=>{console.log("Real-time personal check-in update:",a),Y(A({page:1,limit:50,userId:u}))};return P.onPersonalNewCheckin(n),()=>{P.offPersonalNewCheckin(n),P.leavePersonal()}}},[Y,g,u]);const R=f.useMemo(()=>({hidden:{opacity:0,y:8},show:{opacity:1,y:0,transition:{staggerChildren:.1}}}),[]),b=f.useMemo(()=>({hidden:{opacity:0,y:6},show:{opacity:1,y:0,transition:{duration:.32}}}),[]);return e.jsxs(e.Fragment,{children:[e.jsx(K,{children:e.jsx("title",{children:"Pola Emosi â€” Kerjain"})}),e.jsx(w.main,{initial:"hidden",animate:"show",variants:R,className:"relative min-h-dvh w-full px-4 pb-12 pt-6",children:e.jsxs("div",{className:"mx-auto max-w-md",children:[e.jsxs(w.header,{variants:b,className:"mb-6 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>H(-1),"aria-label":"Kembali",className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-border bg-card/40 backdrop-blur-md hover:bg-accent/8 transition-colors duration-300",children:e.jsx(O,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Emotional Patterns"}),e.jsx("p",{className:"mt-0.5 text-xs text-muted-foreground",children:"Insights & patterns"})]})]}),l?e.jsxs(e.Fragment,{children:[e.jsx(w.section,{variants:b,children:e.jsxs(k,{className:"glass glass-card",children:[e.jsx(D,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Emotional Weather Patterns"]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-3",children:l.weatherPatterns.map(([n,a])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",className:"text-foreground border-foreground/30",children:n}),e.jsxs("span",{className:"text-sm text-foreground/80",children:[(a/l.totalCheckins*100).toFixed(1),"% of total"]})]}),e.jsxs("span",{className:"text-sm font-medium text-foreground",children:[a," kali"]})]},n))})})]})}),e.jsx(w.section,{variants:b,className:"mt-6",children:e.jsxs(k,{className:"glass glass-card",children:[e.jsx(D,{children:e.jsx(F,{children:"Mood Patterns"})}),e.jsx(C,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:l.moodPatterns.map(([n,a])=>e.jsxs(M,{variant:"secondary",className:"text-sm text-foreground bg-secondary/80 border-secondary-foreground/30",children:[n," (",a,")"]},n))})})]})}),e.jsx(w.section,{variants:b,className:"mt-6",children:e.jsxs(k,{className:"glass glass-card",children:[e.jsx(D,{children:e.jsx(F,{children:"Challenge Patterns"})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-950/30 rounded-lg border border-red-200 dark:border-red-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:l.challenges.lowCapacityDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"Low Capacity Days"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 dark:bg-orange-950/30 rounded-lg border border-orange-200 dark:border-orange-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-orange-700 dark:text-orange-400",children:l.challenges.lowPresenceDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"Low Presence Days"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-950/30 rounded-lg border border-green-200 dark:border-green-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-green-700 dark:text-green-400",children:l.challenges.highCapacityDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"High Capacity Days"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-950/30 rounded-lg border border-blue-200 dark:border-blue-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-blue-700 dark:text-blue-400",children:l.challenges.highPresenceDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"High Presence Days"})]})]})})]})}),e.jsx(w.section,{variants:b,className:"mt-6",children:e.jsxs(k,{className:"glass glass-card",children:[e.jsx(D,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"AI Insights"]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-3",children:q.map((n,a)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-foreground/80",children:n})]},a))})})]})})]}):e.jsx(w.section,{variants:b,children:e.jsx(k,{className:"glass glass-card",children:e.jsxs(C,{className:"text-center py-12",children:[e.jsx(_,{className:"w-16 h-16 mx-auto mb-4 text-foreground/30"}),e.jsx("h3",{className:"text-lg font-medium mb-2 text-foreground",children:"No Pattern Data Yet"}),e.jsx("p",{className:"text-foreground/70 text-sm",children:"You haven't completed enough emotional check-ins to analyze patterns. Perform regular check-ins to see insights into your emotional patterns."})]})})})]})})]})};export{ee as default};
