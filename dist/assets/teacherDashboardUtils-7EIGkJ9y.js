import{c as z,al as k,aj as R}from"./index-CNXoHGf6.js";import{S as _}from"./shield-check-CL2YX00g.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],B=z("clipboard-check",U),w=e=>e?.data?.data||{},L=(e={},r={})=>({params:r,...e}),se=(e={},r={})=>k.get("/mtss/mentor-assignments",L(r,e)).then(w),ie=(e={},r={})=>k.get("/mtss/strategies",L(r,e)).then(w),oe=(e={},r={})=>k.get("/mtss/students",L(r,e)).then(w),ce=(e,r={})=>k.get(`/mtss/students/${e}`,r).then(w),de=(e={},r={})=>k.get("/mtss/mentors",L(r,e)).then(w),le=(e,r={})=>k.post("/mtss/mentor-assignments",e,r).then(w),ue=(e,r,t={})=>k.put(`/mtss/mentor-assignments/${e}`,r,t).then(w),v=[{key:"active",label:"Active Interventions",sub:"Kids in a boost bubble",icon:_,accent:"from-[#0ea5e9]/90 via-[#818cf8]/85 to-[#34d399]/80"},{key:"due",label:"Updates Due",sub:"Check-ins waiting today",icon:B,accent:"from-[#fcd34d]/90 via-[#fb923c]/85 to-[#38bdf8]/80"},{key:"success",label:"Success Rate",sub:"Kids hitting targets",icon:R,accent:"from-[#22d3ee]/90 via-[#a855f7]/85 to-[#f472b6]/80"}],x={active:"On Track",paused:"Needs Attention",completed:"Completed",closed:"Closed"},b={active:4,paused:3,completed:2,closed:1},$={"Junior High":["Grade 7","Grade 8","Grade 9"],Elementary:["Grade 1","Grade 2","Grade 3","Grade 4","Grade 5","Grade 6"],Kindergarten:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],Pelangi:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"]},F={"Grade 7":["Grade 7","Grade 7 - Helix"],"Grade 8":["Grade 8","Grade 8 - Cartwheel"],"Grade 9":["Grade 9","Grade 9 - Messier 87"]},j=["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2","Kindergarten"],T=["Kindergarten - Milky Way","Kindergarten - Bear Paw","Kindergarten - Starlight"],W=new Set(["Grade 1","Grade 2","Grade 3","Grade 4"]),O=(e="",r=[])=>{const t=(e||"").toLowerCase();return t==="kindergarten"||t==="pelangi"||r.some(n=>n.toLowerCase().startsWith("kindergarten"))?!0:r.some(n=>W.has(K(n)))},A=(e="")=>{if(!e)return"";const r=e.toString().replace(/\s+/g," ").trim();if(!r)return"";const t=r.match(/^kind(?:ergarten)?(?:\s*-\s*(.*))?$/i);if(t){const n=t[1]?.trim();return n?`Kindergarten - ${n.split(/\s+/).map(d=>d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()).join(" ")}`:"Kindergarten"}return r},D={abu:["Grade 7"],yosa:["Grade 7"],nadia:["Grade 7"],novan:["Grade 7"],rifqi:["Grade 8"],"rizki nurul hayati":["Grade 8"],anggie:["Grade 8"],dhaffa:["Grade 9"],tyas:["Grade 9"],vicki:["Grade 9"],zolla:["Grade 9"],hasan:["Grade 7","Grade 8","Grade 9"],hadi:["Grade 7","Grade 8","Grade 9"],himawan:["Grade 7","Grade 8","Grade 9"],"aria wisnuwardana":["Grade 7","Grade 8","Grade 9"],gundah:["Grade 1"],"krisalyssa esna rehulina tarigan":["Grade 1"],almia:["Grade 1"],romasta:["Grade 1"],"zavier cloudya mashareen":["Grade 1"],novia:["Grade 1"],alin:["Grade 2"],bela:["Grade 2"],maria:["Grade 2"],tria:["Grade 2"],laras:["Grade 2"],dini:["Grade 2"],restia:["Grade 2"],reza:["Grade 2"],berliana:["Grade 3"],raisa:["Grade 3"],cecil:["Grade 3"],putri:["Grade 3"],galen:["Grade 3"],salsabila:["Grade 3"],dien:["Grade 3"],ika:["Grade 3"],eva:["Grade 4"],nathasya:["Grade 4"],rike:["Grade 4"],prisy:["Grade 4"],risma:["Grade 4"],galuh:["Grade 4"],annisa:["Grade 4"],iis:["Grade 4"],tri:["Grade 5"],robby:["Grade 5"],nazmi:["Grade 5"],fadholi:["Grade 5"],devi:["Grade 6"],pipiet:["Grade 6"],afi:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],ayunda:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],diya:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],nanda:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],widya:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],yohana:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],ferlyna:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],vinka:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],kholi:["Grade 1","Grade 2","Grade 3","Grade 4","Grade 5","Grade 6"],latifah:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"]},K=e=>{if(!e)return"";const r=e.toString().trim(),t=r.toLowerCase(),n=r.match(/grade\s*\d+/i);return n?n[0].replace(/grade/i,"Grade").replace(/\s+/g," ").trim():t.includes("kindergarten")||t.includes("kindy")?/(pre[-\s]?k|prekind)/i.test(r)?"Kindergarten Pre-K":/\bk\s*1\b/i.test(r)?"Kindergarten K1":/\bk\s*2\b/i.test(r)?"Kindergarten K2":"Kindergarten":r.split("-")[0].trim()},H=(e={})=>{const r=new Set;(e.classes||[]).forEach(n=>{if(n?.className){const i=A(n.className),d=n.className.toLowerCase(),l=/kindy|kindergarten|pre[-\s]?k|k\s*1|k\s*2/.test(d),s=i.toLowerCase()==="kindergarten"||!i.startsWith("Kindergarten -");l&&s?T.forEach(o=>r.add(o)):i&&r.add(i)}});const t=(e.unit||"").toLowerCase();return!r.size&&(t==="kindergarten"||t==="pelangi")&&T.forEach(n=>r.add(n)),Array.from(r).filter(Boolean)},ge=(e={})=>e.strictClassFilter?Array.from(new Set((e.allowedClasses||[]).map(A).filter(Boolean))):[],J=(e={})=>{const r=[];if(e.username&&r.push(e.username.toLowerCase()),e.name){r.push(e.name.toLowerCase());const t=e.name.split(/[\s,]+/)[0];t&&r.push(t.toLowerCase())}if(e.email){const t=e.email.split("@")[0];t&&r.push(t.toLowerCase())}for(const t of r)if(D[t])return D[t];return[]},V=(e="")=>{if(!e)return[];const r=[],t=e.match(/grade\s*\d+/gi);if(t&&t.forEach(n=>r.push(n.trim().replace(/\s+/g," ").replace(/grade/i,"Grade").trim())),/kindy|kindergarten/i.test(e)){const n=e.match(/kindy\s*[a-z0-9'\-\s]+/i);n?r.push(n[0].trim()):r.push("Kindergarten Pre-K","Kindergarten K1","Kindergarten K2")}return r},fe=(e={})=>{const t=(Array.isArray(e?.classes)?e.classes:[]).map(g=>K(g.grade)).filter(Boolean),n=V(e?.jobPosition).map(K).filter(Boolean),i=$[e?.unit]||[],d=(e?.username||e?.name||"").toLowerCase(),l=D[d]||[],s=l.length?l:J(e);let o="all",c=[];t.length?(o="classes",c=t):n.length?(o="job",c=n):s.length?(o="fallback",c=s):i.length?(o="unit",c=i):c=[];let a=Array.from(new Set(c.map(K).filter(Boolean)));!a.some(g=>/^grade\s*\d+/i.test(g)||g.toLowerCase().startsWith("kindergarten")||g.toLowerCase().startsWith("kindy"))&&i.length&&(a=i.slice());const p=new Set(H(e)),h=(e?.unit||"").toLowerCase();(h==="kindergarten"||h==="pelangi")&&!a.some(g=>g.toLowerCase()==="kindergarten")&&a.push("Kindergarten"),(h==="kindergarten"||h==="pelangi")&&!p.size&&T.forEach(g=>p.add(g));const f=Array.from(p),S=O(e?.unit||"",a),u=S?f:[],m=!!u.length||!!(a.length&&(o==="classes"||o==="job"));return{allowedGrades:a,allowedClasses:u,strictClassFilter:S,source:o,shouldFilterServer:m,unit:e?.unit||"",label:a.length?a.join(", "):e?.unit||"All Grades"}},he=(e={})=>{const r=new Set,t=n=>{if(!n)return;const i=K(n);if(!i)return;if(r.add(i),i.toLowerCase()==="kindergarten"){j.forEach(l=>r.add(l));return}const d=F[i];d?.length&&d.forEach(l=>r.add(l))};return(e.allowedGrades||[]).forEach(t),!r.size&&e.unit==="Junior High"&&["Grade 7","Grade 8","Grade 9"].forEach(t),Array.from(r)},C=(e,r={month:"short",day:"numeric"})=>{if(!e)return"—";try{return new Intl.DateTimeFormat("en-US",r).format(new Date(e))}catch{return"—"}},N=e=>e?e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""):`student-${Math.random().toString(36).slice(2,6)}`,q=(e,r)=>{if(!e)return"Ongoing";const t=new Date(e),n=r?new Date(r):new Date,i=Math.max(1,Math.round((n-t)/(1e3*60*60*24*7)));return`${i} wk${i>1?"s":""}`},Q=e=>{if(!e)return"Tier 2";const r=e.toString().toLowerCase();return r.includes("3")?"Tier 3":r.includes("1")?"Tier 1":"Tier 2"},E={tier1:1,tier2:2,tier3:3},P=e=>{if(!e)return null;const r=e.toString().toLowerCase();return r.includes("3")?"tier3":r.includes("2")?"tier2":r.includes("1")?"tier1":null},Y=e=>e?.focusAreas?.length?e.focusAreas[0]:e?.tier==="tier3"?"Intensive Support":"Literacy & SEL",X=(e,r)=>{const t=[e?.metricLabel,e?.notes,e?.focusAreas?.join(" "),r?.type].filter(Boolean).join(" ").toLowerCase();return/attendance|present|absen/.test(t)?"%":/reading|fluency|literacy|wpm/.test(t)?"wpm":/math|numeracy|accuracy|score/.test(t)?"score":/behavior|sel|conduct|check-in|checkin/.test(t)?"pts":"score"},Z=e=>{if(e?.status!=="active")return!1;const r=e?.checkIns?.slice(-1)[0]?.date;return r?(Date.now()-new Date(r).getTime())/(1e3*60*60*24)>=7:!0},ee=(e={})=>{const r=e.checkIns||[];if(r.length){const d=r.length;return r.map((l,s)=>{const o=Math.round((s+1)/d*100),c=C(l.date);return{label:c,date:c,reading:o,goal:100,value:o}})}const t=e.goals||[];if(t.length){const d=t.length;let l=0;return t.map((s,o)=>{s.completed&&(l+=1);const c=Math.round(l/d*100),a=s.description||`Goal ${o+1}`;return{label:a,date:a,reading:c,goal:100,value:c}})}const n=e.status==="completed"?100:0,i=C(e.startDate);return[{label:i,date:i,reading:n,goal:100,value:n}]},re=(e={})=>(e.checkIns||[]).slice(-6).reverse().map(r=>({date:C(r.date,{month:"short",day:"numeric",year:"numeric"}),score:"—",notes:r.summary||r.nextSteps||"Check-in recorded"})),te=e=>{const r=e?.checkIns?.slice(-1)[0]?.date||e?.startDate;if(!r)return"Awaiting update";const t=new Date(r);return t.setDate(t.getDate()+7),C(t)},me=(e=[])=>{const r=e.filter(o=>o.status==="active").length,t=e.filter(Z).length,n=e.reduce((o,c)=>o+(c.goals?.length||0),0),i=e.reduce((o,c)=>o+(c.goals?.filter(a=>a.completed).length||0),0),d=n||e.length||1,l=e.filter(o=>o.status==="completed").length,s=Math.round((i||l)/d*100);return[{...v[0],value:r},{...v[1],value:t},{...v[2],value:`${Number.isFinite(s)?s:0}%`}]},Ge=(e=[],r="MTSS Mentor")=>{const t=new Map;e.forEach(s=>{const o=Y(s),c=Q(s.tier),a=s.status||"active",G=te(s),p=ee(s),h=re(s),f=s.goals||[],S=f.filter(u=>u.completed).length;(s.studentIds||[]).forEach(u=>{const m=u?._id?.toString?.()||u?.id||u;if(!m)return;const g=K(u?.currentGrade||u?.classes?.[0]?.grade||u?.unit||u?.class||"-"),I=X(s,u),y={id:m,assignmentId:s._id?.toString?.()||null,slug:u?.slug||N(u?.name),name:u?.name||"Student",grade:g,type:o,tier:c,progress:x[a]||"On Track",nextUpdate:G,statusKey:a,profile:{teacher:r,mentor:s.mentorId?.name||r,type:o,strategy:s.focusAreas?.join(", ")||`Support focus - ${c}`,started:C(s.startDate),duration:q(s.startDate,s.endDate),baseline:f.length?0:null,current:f.length?S:s.checkIns?.length||(a==="completed"?1:0),target:f.length||Math.max(s.checkIns?.length||1,1),progressUnit:I,chart:p,history:h}},M=t.get(m);(!M||b[a]>b[M.statusKey])&&t.set(m,y)})});const i=Array.from(t.values()).sort((s,o)=>b[o.statusKey]-b[s.statusKey]),d=i[0]?.profile?.chart||[],l=i[0]?`${i[0].tier} ${i[0].type}`:null;return{students:i.map(({statusKey:s,...o})=>o),spotlightChart:d,focusLabel:l}},pe=(e=[],r=[],t={allowedGrades:[]})=>{const n=new Map(r.map(a=>[a.id?.toString?.()||a.slug||a.name,a])),i=t.allowedGrades||[],d=t.allowedClasses||[],l=t.strictClassFilter,s=a=>!i.length||i.includes(K(a)),o=a=>{if(!l||!d.length)return!0;const G=A(a);return G?d.includes(G):!1},c=e.map(a=>{const G=a.id?.toString?.()||a._id?.toString?.()||a.slug||a.name,p=K(a.grade||a.currentGrade||a.className||"-"),h=A(a.className||a.currentGrade||a.unit);if(!s(p)||!o(h))return null;const f=n.get(G),S=P(a.tier||a.primaryIntervention?.tier||a.profile?.tier),u=P(f?.tier),m=E[S]||0,g=E[u]||0,y=f&&(!m||g>m)?f:a;return{id:G,slug:a.slug||N(a.name),name:a.name,grade:p,className:h||a.className,type:y?.type||a.type||"Universal Supports",tier:y?.tier||a.tier||"Tier 1",progress:y?.progress||a.progress||"Not Assigned",nextUpdate:y?.nextUpdate||a.nextUpdate||"Not scheduled",assignmentId:f?.assignmentId||null,profile:y?.profile||f?.profile||a.profile,interventions:a.interventions,primaryIntervention:a.primaryIntervention}}).filter(Boolean);return!c.length&&r.length?r:c},Ke=()=>{try{return JSON.parse(localStorage.getItem("auth_user")||"null")}catch{return null}};export{B as C,he as a,me as b,ge as c,fe as d,oe as e,se as f,Ke as g,pe as h,A as i,de as j,le as k,ce as l,Ge as m,K as n,ie as o,ue as u};
