const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PrimaryNavButtons-stsyqmLZ.js","assets/index-DcybHeOi.js","assets/index-CJQ2ExeA.css","assets/target-Ch-ME1U-.js","assets/DashboardHeader-Bj3J4O7S.js","assets/utils-NGAVZCJh.js","assets/ContentSections-BxlnBJP6.js","assets/DecorativeElements-D08BKw68.js","assets/PerformanceMonitor-pIOPf4W3.js"])))=>i.map(i=>d[i]);
import{c as V,r as a,j as e,X as U,O as $,C as E,a as q,b as B,d as D,h as W,i as Q,t as X,s as Y,Q as A,T as y,U as G,V as J,_ as w}from"./index-DcybHeOi.js";import{s as u}from"./socketService-B4WowktR.js";import{F as K}from"./funnel-7EYNfR1c.js";import{U as Z}from"./users-_2hYyMjF.js";import{B as ee}from"./building-B9gHd1Sc.js";import{S as se}from"./shield-check-K0Cq4BX6.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],te=V("triangle-alert",ae),T=a.memo(({onFiltersChange:m,currentFilters:o={}})=>{const[n,t]=a.useState(!1),[i,x]=a.useState(o),j=[{value:"student",label:"Students"},{value:"staff",label:"Staff"},{value:"teacher",label:"Teachers"},{value:"admin",label:"Admins"},{value:"directorate",label:"Directorate"}],c=[{value:"Academic",label:"Academic"},{value:"Student Affairs",label:"Student Affairs"},{value:"Finance",label:"Finance"},{value:"HR",label:"Human Resources"},{value:"IT",label:"Information Technology"},{value:"Operations",label:"Operations"}],v=[{value:"happy",label:"Happy"},{value:"excited",label:"Excited"},{value:"calm",label:"Calm"},{value:"hopeful",label:"Hopeful"},{value:"tired",label:"Tired"},{value:"anxious",label:"Anxious"},{value:"sad",label:"Sad"},{value:"overwhelmed",label:"Overwhelmed"}],r=[{value:"sunny",label:"Sunny"},{value:"cloudy",label:"Cloudy"},{value:"rain",label:"Rain"},{value:"storm",label:"Storm"},{value:"tornado",label:"Tornado"},{value:"snow",label:"Snow"}],l=(s,f)=>{const h={...i};h[s]||(h[s]=[]),h[s].includes(f)?h[s]=h[s].filter(C=>C!==f):h[s].push(f),h[s].length===0&&delete h[s],x(h),m(h)},b=()=>{x({}),m({})},p=Object.values(i).reduce((s,f)=>s+f.length,0);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>t(!n),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${p>0?"bg-primary text-primary-foreground border-primary":"bg-card text-foreground border-border hover:bg-card/80"}`,children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Advanced Filters"}),p>0&&e.jsx("span",{className:"bg-destructive text-destructive-foreground text-xs px-2 py-1 rounded-full",children:p})]}),n&&e.jsxs("div",{className:"absolute top-full mt-2 right-0 z-50 w-96 bg-card border border-border rounded-xl shadow-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Filter Dashboard Data"}),e.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-muted rounded",children:e.jsx(U,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Z,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Role"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.role?.includes(s.value)||!1,onChange:()=>l("role",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ee,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Department"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:c.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.department?.includes(s.value)||!1,onChange:()=>l("department",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Moods"})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.mood?.includes(s.value)||!1,onChange:()=>l("mood",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Weather Types"})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.weather?.includes(s.value)||!1,onChange:()=>l("weather",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Support Status"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.needsSupport?.includes("true")||!1,onChange:()=>l("needsSupport","true"),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:"Needs Support"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.needsSupport?.includes("false")||!1,onChange:()=>l("needsSupport","false"),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:"No Support Needed"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-border",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Clear All"}),e.jsx("button",{onClick:()=>t(!1),className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Apply Filters"})]})]})]})});T.displayName="AdvancedFilters";const R=a.memo(({socketService:m,user:o})=>{const[n,t]=a.useState([]),[i,x]=a.useState(!1);a.useEffect(()=>{if(!m||!o)return;const r=p=>{const s={id:Date.now(),type:"info",title:"New Check-in Submitted",message:`${p.userName||"Someone"} just submitted their emotional check-in`,timestamp:new Date,icon:E,color:"text-blue-500",bgColor:"bg-blue-50",borderColor:"border-blue-200"};j(s)},l=p=>{const s={id:Date.now(),type:"warning",title:"Support Needed",message:`${p.userName} has indicated they need support`,timestamp:new Date,icon:te,color:"text-red-500",bgColor:"bg-red-50",borderColor:"border-red-200"};j(s)},b=p=>{const s={id:Date.now(),type:"success",title:"Dashboard Updated",message:"New data has been added to the dashboard",timestamp:new Date,icon:E,color:"text-green-500",bgColor:"bg-green-50",borderColor:"border-green-200"};j(s)};return m.onNewCheckin(r),m.onUserFlagged(l),m.onDashboardUpdate(b),()=>{m.offNewCheckin(r),m.offUserFlagged(l),m.offDashboardUpdate(b)}},[m,o]);const j=r=>{t(l=>[r,...l].slice(0,10)),x(!0),setTimeout(()=>{x(!1)},5e3)},c=r=>{t(l=>l.filter(b=>b.id!==r)),n.length<=1&&x(!1)},v=()=>{t([]),x(!1)};return n.length===0?null:e.jsxs("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs("button",{onClick:()=>x(!i),className:"relative p-2 bg-primary text-primary-foreground rounded-full shadow-lg hover:bg-primary/90 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),n.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs rounded-full w-5 h-5 flex items-center justify-center",children:n.length})]})}),i&&e.jsxs("div",{className:"glass glass-card shadow-2xl max-h-96 overflow-hidden",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Notifications"}),e.jsx("button",{onClick:v,className:"text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Clear all"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:n.map(r=>{const l=r.icon;return e.jsx("div",{className:`p-4 border-b border-border/50 last:border-b-0 ${r.bgColor} transition-all duration-300`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(l,{className:`w-4 h-4 mt-0.5 ${r.color}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:r.title}),e.jsx("button",{onClick:()=>c(r.id),className:"ml-2 p-1 rounded transition-colors hover:bg-secondary/25",children:e.jsx(U,{className:"w-3 h-3 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:r.timestamp.toLocaleTimeString()})]})]})},r.id)})}),e.jsx("div",{className:"p-3 bg-muted/20 border-t border-border",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Real-time updates active"})})]})]})]})});R.displayName="RealTimeNotifications";a.lazy(()=>w(()=>import("./PrimaryNavButtons-stsyqmLZ.js"),__vite__mapDeps([0,1,2,3])));const re=a.lazy(()=>w(()=>import("./DashboardHeader-Bj3J4O7S.js"),__vite__mapDeps([4,1,2,5]))),le=a.lazy(()=>w(()=>import("./ContentSections-BxlnBJP6.js"),__vite__mapDeps([6,1,2]))),oe=a.lazy(()=>w(()=>import("./DecorativeElements-D08BKw68.js"),__vite__mapDeps([7,1,2]))),de=a.lazy(()=>w(()=>import("./PerformanceMonitor-pIOPf4W3.js"),__vite__mapDeps([8,1,2]))),O=a.memo(function(){const o=q(),n=B(),{user:t}=D(d=>d.auth),{stats:i,loading:x,error:j}=D(d=>d.dashboard),{selectedPeriod:c,selectedDate:v}=D(d=>d.dashboard),r=a.useMemo(()=>W(t),[t]),l=a.useMemo(()=>Q(t),[t]),b=a.useMemo(()=>X(t),[t]),p=Y(t),s=r==="head_unit",f=["directorate","admin","superadmin"].includes(r||""),[h,C]=a.useState(!1),[I,P]=a.useState({}),k=a.useRef(!1);a.useEffect(()=>{const d=setTimeout(()=>C(!0),100);return()=>clearTimeout(d)},[]),a.useEffect(()=>{if(t){if(l){if(f&&c==="today"&&!k.current){k.current=!0,o(A("all"));return}console.log("Fetching dashboard stats for period:",c,"User:",t),o(y({period:c})),u.connect(),u.joinDashboard(t.id);const d=g=>{console.log("Real-time dashboard update:",g),o(y({period:c}))},_=g=>{console.log("New check-in received:",g),o(y({period:c,force:!0})),console.log("Dashboard updated with new check-in data")},S=g=>{console.log("User flagged for support:",g)},F=g=>{console.log("Support request handled, removing from flagged users:",g),o(J(g))};return u.onDashboardUpdate(d),u.onNewCheckin(_),u.onUserFlagged(S),u.onSupportRequestHandled(F),()=>{u.offDashboardUpdate(d),u.offNewCheckin(_),u.offUserFlagged(S),u.offSupportRequestHandled(F),u.leaveDashboard()}}console.log("User not authorized for dashboard:",{user:t}),n("/support-hub",{replace:!0})}},[l,o,f,n,c,t]);const z=a.useCallback(d=>{o(A(d))},[o]),L=a.useCallback(d=>{o(G(d))},[o]),M=a.useCallback(d=>{P(d),o(y({period:c,filters:d}))},[o,c]);a.useCallback(()=>{n("/mtss")},[n]),a.useCallback(()=>{n("/support-hub")},[n]);const N=a.memo(()=>e.jsxs("div",{className:"glass glass-card",children:[e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted/30 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-2/3"})]})]}));N.displayName="LoadingFallback";const H=a.useMemo(()=>typeof window<"u"?window.innerWidth<768:!1,[]);return e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsx(a.Suspense,{fallback:null,children:e.jsx(oe,{isMobile:H})}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[p&&b&&e.jsxs("div",{className:"glass glass-card p-4 mb-4 flex items-start gap-3 border border-amber-200/70 bg-amber-50/70 dark:bg-amber-500/10",children:[e.jsx(se,{className:"w-5 h-5 text-amber-600 dark:text-amber-300 mt-0.5"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Delegated dashboard access"}),e.jsxs("p",{children:["You're viewing the Emotional Check-in Dashboard with the same visibility as"," ",e.jsx("span",{className:"font-medium text-foreground",children:b.delegatedFromName||b.delegatedFromEmail||"the assigned directorate lead"}),". All actions remain logged under your account."]})]})]}),e.jsx(a.Suspense,{fallback:e.jsx(N,{}),children:e.jsx(re,{selectedPeriod:c,onPeriodChange:z,selectedDate:v,onDateChange:L,isHeadUnit:s,userUnit:t?.unit||t?.department,isDirectorate:f})}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(T,{onFiltersChange:M,currentFilters:I})}),e.jsx(a.Suspense,{fallback:e.jsx(N,{})}),i?e.jsx(a.Suspense,{fallback:e.jsx(N,{}),children:e.jsx(le,{realData:i,loading:x,selectedPeriod:c,userId:t?.id,isHeadUnit:s,isDirectorate:f})}):e.jsx(N,{})]}),e.jsx(R,{socketService:u,user:t}),e.jsx(a.Suspense,{fallback:null,children:e.jsx(de,{})})]})});O.displayName="EmotionalCheckinDashboard";const xe=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}));export{xe as E,te as T};
