import{r as x,j as e,ak as f,R as j}from"./index-D_pgSSHA.js";import{C as h}from"./cloud-ChnfVRVy.js";import{S as y,C as g}from"./snowflake-9ZJy9Ks6.js";import{T as b}from"./tornado-Gm2jgaLa.js";import{Z as C}from"./zap-C2X8Z9xs.js";import{R as N}from"./CategoricalChart-CdMz9dKp.js";import{A as v,a as u}from"./AreaChart-D4Iz2YSN.js";import{C as w,X as k,T as S}from"./CartesianChart-CtDy-WyR.js";import{Y as W}from"./YAxis-0quHvADW.js";import"./ActivePoints-vPyTTaMq.js";const A=x.memo(({data:l={},period:O="month"})=>{const o=x.useMemo(()=>{if(!l?.recentActivity||l.recentActivity.length===0)return[];const t={};return l.recentActivity.forEach(s=>{const a=new Date(s.submittedAt).toLocaleDateString();t[a]||(t[a]={date:a,weatherCounts:{},moodCorrelations:{},totalCheckins:0,avgPresence:0,avgCapacity:0,presenceSum:0,capacitySum:0});const r=s.weatherType;t[a].weatherCounts[r]=(t[a].weatherCounts[r]||0)+1,t[a].totalCheckins++,s.selectedMoods?.forEach(i=>{t[a].moodCorrelations[r]||(t[a].moodCorrelations[r]={}),t[a].moodCorrelations[r][i]=(t[a].moodCorrelations[r][i]||0)+1}),t[a].presenceSum+=s.presenceLevel,t[a].capacitySum+=s.capacityLevel}),Object.values(t).map(s=>({date:s.date,totalCheckins:s.totalCheckins,avgPresence:Math.round(s.presenceSum/s.totalCheckins*10)/10,avgCapacity:Math.round(s.capacitySum/s.totalCheckins*10)/10,dominantWeather:Object.entries(s.weatherCounts).sort(([,a],[,r])=>r-a)[0]?.[0]||"none",weatherCount:Object.entries(s.weatherCounts).sort(([,a],[,r])=>r-a)[0]?.[1]||0,sunny:s.weatherCounts.sunny||0,cloudy:s.weatherCounts.cloudy||0,rain:s.weatherCounts.rain||0,storm:s.weatherCounts.storm||0,tornado:s.weatherCounts.tornado||0,snow:s.weatherCounts.snow||0,moodCorrelations:s.moodCorrelations})).sort((s,a)=>new Date(s.date)-new Date(a.date))},[l]),c=x.useMemo(()=>{if(o.length===0)return null;const t={sunny:[],cloudy:[],rain:[],storm:[],tornado:[],snow:[]};o.forEach(s=>{t.sunny.push(s.sunny),t.cloudy.push(s.cloudy),t.rain.push(s.rain),t.storm.push(s.storm),t.tornado.push(s.tornado),t.snow.push(s.snow)});const n={};return Object.keys(t).forEach(s=>{const a=t[s].filter(r=>r>0);n[s]=a.length>0?Math.round(a.reduce((r,i)=>r+i,0)/a.length*10)/10:0}),{averages:n,totalDays:o.length,weatherDays:Object.entries(n).filter(([,s])=>s>0).length}},[o]),d={sunny:f,cloudy:h,rain:g,storm:C,tornado:b,snow:y},m={sunny:"#fbbf24",cloudy:"#6b7280",rain:"#3b82f6",storm:"#7c3aed",tornado:"#dc2626",snow:"#06b6d4"},p=({active:t,payload:n,label:s})=>{if(t&&n&&n.length){const a=n[0].payload;return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:s}),e.jsxs("p",{className:"text-sm text-emerald-600",children:["Presence: ",a.avgPresence,"/10"]}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Capacity: ",a.avgCapacity,"/10"]}),e.jsxs("p",{className:"text-sm text-purple-600",children:["Check-ins: ",a.totalCheckins]}),e.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:["Weather: ",a.dominantWeather," (",a.weatherCount,")"]})]})}return null};return o.length===0?e.jsxs("div",{className:"glass glass-card p-6 text-center",children:[e.jsx(h,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No weather pattern data available"})]}):e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(h,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:"Weather Pattern Analysis"})]}),c&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 mb-6",children:Object.entries(c.averages).map(([t,n])=>{if(n===0)return null;const s=d[t];return e.jsxs("div",{className:"text-center p-3 bg-card/40 rounded-lg",children:[e.jsx(s,{className:"w-6 h-6 mx-auto mb-2",style:{color:m[t]}}),e.jsx("p",{className:"text-sm font-medium text-foreground capitalize",children:t}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n," avg/day"]})]},t)})}),e.jsx("div",{className:"h-64 md:h-80 mb-6",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(v,{data:o,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"sunnyGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#fbbf24",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#fbbf24",stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"cloudyGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6b7280",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6b7280",stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"rainGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})]}),e.jsx(w,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(k,{dataKey:"date",className:"text-xs",tick:{fill:"currentColor"},tickFormatter:t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(W,{className:"text-xs",tick:{fill:"currentColor"}}),e.jsx(S,{content:e.jsx(p,{})}),e.jsx(u,{type:"monotone",dataKey:"sunny",stackId:"1",stroke:"#fbbf24",fill:"url(#sunnyGradient)",name:"Sunny"}),e.jsx(u,{type:"monotone",dataKey:"cloudy",stackId:"1",stroke:"#6b7280",fill:"url(#cloudyGradient)",name:"Cloudy"}),e.jsx(u,{type:"monotone",dataKey:"rain",stackId:"1",stroke:"#3b82f6",fill:"url(#rainGradient)",name:"Rain"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Weather Distribution"}),e.jsx("div",{className:"space-y-2",children:o.slice(-7).map((t,n)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/20 rounded",children:[e.jsx("span",{className:"text-sm text-foreground",children:new Date(t.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),e.jsx("div",{className:"flex items-center gap-2",children:t.dominantWeather&&e.jsxs("div",{className:"flex items-center gap-1",children:[j.createElement(d[t.dominantWeather],{className:"w-4 h-4",style:{color:m[t.dominantWeather]}}),e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:t.dominantWeather})]})})]},n))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Weather Impact on Well-being"}),e.jsx("div",{className:"space-y-3",children:Object.entries(c?.averages||{}).map(([t,n])=>{if(n===0)return null;const s=d[t],a=o.filter(r=>r.dominantWeather===t).reduce((r,i)=>r+i.avgPresence,0)/o.filter(r=>r.dominantWeather===t).length;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-card/20 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{className:"w-4 h-4",style:{color:m[t]}}),e.jsx("span",{className:"text-sm font-medium text-foreground capitalize",children:t})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg Presence"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:isNaN(a)?"N/A":`${a.toFixed(1)}/10`})]})]},t)})})]})]})]})]})});A.displayName="WeatherPatternAnalysis";export{A as default};
