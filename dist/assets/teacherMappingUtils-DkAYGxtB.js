import{c as z,ag as P}from"./index-BH3Cl4N6.js";import{n as C,c as A}from"./teacherGradeUtils-COfj_G-K.js";import{S as j}from"./shield-check-43hxzO-I.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],ce=z("calendar-days",B);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],Y=z("clipboard-check",H),L=[{key:"active",label:"Active Interventions",sub:"Kids in a boost bubble",icon:j,accent:"from-[#0ea5e9]/90 via-[#818cf8]/85 to-[#34d399]/80"},{key:"due",label:"Updates Due",sub:"Check-ins waiting today",icon:Y,accent:"from-[#fcd34d]/90 via-[#fb923c]/85 to-[#38bdf8]/80"},{key:"success",label:"Success Rate",sub:"Kids hitting targets",icon:P,accent:"from-[#22d3ee]/90 via-[#a855f7]/85 to-[#f472b6]/80"}],v=(t,o={month:"short",day:"numeric"})=>{if(!t)return"—";try{return new Intl.DateTimeFormat("en-US",o).format(new Date(t))}catch{return"—"}},G=t=>t?t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""):`student-${Math.random().toString(36).slice(2,6)}`,se=()=>{try{return JSON.parse(localStorage.getItem("auth_user")||"null")}catch{return null}},J=t=>{if(t?.status!=="active")return!1;const o=t?.checkIns?.slice(-1)[0]?.date;return o?(Date.now()-new Date(o).getTime())/(1e3*60*60*24)>=7:!0},V=t=>{if(t.status==="completed")return!0;const o=t.goals||[];if(o.length>0&&o.every(l=>l.completed))return!0;const a=t.targetScore?.value;if(a!=null){const u=(t.checkIns||[]).filter(n=>n.value!=null).slice(-1)[0];if(u&&u.value>=a)return!0}return!1},le=(t=[])=>{const o=t.filter(h=>h.status==="active").length,a=t.filter(J).length,l=t.length||1,u=t.filter(V).length,n=Math.round(u/l*100);return[{...L[0],value:o},{...L[1],value:a},{...L[2],value:`${Number.isFinite(n)?n:0}%`}]},_={active:"On Track",paused:"Needs Attention",completed:"Completed",closed:"Closed"},S={active:4,paused:3,completed:2,closed:1},D={tier1:1,tier2:2,tier3:3},Q=t=>{if(!t)return"Tier 2";const o=t.toString().toLowerCase();return o.includes("3")?"Tier 3":o.includes("1")?"Tier 1":"Tier 2"},x=t=>{if(!t)return null;const o=t.toString().toLowerCase();return o.includes("3")?"tier3":o.includes("2")?"tier2":o.includes("1")?"tier1":null},X=t=>t?.focusAreas?.length?t.focusAreas[0]:t?.tier==="tier3"?"Intensive Support":"Literacy & SEL",Z=(t,o)=>{const a=[t?.metricLabel,t?.notes,t?.focusAreas?.join(" "),o?.type].filter(Boolean).join(" ").toLowerCase();return/attendance|present|absen/.test(a)?"%":/reading|fluency|literacy|wpm/.test(a)?"wpm":/math|numeracy|accuracy|score/.test(a)?"score":/behavior|sel|conduct|check-in|checkin/.test(a)?"pts":"score"},$=(t,o)=>{if(!t)return"Ongoing";const a=new Date(t),l=o?new Date(o):new Date,u=Math.max(1,Math.round((l-a)/(1e3*60*60*24*7)));return`${u} wk${u>1?"s":""}`},ee=t=>{const o=t?.checkIns?.slice(-1)[0]?.date||t?.startDate;if(!o)return"Awaiting update";const a=new Date(o);return a.setDate(a.getDate()+7),v(a)},te=(t={})=>{const o=t.checkIns||[];if(o.length){const n=o.length;return o.map((h,f)=>{const e=Math.round((f+1)/n*100),c=v(h.date);return{label:c,date:c,reading:e,goal:100,value:e}})}const a=t.goals||[];if(a.length){const n=a.length;let h=0;return a.map((f,e)=>{f.completed&&(h+=1);const c=Math.round(h/n*100),r=f.description||`Goal ${e+1}`;return{label:r,date:r,reading:c,goal:100,value:c}})}const l=t.status==="completed"?100:0,u=v(t.startDate);return[{label:u,date:u,reading:l,goal:100,value:l}]},re=(t={})=>(t.checkIns||[]).slice(-6).reverse().map(o=>({date:v(o.date,{month:"short",day:"numeric",year:"numeric"}),score:"-",notes:o.summary||o.nextSteps||"Check-in recorded"})),ie=(t=[],o="MTSS Mentor")=>{const a=new Map,l=new Map;t.forEach(e=>{const c=X(e),r=Q(e.tier),d=x(e.tier)||"tier2",s=e.status||"active",p=ee(e),g=te(e),M=re(e),m=Array.isArray(e.goals)?e.goals:[],I=m.filter(i=>i?.completed).length,y=m.find(i=>i),U=e.goal||(typeof e.goals=="string"?e.goals:null)||(typeof y=="string"?y:null)||y?.description||y?.goal||y?.title||y?.name||null,k=e.strategyName||e.strategy?.name||e.strategy?.label||e.strategy?.title||null,T=e.duration||$(e.startDate,e.endDate),K=e.monitoringFrequency||e.monitorFrequency||null,E=e.monitoringMethod||e.monitorMethod||null,w=e._id?.toString?.()||e.id||e.assignmentId||null;(e.studentIds||[]).forEach(i=>{const b=i?._id?.toString?.()||i?.id||i;if(!b)return;if(w){const N=l.get(b)||[];N.some(q=>q.assignmentId===w)||l.set(b,[...N,{assignmentId:w,focus:c,tier:r,tierCode:d,statusKey:s,statusLabel:_[s]||"On Track",metricLabel:e.metricLabel||null,strategyName:k,duration:T,monitoringFrequency:K,monitoringMethod:E,goal:U,baselineScore:e.baselineScore||null,targetScore:e.targetScore||null,notes:e.notes||null}])}const F=C(i?.currentGrade||i?.classes?.[0]?.grade||i?.unit||i?.class||"-"),R=Z(e,i),W={id:b,assignmentId:w,slug:i?.slug||G(i?.name),name:i?.name||"Student",grade:F,type:c,tier:r,progress:_[s]||"On Track",nextUpdate:p,statusKey:s,profile:{teacher:o,mentor:e.mentorId?.name||o,type:c,strategy:e.focusAreas?.join(", ")||`Support focus - ${r}`,started:v(e.startDate),duration:$(e.startDate,e.endDate),baseline:m.length?0:null,current:m.length?I:e.checkIns?.length||(s==="completed"?1:0),target:m.length||Math.max(e.checkIns?.length||1,1),progressUnit:R,chart:g,history:M}},O=a.get(b);(!O||S[s]>S[O.statusKey])&&a.set(b,W)})});const n=Array.from(a.values()).map(e=>{const r=[...l.get(e.id)||[]].sort((d,s)=>{const p=(D[s.tierCode]||0)-(D[d.tierCode]||0);return p!==0?p:(S[s.statusKey]||0)-(S[d.statusKey]||0)});return{...e,assignmentOptions:r}}).sort((e,c)=>S[c.statusKey]-S[e.statusKey]),h=n[0]?.profile?.chart||[],f=n[0]?`${n[0].tier} ${n[0].type}`:null;return{students:n.map(({statusKey:e,...c})=>c),spotlightChart:h,focusLabel:f}},ue=(t=[],o=[],a={allowedGrades:[]})=>{const l=new Map(o.map(r=>[r.id?.toString?.()||r.slug||r.name,r])),u=a.allowedGrades||[],n=a.allowedClasses||[],h=a.strictClassFilter,f=r=>{if(!u.length)return!0;const d=C(r);return u.some(s=>{const p=C(s);return d===p||d.startsWith(p)})},e=r=>{if(!h||!n.length)return!0;if(!r)return!1;const d=A(r);return n.some(s=>{const p=A(s);return d===p||d.endsWith(p)||d.endsWith(`- ${p}`)})},c=t.map(r=>{const d=r.id?.toString?.()||r._id?.toString?.()||r.slug||r.name,s=C(r.grade||r.currentGrade||r.className||"-"),p=A(r.className||r.currentGrade||r.unit);if(!f(s)||!e(p))return null;const g=l.get(d),M=x(r.tier||r.primaryIntervention?.tier||r.profile?.tier),m=x(g?.tier),I=D[M]||0,y=D[m]||0,k=g&&(!I||y>I)?g:r,T=g?.assignmentOptions||[];return{id:d,slug:r.slug||G(r.name),name:r.name,grade:s,className:p||r.className,type:k?.type||r.type||"Universal Supports",tier:k?.tier||r.tier||"Tier 1",progress:k?.progress||r.progress||"Not Assigned",nextUpdate:k?.nextUpdate||r.nextUpdate||"Not scheduled",assignmentId:g?.assignmentId||null,assignmentOptions:T,profile:k?.profile||g?.profile||r.profile,interventions:r.interventions,primaryIntervention:r.primaryIntervention}}).filter(Boolean);return!c.length&&o.length?o:c};export{ce as C,ue as a,le as b,Y as c,v as f,se as g,ie as m,x as n};
