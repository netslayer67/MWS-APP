import{S as I}from"./shield-check-CoGuFscD.js";import{c as A,ac as C}from"./index-C2UXQ8jH.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],M=A("clipboard-check",L),g=[{key:"active",label:"Active Interventions",sub:"Kids in a boost bubble",icon:I,accent:"from-[#0ea5e9]/90 via-[#818cf8]/85 to-[#34d399]/80"},{key:"due",label:"Updates Due",sub:"Check-ins waiting today",icon:M,accent:"from-[#fcd34d]/90 via-[#fb923c]/85 to-[#38bdf8]/80"},{key:"success",label:"Success Rate",sub:"Kids hitting targets",icon:C,accent:"from-[#22d3ee]/90 via-[#a855f7]/85 to-[#f472b6]/80"}],U={active:"On Track",paused:"Needs Attention",completed:"Completed",closed:"Closed"},y={active:4,paused:3,completed:2,closed:1},h=(e,t={month:"short",day:"numeric"})=>{if(!e)return"—";try{return new Intl.DateTimeFormat("en-US",t).format(new Date(e))}catch{return"—"}},$=e=>e?e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""):`student-${Math.random().toString(36).slice(2,6)}`,x=(e,t)=>{if(!e)return"Ongoing";const c=new Date(e),i=t?new Date(t):new Date,a=Math.max(1,Math.round((i-c)/(1e3*60*60*24*7)));return`${a} wk${a>1?"s":""}`},K=e=>{if(!e)return"Tier 2";const t=e.toString().toLowerCase();return t.includes("3")?"Tier 3":t.includes("1")?"Tier 1":"Tier 2"},_=e=>e?.focusAreas?.length?e.focusAreas[0]:e?.tier==="tier3"?"Intensive Support":"Literacy & SEL",E=(e,t)=>{const c=[e?.metricLabel,e?.notes,e?.focusAreas?.join(" "),t?.type].filter(Boolean).join(" ").toLowerCase();return/attendance|present|absen/.test(c)?"%":/reading|fluency|literacy|wpm/.test(c)?"wpm":/math|numeracy|accuracy|score/.test(c)?"score":/behavior|sel|conduct|check-in|checkin/.test(c)?"pts":"score"},O=e=>{if(e?.status!=="active")return!1;const t=e?.checkIns?.slice(-1)[0]?.date;return t?(Date.now()-new Date(t).getTime())/(1e3*60*60*24)>=7:!0},G=(e={})=>{const t=e.checkIns||[];if(t.length){const d=t.length;return t.map((u,r)=>{const o=Math.round((r+1)/d*100),s=h(u.date);return{label:s,date:s,reading:o,goal:100,value:o}})}const c=e.goals||[];if(c.length){const d=c.length;let u=0;return c.map((r,o)=>{r.completed&&(u+=1);const s=Math.round(u/d*100),l=r.description||`Goal ${o+1}`;return{label:l,date:l,reading:s,goal:100,value:s}})}const i=e.status==="completed"?100:0,a=h(e.startDate);return[{label:a,date:a,reading:i,goal:100,value:i}]},N=(e={})=>(e.checkIns||[]).slice(-6).reverse().map(t=>({date:h(t.date,{month:"short",day:"numeric",year:"numeric"}),score:"—",notes:t.summary||t.nextSteps||"Check-in recorded"})),R=e=>{const t=e?.checkIns?.slice(-1)[0]?.date||e?.startDate;if(!t)return"Awaiting update";const c=new Date(t);return c.setDate(c.getDate()+7),h(c)},F=(e=[])=>{const t=e.filter(o=>o.status==="active").length,c=e.filter(O).length,i=e.reduce((o,s)=>o+(s.goals?.length||0),0),a=e.reduce((o,s)=>o+(s.goals?.filter(l=>l.completed).length||0),0),d=i||e.length||1,u=e.filter(o=>o.status==="completed").length,r=Math.round((a||u)/d*100);return[{...g[0],value:t},{...g[1],value:c},{...g[2],value:`${Number.isFinite(r)?r:0}%`}]},P=(e=[],t="MTSS Mentor")=>{const c=new Map;e.forEach(r=>{const o=_(r),s=K(r.tier),l=r.status||"active",b=R(r),S=G(r),k=N(r),f=r.goals||[],D=f.filter(n=>n.completed).length;(r.studentIds||[]).forEach(n=>{const p=n?._id?.toString?.()||n?.id||n;if(!p)return;const v=n?.classes?.[0]?.grade||n?.unit||n?.class||"-",T=E(r,n),w={id:p,slug:n?.slug||$(n?.name),name:n?.name||"Student",grade:v,type:o,tier:s,progress:U[l]||"On Track",nextUpdate:b,statusKey:l,profile:{teacher:t,mentor:r.mentorId?.name||t,type:o,strategy:r.focusAreas?.join(", ")||`Support focus - ${s}`,started:h(r.startDate),duration:x(r.startDate,r.endDate),baseline:f.length?0:null,current:f.length?D:r.checkIns?.length||(l==="completed"?1:0),target:f.length||Math.max(r.checkIns?.length||1,1),progressUnit:T,chart:S,history:k}},m=c.get(p);(!m||y[l]>y[m.statusKey])&&c.set(p,w)})});const a=Array.from(c.values()).sort((r,o)=>y[o.statusKey]-y[r.statusKey]),d=a[0]?.profile?.chart||[],u=a[0]?`${a[0].tier} ${a[0].type}`:null;return{students:a.map(({statusKey:r,...o})=>o),spotlightChart:d,focusLabel:u}},H=()=>{try{return JSON.parse(localStorage.getItem("auth_user")||"null")}catch{return null}};export{M as C,F as b,H as g,P as m};
