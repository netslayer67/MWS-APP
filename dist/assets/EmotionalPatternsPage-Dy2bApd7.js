import{a as S,u as B,b as I,r as j,O as K,j as e,o as R,m as p,V as O,S as W,T as U,H as q}from"./index-BeQwOtyQ.js";import{C as b,a as A,b as P,c as v}from"./card-D-goIzvr.js";import{B as L}from"./badge-CKD0dT5b.js";import{s as N}from"./socketService-CrK7Ga1g.js";const J=()=>{const M=S(),C=B(),{user:g}=I(n=>n.auth),{checkinHistory:$}=I(n=>n.checkin),o=j.useMemo(()=>$?$.filter(n=>n.userId===g?.id):[],[$,g?.id]),d=j.useMemo(()=>{if(o.length===0)return null;const n=o.reduce((a,s)=>(a[s.weatherType]=(a[s.weatherType]||0)+1,a),{}),r=Object.entries(n).sort(([,a],[,s])=>s-a).slice(0,5),l={};o.forEach(a=>{a.selectedMoods?.forEach(s=>{l[s]=(l[s]||0)+1})});const f=Object.entries(l).sort(([,a],[,s])=>s-a).slice(0,10),h=o.filter(a=>a.capacityLevel<5).length,i=o.filter(a=>a.presenceLevel<5).length,D=o.filter(a=>a.capacityLevel>=8).length,w=o.filter(a=>a.presenceLevel>=8).length,u=o.slice(0,28),t=u.length>0?{presence:u.reduce((a,s)=>a+s.presenceLevel,0)/u.length,capacity:u.reduce((a,s)=>a+s.capacityLevel,0)/u.length}:null;return{weatherPatterns:r,moodPatterns:f,challenges:{lowCapacityDays:h,lowPresenceDays:i,highCapacityDays:D,highPresenceDays:w},weeklyAvg:t,totalCheckins:o.length}},[o]),E=j.useMemo(()=>{if(!d)return null;const{challenges:n,weeklyAvg:r,totalCheckins:l,weatherPatterns:f,moodPatterns:h}=d;let i=[];if(l>0){const D=g?.name||"Anda";if(i.push(`🎯 ${D} telah menyelesaikan ${l} check-in emosi dengan konsistensi yang mengagumkan. Ini menunjukkan komitmen yang kuat terhadap kesehatan mental dan kesadaran diri.`),r){const t=r.presence,a=r.capacity;let s="";t>=8?s=`Kehadiran mental Anda luar biasa (${t.toFixed(1)}/10) - ini menunjukkan fokus dan engagement yang sangat tinggi dengan pekerjaan dan lingkungan sekitar.`:t>=6?s=`Kehadiran Anda stabil (${t.toFixed(1)}/10) dengan ruang untuk peningkatan. Pertimbangkan teknik mindfulness untuk meningkatkan fokus harian.`:t>=4?s=`Kehadiran Anda sedang (${t.toFixed(1)}/10). Ini mungkin terkait dengan beban kerja atau faktor eksternal.`:s=`Kehadiran Anda perlu perhatian khusus (${t.toFixed(1)}/10). Pertimbangkan untuk mengidentifikasi dan mengatasi faktor-faktor yang mempengaruhinya.`,i.push(`🧠 ${s}`);let c="";a>=8?c=`Kapasitas energi Anda sangat tinggi (${a.toFixed(1)}/10) - ini menunjukkan resiliensi mental yang luar biasa dan kemampuan untuk menangani tantangan dengan baik.`:a>=6?c=`Kapasitas Anda baik (${a.toFixed(1)}/10) dengan fondasi yang solid untuk produktivitas.`:a>=4?c=`Kapasitas Anda sedang (${a.toFixed(1)}/10). Pertimbangkan strategi manajemen energi seperti istirahat teratur dan nutrisi yang baik.`:c=`Kapasitas energi Anda perlu perhatian (${a.toFixed(1)}/10). Ini mungkin menunjukkan kelelahan atau kebutuhan akan dukungan tambahan.`,i.push(`⚡ ${c}`)}if(f&&f.length>0){const t=f[0][0],a=f[0][1]/l*100,s={sunny:`Cuaca emosi Anda didominasi oleh hari cerah (${a.toFixed(1)}%), menunjukkan optimisme dan energi positif yang konsisten.`,"light-rain":`Anda sering mengalami hari hujan ringan (${a.toFixed(1)}%), yang menunjukkan kemampuan untuk menangani tantangan kecil dengan tenang.`,rainy:`Cuaca hujan cukup sering muncul (${a.toFixed(1)}%), menunjukkan periode refleksi dan pemrosesan emosi yang mendalam.`,thunderstorms:`Badai emosi muncul (${a.toFixed(1)}%), menunjukkan intensitas emosi yang tinggi dan kemampuan untuk menavigasi turbulensi.`,windy:`Angin kencang sering terjadi (${a.toFixed(1)}%), menunjukkan periode ketidakstabilan yang memerlukan grounding.`,snowy:`Salju menutupi lanskap emosi Anda (${a.toFixed(1)}%), menunjukkan kebutuhan akan kehangatan dan dukungan.`,foggy:`Kabut emosi cukup tebal (${a.toFixed(1)}%), menunjukkan periode ketidakjelasan yang memerlukan klarifikasi.`,cloudy:`Awan mendominasi (${a.toFixed(1)}%), menunjukkan suasana hati yang stabil namun redup.`};i.push(`🌤️ ${s[t]||`Pola cuaca emosi Anda unik dengan dominasi ${t} (${a.toFixed(1)}%).`}`)}if(h&&h.length>0){const a=h.slice(0,3).map(([m,y])=>{const T=(y/l*100).toFixed(1);return`${m} (${T}%)`}).join(", ");i.push(`😊 Pola mood Anda menunjukkan kecenderungan kuat ke arah: ${a}. Ini mencerminkan kepribadian dan respons emosi Anda yang unik.`);const s=["happy","excited","hopeful","calm","grateful"],c=["anxious","tired","lonely","sad","angry"],k=h.filter(([m])=>s.includes(m)).reduce((m,[,y])=>m+y,0),F=h.filter(([m])=>c.includes(m)).reduce((m,[,y])=>m+y,0);k>F*1.5?i.push(`✨ Analisis mendalam menunjukkan Anda memiliki kecenderungan positif yang kuat, dengan rasio emosi positif vs tantangan sebesar ${(k/F).toFixed(1)}:1. Ini adalah kekuatan besar!`):F>k*1.5?i.push("🔍 Pola emosi Anda menunjukkan periode tantangan yang signifikan. Ini adalah kesempatan untuk pengembangan resiliensi dan pertumbuhan pribadi."):i.push("⚖️ Keseimbangan emosi Anda cukup baik, dengan variasi yang sehat antara pengalaman positif dan tantangan. Ini menunjukkan kecerdasan emosi yang matang.")}const w=n.lowCapacityDays+n.lowPresenceDays,u=n.highCapacityDays+n.highPresenceDays;if(w>u?i.push(`📊 Analisis tantangan menunjukkan Anda mengalami lebih banyak hari dengan performa rendah (${w} vs ${u} hari tinggi). Ini mungkin terkait dengan pola tidur, nutrisi, atau beban kerja. Rekomendasi: Tinjau rutinitas harian dan pertimbangkan konsultasi dengan profesional kesehatan mental.`):u>l*.6&&i.push(`🏆 Performa emosi Anda luar biasa! ${u} hari dengan kapasitas/kehadiran tinggi dari ${l} total check-in menunjukkan resiliensi mental yang exceptional. Lanjutkan praktik yang mendukung kesejahteraan ini.`),l>=7){const t=o.slice(0,7),a=t.reduce((c,k)=>c+k.presenceLevel,0)/t.length,s=t.reduce((c,k)=>c+k.capacityLevel,0)/t.length;a<r?.presence-1?i.push("🔮 Prediksi: Kehadiran Anda menurun dalam seminggu terakhir. Ini mungkin sinyal untuk intervensi dini - pertimbangkan istirahat tambahan atau teknik relaksasi."):s>r?.capacity+1&&i.push("📈 Tren positif terdeteksi! Kapasitas Anda meningkat. Analisis menunjukkan praktik yang Anda lakukan efektif - lanjutkan!")}i.push(`💡 Rekomendasi Personal: Berdasarkan pola unik Anda, fokuslah pada ${n.lowCapacityDays>n.lowPresenceDays?"pengelolaan energi":"peningkatan fokus"} untuk optimalkan performa emosi Anda.`),l>=14&&i.push(`🌱 Wawasan Pertumbuhan: Dengan ${l} check-in, Anda telah membangun foundation yang solid untuk kesehatan mental. Lanjutkan konsistensi ini untuk melihat pola jangka panjang yang lebih bermakna.`)}return i},[d,g?.name]);j.useEffect(()=>{if(g){C(K({page:1,limit:50})),N.connect(),N.joinPersonal(g.id);const n=r=>{console.log("Real-time personal check-in update:",r),C(K({page:1,limit:50}))};return N.onPersonalNewCheckin(n),()=>{N.offPersonalNewCheckin(n),N.leavePersonal()}}},[C,g]);const H=j.useMemo(()=>({hidden:{opacity:0,y:8},show:{opacity:1,y:0,transition:{staggerChildren:.1}}}),[]),x=j.useMemo(()=>({hidden:{opacity:0,y:6},show:{opacity:1,y:0,transition:{duration:.32}}}),[]);return e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx("title",{children:"Pola Emosi — Kerjain"})}),e.jsx(p.main,{initial:"hidden",animate:"show",variants:H,className:"relative min-h-dvh w-full px-4 pb-12 pt-6",children:e.jsxs("div",{className:"mx-auto max-w-md",children:[e.jsxs(p.header,{variants:x,className:"mb-6 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>M(-1),"aria-label":"Kembali",className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-border bg-card/40 backdrop-blur-md hover:bg-accent/8 transition-colors duration-300",children:e.jsx(O,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"Emotional Patterns"}),e.jsx("p",{className:"mt-0.5 text-xs text-muted-foreground",children:"Insights & patterns of your emotional behavior"})]})]}),d?e.jsxs(e.Fragment,{children:[e.jsx(p.section,{variants:x,children:e.jsxs(b,{className:"glass glass-card",children:[e.jsx(A,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5"}),"Emotional Weather Patterns"]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:d.weatherPatterns.map(([n,r])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"outline",className:"text-foreground border-foreground/30",children:n}),e.jsxs("span",{className:"text-sm text-foreground/80",children:[(r/d.totalCheckins*100).toFixed(1),"% of total"]})]}),e.jsxs("span",{className:"text-sm font-medium text-foreground",children:[r," kali"]})]},n))})})]})}),e.jsx(p.section,{variants:x,className:"mt-6",children:e.jsxs(b,{className:"glass glass-card",children:[e.jsx(A,{children:e.jsx(P,{children:"Mood Patterns"})}),e.jsx(v,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:d.moodPatterns.map(([n,r])=>e.jsxs(L,{variant:"secondary",className:"text-sm text-foreground bg-secondary/80 border-secondary-foreground/30",children:[n," (",r,")"]},n))})})]})}),e.jsx(p.section,{variants:x,className:"mt-6",children:e.jsxs(b,{className:"glass glass-card",children:[e.jsx(A,{children:e.jsx(P,{children:"Challenge Patterns"})}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-950/30 rounded-lg border border-red-200 dark:border-red-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-red-700 dark:text-red-400",children:d.challenges.lowCapacityDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"Low Capacity Days"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 dark:bg-orange-950/30 rounded-lg border border-orange-200 dark:border-orange-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-orange-700 dark:text-orange-400",children:d.challenges.lowPresenceDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"Low Presence Days"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-950/30 rounded-lg border border-green-200 dark:border-green-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-green-700 dark:text-green-400",children:d.challenges.highCapacityDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"High Capacity Days"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-950/30 rounded-lg border border-blue-200 dark:border-blue-800/30",children:[e.jsx("div",{className:"text-xl font-bold text-blue-700 dark:text-blue-400",children:d.challenges.highPresenceDays}),e.jsx("div",{className:"text-xs text-foreground/70",children:"High Presence Days"})]})]})})]})}),e.jsx(p.section,{variants:x,className:"mt-6",children:e.jsxs(b,{className:"glass glass-card",children:[e.jsx(A,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"AI Insights"]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:E.map((n,r)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-foreground/80",children:n})]},r))})})]})})]}):e.jsx(p.section,{variants:x,children:e.jsx(b,{className:"glass glass-card",children:e.jsxs(v,{className:"text-center py-12",children:[e.jsx(q,{className:"w-16 h-16 mx-auto mb-4 text-foreground/30"}),e.jsx("h3",{className:"text-lg font-medium mb-2 text-foreground",children:"Belum Ada Data Pola"}),e.jsx("p",{className:"text-foreground/70 text-sm",children:"You haven't completed enough emotional check-ins to analyze patterns. Perform regular check-ins to see insights into your emotional patterns."})]})})})]})})]})};export{J as default};
