import{r as d,j as e,H as N}from"./index-D2DJgSv6.js";import{m,T as u}from"./EmotionalCheckinDashboard-CIB7XIPw.js";import{F as v}from"./frown-DkZH8hkc.js";import{M as p}from"./meh-BWcScIq3.js";import{S as b}from"./smile-Dn57rsrl.js";import{B as w}from"./brain-BAoeNQ-8.js";import{U as k}from"./users-CuOlxX5p.js";import"./socketService-DK54WtJ1.js";import"./funnel-CzkH_DGg.js";import"./building-DppUBaEx.js";import"./shield-check-DEX54aJQ.js";const x=d.memo(({mood:n,size:r="w-5 h-5"})=>{const l=m[n]||m.okay,c={happy:b,excited:N,okay:p,sad:v}[n]||p;return e.jsx(c,{className:`${r} text-${l.color}`})});x.displayName="MoodIcon";const h=d.memo(({users:n=[],title:r="Users Needing Support",icon:l=u,userType:c="users",showMood:g=!0,showMetrics:f=!0})=>{const o=n?.map(t=>{let i="";const j=t.presenceLevel||0,y=t.capacityLevel||0,a=t.aiAnalysis||{},s=[];return j<4&&s.push("Low presence level"),y<4&&s.push("Low capacity level"),a.needsSupport&&s.push("AI detected support need"),a.emotionalInstability&&s.push("Emotional instability detected"),a.trendDecline&&s.push("Declining emotional trend"),a.historicalPatterns&&(a.historicalPatterns.consistentLowPresence&&s.push("Consistently low presence in recent check-ins"),a.historicalPatterns.increasingSupportNeeds&&s.push("Increasing support requests over time"),a.historicalPatterns.moodVolatility&&s.push("High mood volatility detected")),i=s.length>0?s.join(", "):"AI analysis indicates potential support need",{id:t.id||t._id,name:t.name,mood:t.mood||"sad",lastCheckin:t.lastCheckin||new Date(t.submittedAt).toLocaleDateString(),notes:t.notes||(f?`Presence: ${t.presenceLevel}/10, Capacity: ${t.capacityLevel}/10`:""),role:t.role,department:t.department,email:t.email,aiReason:i,aiAnalysis:a,weatherType:t.weatherType,selectedMoods:t.selectedMoods||[]}})||[];return o.length?e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__refract--soft"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:r})]}),e.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 rounded-full bg-primary/15 border border-primary/30 flex items-center justify-center",children:e.jsx("span",{className:"text-xs md:text-sm font-bold text-primary",children:o.length})})]}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground mb-4",children:"Teacher/Staff/Student that might need you to check-in with them"}),e.jsx("div",{className:"space-y-2 md:space-y-3",children:o.map((t,i)=>e.jsx("div",{className:"p-3 md:p-4 rounded-lg bg-card/40 border border-border/40 backdrop-blur-sm transition-all duration-300 hover:border-primary/40 hover:bg-card/60 cursor-pointer",style:{transitionDelay:`${i*50}ms`},children:e.jsxs("div",{className:"flex items-start gap-3",children:[g&&e.jsx(x,{mood:t.mood,size:"w-4 h-4 md:w-5 md:h-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[e.jsx("button",{onClick:()=>navigate(`/emotional-wellness/${t.userId}`),className:"font-semibold text-foreground text-sm md:text-base truncate hover:text-primary hover:underline transition-colors text-left",children:t.name}),e.jsx("span",{className:"text-xs text-muted-foreground flex-shrink-0 px-2 py-1 rounded-full bg-muted/50",children:t.lastCheckin})]}),t.role&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:t.role}),t.department&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"•"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.department})]})]}),t.notes&&e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground leading-relaxed line-clamp-2",children:t.notes}),e.jsxs("div",{className:"mt-2 space-y-1",children:[t.aiReason&&e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsx(w,{className:"w-3 h-3 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-blue-700 leading-tight",children:t.aiReason})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["P:",t.presenceLevel,"/10"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["C:",t.capacityLevel,"/10"]}),t.weatherType&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"text-purple-600",children:t.weatherType})]}),t.selectedMoods?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"text-emerald-600",children:[t.selectedMoods.slice(0,2).join(", "),t.selectedMoods.length>2?"...":""]})]})]})]}),t.supportContact&&e.jsxs("div",{className:"mt-2 p-2 bg-primary/5 border border-primary/20 rounded text-xs",children:[e.jsx("span",{className:"font-medium text-primary",children:"Requested contact: "}),e.jsx("span",{className:"text-foreground",children:t.supportContact.name}),e.jsxs("span",{className:"text-muted-foreground",children:[" (",t.supportContact.role,")"]})]})]})]})},t.id||t.name))})]})]}):null});h.displayName="FlaggedUsers";const C=d.memo(n=>e.jsx(h,{...n,title:"Students Needing Support",userType:"students",icon:k}));C.displayName="FlaggedStudents";export{C as FlaggedStudents,h as default};
