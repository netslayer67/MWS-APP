import{r as l,b as k,a as w,j as e,$ as C,b0 as u,Y as P}from"./index-B1azmWwg.js";import{M as S}from"./message-circle-DT3UQb67.js";const g={requested:"bg-amber-100 text-amber-900 dark:bg-amber-900/20 dark:text-amber-200 border border-amber-200/70",acknowledged:"bg-sky-100 text-sky-900 dark:bg-sky-900/20 dark:text-sky-200 border border-sky-200/70",handled:"bg-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:text-emerald-200 border border-emerald-200/70"},i=10,E=l.memo(({requests:r=[],isHeadUnit:f})=>{const y=k(),j=w(),[c,p]=l.useState(new Set),[t,m]=l.useState(1);l.useEffect(()=>{m(1)},[r]);const d=Math.max(1,Math.ceil(r.length/i));l.useEffect(()=>{t>d&&m(d)},[t,d]);const N=l.useMemo(()=>{const s=(t-1)*i;return r.slice(s,s+i)},[r,t]),h=l.useCallback(s=>{m(Math.min(Math.max(1,s),d))},[d]),v=r.length>i,b=async(s,n)=>{if(!c.has(s)){p(a=>new Set(a).add(s));try{await new Promise(a=>setTimeout(a,1e3)),u({title:"Action Confirmed",description:`Check-in request has been ${n==="handled"?"handled":"acknowledged"}.`}),n==="handled"&&j(P(s))}catch(a){console.error("Error confirming action:",a),u({title:"Error",description:"Failed to confirm action. Please try again.",variant:"destructive"})}finally{p(a=>{const o=new Set(a);return o.delete(s),o})}}};return!r||r.length===0?null:e.jsxs("div",{className:"glass glass-card transition-colors duration-200 border border-border/60","data-aos":"fade-up","data-aos-delay":"50",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6 space-y-5",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary",children:e.jsx(S,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-[0.35em] text-muted-foreground",children:"Check-in Requests"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:"Mentor follow-ups"})]})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:e.jsxs("span",{className:"px-2 py-1 rounded-full bg-primary/10 text-primary border border-primary/20",children:[r.length," ",r.length===1?"request":"requests"]})})]}),e.jsx("p",{className:"text-xs md:text-sm text-muted-foreground",children:f?"Unit members who selected you as their support contact.":"Teacher/Staff/Student automatically created when someone requested to be checked-in with you."}),e.jsx("div",{className:"space-y-3",children:N.map((s,n)=>{const a=s.status==="handled"||s.status==="acknowledged"?s.status:"requested",o=g[a]||g.requested;return e.jsx("div",{className:"rounded-2xl border border-border/70 bg-white/70 dark:bg-slate-900/40 shadow-sm text-sm transition-colors duration-200","data-aos":"fade-up","data-aos-delay":90+n*30,children:e.jsxs("div",{className:"flex flex-col gap-3 p-3.5 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-primary/15 to-primary/5 border border-primary/20 flex items-center justify-center text-primary",children:e.jsx(C,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-foreground",children:s.contact}),e.jsxs("button",{onClick:()=>y(`/emotional-wellness/${s.userId}`),className:"text-xs text-muted-foreground text-left hover:text-primary/80",children:["by ",s.requestedBy]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-start sm:justify-end",children:[e.jsx("span",{className:`text-[11px] font-semibold px-2.5 py-1 rounded-full ${o}`,children:a}),s.status!=="handled"&&e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("button",{onClick:x=>{x.stopPropagation(),b(s.id,"acknowledged")},disabled:c.has(s.id),className:"px-2.5 py-1 text-[11px] rounded-full border border-sky-200 text-sky-700 bg-sky-50 dark:bg-sky-900/10 hover:bg-sky-100 transition disabled:opacity-50",children:"Acknowledge"}),e.jsx("button",{onClick:x=>{x.stopPropagation(),b(s.id,"handled")},disabled:c.has(s.id),className:"px-2.5 py-1 text-[11px] rounded-full border border-emerald-200 text-emerald-700 bg-emerald-50 dark:bg-emerald-900/10 hover:bg-emerald-100 transition disabled:opacity-50",children:"Handled"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"rounded-lg bg-muted/10 px-3 py-1.5",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Weather:"})," ",s.weatherType||"-"]}),e.jsxs("div",{className:"rounded-lg bg-muted/10 px-3 py-1.5",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Presence:"})," ",s.presenceLevel,"/10"]}),e.jsxs("div",{className:"rounded-lg bg-muted/10 px-3 py-1.5",children:[e.jsx("span",{className:"font-medium text-foreground",children:"Capacity:"})," ",s.capacityLevel,"/10"]})]})]})},n)})}),v&&e.jsxs("div",{className:"pt-1 flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("button",{type:"button",onClick:()=>h(t-1),disabled:t===1,className:"px-3 py-1.5 rounded-full border border-border hover:border-primary hover:text-primary disabled:opacity-50 transition",children:"Previous"}),e.jsxs("span",{children:["Page ",t," of ",d]}),e.jsx("button",{type:"button",onClick:()=>h(t+1),disabled:t===d,className:"px-3 py-1.5 rounded-full border border-border hover:border-primary hover:text-primary disabled:opacity-50 transition",children:"Next"})]})]})]})});E.displayName="CheckInRequests";export{E as default};
