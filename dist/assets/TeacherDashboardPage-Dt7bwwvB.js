const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardOverview-BW60yn5e.js","assets/index-D0Udg6QN.js","assets/index-CrbAaxen.css","assets/StudentsTable-DHWCmvzz.js","assets/interventionSelection-Vcld4Os_.js","assets/CategoricalChart-CGY1vKx8.js","assets/LineChart-B6_BE2Dg.js","assets/CartesianChart-DNaoDGei.js","assets/Line-CsmnhlxL.js","assets/ActivePoints-8ufa72jf.js","assets/ErrorBarContext-BIuvSwxh.js","assets/chevron-left-CHxteb3g.js","assets/StudentsPanel-q0vqqcJy.js","assets/funnel-UBdx4NpF.js","assets/search-C9bHGcJC.js","assets/users-round-BuAC1fAe.js","assets/teacherGradeUtils-COfj_G-K.js","assets/teacherSegmentUtils-BaJgF7HQ.js","assets/teacherMappingUtils-BLndk_0a.js","assets/shield-check-CKOShQgl.js","assets/arrow-right-CFeM6htQ.js","assets/StatusPills-B9jj_F6J.js","assets/InterventionFormPanel-DSSjECr9.js","assets/ProgressFormPanel-BLMn-igH.js"])))=>i.map(i=>d[i]);
import{c as W,e as J,I as te,r as s,d as ae,ai as se,aj as q,ak as re,al as ne,j as e,E as oe,m as Q,X as ie,_ as E,L as de,b as le,P as ce}from"./index-D0Udg6QN.js";import{C as ue,U as me}from"./users-round-BuAC1fAe.js";import{b as he,a as pe}from"./teacherGradeUtils-COfj_G-K.js";import{d as ge}from"./teacherSegmentUtils-BaJgF7HQ.js";import{g as be,b as R,m as xe,a as fe}from"./teacherMappingUtils-BLndk_0a.js";import{A as ve}from"./arrow-right-CFeM6htQ.js";import{P as H,T as z}from"./StatusPills-B9jj_F6J.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],we=W("circle-plus",ye);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]],je=W("file-check-2",ke),G=[{key:"dashboard",label:"Dashboard",icon:ue},{key:"students",label:"My Students",icon:me},{key:"create",label:"Create Intervention",icon:we},{key:"submit",label:"Submit Progress",icon:je}],D={base:"px-4 py-3 rounded-2xl bg-white/80 dark:bg-white/10 border border-primary/20 text-sm text-foreground dark:text-white placeholder:text-muted-foreground/70 dark:placeholder:text-white/50 focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-transparent transition-all"};D.textarea=`${D.base} min-h-[80px]`;D.notes=`${D.base} min-h-[120px]`;const L=()=>({studentId:"",studentName:"",grade:"",className:"",type:"",strategyId:"",strategyName:"",tier:"tier2",goal:"",notes:"",startDate:"",duration:"",monitorFrequency:"",monitorMethod:"",baselineValue:"",baselineUnit:"score",targetValue:"",targetUnit:"score"}),$=()=>({studentId:"",assignmentId:"",studentName:"",date:"",performed:"yes",scoreValue:"",scoreUnit:"score",badge:"ðŸŽ‰ Progress Party",notes:""}),Ne=a=>{const{toast:t}=J(),r=te(),[l,m]=s.useState("dashboard"),[d,h]=s.useState(()=>L()),[i,b]=s.useState(()=>$()),[n,g]=s.useState(!1),[c,u]=s.useState(!1),f=ae(x=>x.auth?.user);s.useEffect(()=>{const p=new URLSearchParams(r.search).get("tab");p&&a.some(o=>o.key===p)&&m(p)},[r.search,a]);const j=s.useCallback((x,p)=>{h(o=>({...o,[x]:p}))},[]),k=s.useCallback((x,p)=>{b(o=>({...o,[x]:p}))},[]),y=s.useCallback(async(x,p)=>{if(x.preventDefault(),n)return;const o=p||d;if(["studentId","type","tier","startDate","monitorFrequency","monitorMethod"].filter(w=>!o[w]).length){t({title:"Complete the required fields",description:"Student, type, tier, start date, frequency, and method are required.",variant:"destructive"});return}try{g(!0);const I={mentorId:f?.id||f?._id,studentIds:[o.studentId],tier:o.tier,focusAreas:o.type?[o.type]:["Universal Supports"],startDate:o.startDate||new Date().toISOString(),duration:o.duration||void 0,strategyId:o.strategyId||void 0,strategyName:o.strategyName||void 0,monitoringMethod:o.monitorMethod||void 0,monitoringFrequency:o.monitorFrequency||void 0,metricLabel:o.baselineUnit||o.targetUnit||"score",baselineScore:o.baselineValue?{value:Number(o.baselineValue),unit:o.baselineUnit||"score"}:void 0,targetScore:o.targetValue?{value:Number(o.targetValue),unit:o.targetUnit||"score"}:void 0,notes:o.notes||void 0,goals:o.goal?[{description:o.goal,successCriteria:""}]:void 0};await se(I),t({title:"Intervention saved",description:"Student plan created successfully. Track their progress!"}),h(L())}catch(w){console.error("Failed to save intervention plan:",w),t({title:"Failed to save plan",description:w?.response?.data?.message||w?.message||"Please try again.",variant:"destructive"})}finally{g(!1)}},[d,n,t,f]),v=s.useCallback(async x=>{if(x.preventDefault(),!c){if(!i.assignmentId||!i.notes){t({title:"Complete the required fields",description:"Please select a student and provide progress notes.",variant:"destructive"});return}try{u(!0);const p={checkIns:[{date:i.date||new Date().toISOString(),summary:i.notes||"Progress update",value:i.scoreValue?Number(i.scoreValue):void 0,unit:i.scoreUnit||"score",performed:i.performed==="yes"||i.performed===!0,celebration:i.badge||void 0}]};await q(i.assignmentId,p),t({title:"Progress submitted",description:"Your monitoring update is live on the MTSS dashboard."}),b($())}catch(p){console.error("Failed to submit progress:",p),t({title:"Failed to submit progress",description:p?.response?.data?.message||p?.message||"Please try again.",variant:"destructive"})}finally{u(!1)}}},[i,c,t]),N=s.useCallback(()=>{h(L())},[]),S=s.useCallback(()=>{b($())},[]);return{activeTab:l,setActiveTab:m,interventionForm:d,progressForm:i,handleInterventionChange:j,handleProgressChange:k,handleSavePlan:y,handleSubmitProgress:v,resetInterventionForm:N,resetProgressForm:S,submittingPlan:n,setSubmittingPlan:g,submittingProgress:c,setSubmittingProgress:u}},Se={male:"Mr.",female:"Ms."},K=a=>Se[a?.toLowerCase?.()]||"",Y=a=>{const t=["Hey %NAME%, let's light up today's boosts.","Morning %NAME%, ready to spark joyful wins?","%NAME%, today's plan is setâ€”let's uplift every student.","Cheers %NAME%, another day to glow-up kids' progress.","Let's dive in %NAME%, the boost studio is humming."],r=new Date,l=(r.getDate()+r.getMonth())%t.length;return t[l].replace("%NAME%",a)},Ce=a=>{const t=a?.username||a?.name||"MTSS Mentor",r=K(a?.gender),l=r?`${r} ${t}`:t;return{teacher:l,school:a?.jobPosition||a?.unit||"Millennia21 Schools",tierFocus:"Personalized supports",greeting:Y(l),gradeLabel:a?.unit||"All Grades"}},Pe=()=>{const a=s.useMemo(()=>be(),[]),t=s.useMemo(()=>Ce(a),[a]),r=s.useMemo(()=>ge(a),[a]),[l,m]=s.useState(()=>R()),[d,h]=s.useState([]),[i,b]=s.useState([]),[n,g]=s.useState(t),[c,u]=s.useState(!0),[f,j]=s.useState(null),k=s.useCallback(async y=>{u(!0),j(null);try{const v=he(r),N=pe(r),S=v.length&&(r.shouldFilterServer||r.unit!=="Junior High"),x={limit:r.unit==="Junior High"?500:200};S&&(x.grade=v.join(",")),N.length&&(x.className=N.join(","));const[p,o]=await Promise.all([re({limit:150},y?{signal:y}:{}),ne(x,y?{signal:y}:{})]),T=p.assignments||p||[],U=R(T),w=a?.username||a?.name||t.teacher,I=a?.gender,C=xe(T,w),F=o?.students||[],M=fe(F,C.students,r),V=K(I),A=V?`${V} ${w}`:w;m(U);const P=M.length?M:C.students;h(P),b(C.spotlightChart.length?C.spotlightChart:[{label:"Start",date:"Start",reading:0,goal:100,value:0}]),g(O=>({...O,...t,teacher:A||t.teacher,greeting:Y(A||t.teacher),tierFocus:C.focusLabel||O.tierFocus||"Tiered Supports",gradeLabel:r.label}))}catch(v){v?.name!=="CanceledError"&&v?.name!=="AbortError"&&j(v?.response?.data?.message||v?.message||"Failed to load MTSS data")}finally{u(!1)}},[t,r]);return s.useEffect(()=>{const y=new AbortController;return k(y.signal),()=>y.abort()},[k]),{statCards:l,students:d,progressData:i.length?i:[{label:"Start",date:"Start",reading:0,goal:100,value:0}],heroBadge:n,loading:c,error:f,refresh:()=>k()}},B=({heroBadge:a,tabs:t,activeTab:r,onTabChange:l})=>e.jsx("div",{className:"relative rounded-[40px] p-[1.5px] bg-gradient-to-r from-[#fb7185]/50 via-[#60a5fa]/50 to-[#34d399]/50 shadow-[0_35px_90px_rgba(15,23,42,0.28)]",children:e.jsxs("div",{className:"relative overflow-hidden rounded-[38px] border border-white/40 dark:border-white/10 bg-white/70 dark:bg-slate-900/60 backdrop-blur-2xl",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute -top-24 -left-16 w-72 h-72 bg-gradient-to-br from-[#f472b6]/25 via-[#60a5fa]/15 to-transparent blur-[140px]"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-[#22d3ee]/25 via-[#a855f7]/15 to-transparent blur-[160px]"}),e.jsx("div",{className:"absolute inset-0 opacity-25 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.6),_transparent_60%)]"})]}),e.jsxs("div",{className:"relative px-5 py-7 sm:px-8 text-slate-900 dark:text-white",children:[e.jsxs("div",{className:"grid gap-5 lg:grid-cols-[minmax(0,1fr)_auto] lg:items-end",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 text-[11px] font-semibold uppercase tracking-[0.35em] text-slate-700 dark:text-slate-200 bg-white/80 dark:bg-white/10 border border-white/60 dark:border-white/15 px-3 py-1 rounded-full",children:[e.jsx("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/90 dark:bg-white/15 text-rose-500",children:e.jsx(oe,{className:"w-3.5 h-3.5"})}),"MTSS Studio"]}),e.jsx("span",{className:"hidden sm:inline-flex px-3 py-1 rounded-full bg-gradient-to-r from-white/90 via-white/70 to-white/60 dark:from-white/10 dark:via-white/5 dark:to-white/5 border border-white/60 dark:border-white/15 tracking-[0.3em] uppercase text-[11px] font-semibold text-slate-600 dark:text-slate-200",children:a.school}),e.jsx("span",{className:"hidden md:inline-flex px-3 py-1 rounded-full bg-gradient-to-r from-emerald-100/80 to-sky-100/80 dark:from-emerald-900/40 dark:to-sky-900/30 text-[11px] font-semibold text-emerald-700 dark:text-emerald-200",children:a.gradeLabel})]}),e.jsx("h1",{className:"text-2xl sm:text-4xl font-black leading-tight bg-gradient-to-r from-[#0f172a] via-[#334155] to-[#1d4ed8] dark:from-white dark:via-[#c7d2fe] dark:to-[#f472b6] text-transparent bg-clip-text",children:a.greeting||`Hey ${a.teacher}, let's light up today's boosts.`}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-200 max-w-xl",children:["Focus today: ",e.jsx("span",{className:"font-semibold text-slate-900 dark:text-white",children:a.tierFocus})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-end",children:[e.jsxs("div",{className:"px-4 py-3 rounded-3xl bg-white/80 dark:bg-white/10 border border-white/60 dark:border-white/15 shadow-inner text-sm font-semibold",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-300 text-[11px] uppercase tracking-[0.3em]",children:"Teacher"}),e.jsx("div",{className:"text-base font-semibold",children:a.teacher})]}),e.jsxs("div",{className:"px-4 py-3 rounded-3xl bg-white/80 dark:bg-white/10 border border-white/60 dark:border-white/15 shadow-inner text-sm font-semibold",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-300 text-[11px] uppercase tracking-[0.3em]",children:"Today"}),e.jsx("div",{className:"text-base font-semibold",children:a.dateLabel||"Ready to roll"})]})]})]}),e.jsx("div",{className:"mt-7 rounded-3xl bg-white/70 dark:bg-white/5 border border-white/60 dark:border-white/10 p-2 shadow-inner",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:t.map(m=>{const d=m.icon,h=r===m.key;return e.jsxs("button",{onClick:()=>l(m.key),className:`group flex items-center justify-between gap-3 rounded-2xl px-3 py-3 text-sm font-semibold transition border shadow-[0_10px_30px_rgba(15,23,42,0.12)] ${h?"bg-gradient-to-r from-[#22d3ee] via-[#3b82f6] to-[#a855f7] text-white border-transparent shadow-[0_18px_45px_rgba(59,130,246,0.35)]":"bg-white/80 dark:bg-white/10 text-slate-600 dark:text-slate-200 border-white/70 dark:border-white/15 hover:bg-white hover:dark:bg-white/20"}`,"aria-pressed":h,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex h-8 w-8 items-center justify-center rounded-full ${h?"bg-white/25 text-white":"bg-white/90 dark:bg-white/10 text-slate-500 dark:text-slate-200"}`,children:e.jsx(d,{className:"w-4 h-4"})}),m.label]}),e.jsx(ve,{className:`w-4 h-4 transition-transform ${h?"translate-x-1":"group-hover:translate-x-1"}`})]},m.key)})})})]})]})});B.displayName="TeacherHeroSection";const _e=s.memo(B),_="px-4 py-3 rounded-2xl bg-white/80 dark:bg-white/10 border border-primary/20 text-sm text-foreground placeholder:text-muted-foreground/70 focus:outline-none focus:ring-2 focus:ring-primary/40 focus:border-transparent transition-all w-full",Te=["wpm","%","pts","score"],X=s.memo(({student:a,onClose:t,onSubmit:r,submitting:l=!1})=>{const m=s.useMemo(()=>new Date().toISOString().split("T")[0],[]),[d,h]=s.useState({date:m,performed:"yes",scoreValue:"",scoreUnit:"score",notes:"",badge:"ðŸŽ‰ Progress Party"});if(!a)return null;const i=(n,g)=>{h(c=>({...c,[n]:g}))},b=n=>{n.preventDefault(),r?.(a,d)};return e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-center justify-center px-4 mtss-theme",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:t,"aria-hidden":"true"}),e.jsxs(Q.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"relative w-full max-w-2xl rounded-[28px] overflow-hidden border border-white/40 bg-white/95 dark:bg-slate-900/90 shadow-[0_25px_80px_rgba(15,23,42,0.35)]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#34d399]/80 via-[#22d3ee]/80 to-[#60a5fa]/80 text-white p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"uppercase text-xs tracking-[0.4em] opacity-80",children:"Quick Update"}),e.jsx("h3",{className:"text-2xl font-bold",children:a.name}),e.jsx("p",{className:"text-sm opacity-90",children:"Share today's check-in and celebrations"})]}),e.jsx("button",{onClick:t,"aria-label":"Close",className:"p-2 bg-white/30 rounded-full hover:bg-white/50 transition",disabled:l,children:e.jsx(ie,{className:"w-5 h-5"})})]}),e.jsxs("form",{className:"p-6 space-y-4",onSubmit:b,children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Date"}),e.jsx("input",{type:"date",className:_,value:d.date,onChange:n=>i("date",n.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Intervention Performed?"}),e.jsxs("select",{className:_,value:d.performed,onChange:n=>i("performed",n.target.value),children:[e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Status or Score"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",className:`${_} flex-1`,placeholder:"e.g. 78",value:d.scoreValue,onChange:n=>i("scoreValue",n.target.value)}),e.jsx("select",{className:`${_} w-28`,value:d.scoreUnit,onChange:n=>i("scoreUnit",n.target.value),children:Te.map(n=>e.jsx("option",{value:n,children:n},n))})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Celebration Emoji"}),e.jsxs("select",{className:_,value:d.badge,onChange:n=>i("badge",n.target.value),children:[e.jsx("option",{value:"ðŸŽ‰ Progress Party",children:"ðŸŽ‰ Progress Party"}),e.jsx("option",{value:"âœ¨ Stellar Boost",children:"âœ¨ Stellar Boost"}),e.jsx("option",{value:"ðŸŒˆ Focus Mode",children:"ðŸŒˆ Focus Mode"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground",children:"Notes & Observations"}),e.jsx("textarea",{className:`${_} min-h-[120px]`,placeholder:"Describe the student's progress, challenges, or celebrations...",value:d.notes,onChange:n=>i("notes",n.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 pt-2",children:[e.jsx(Q.button,{type:"submit",className:"px-5 py-3 rounded-full bg-gradient-to-r from-[#ff58c2] to-[#ffb347] text-white font-semibold shadow-[0_15px_40px_rgba(255,88,194,0.25)] disabled:opacity-60",whileHover:{scale:l?1:1.03},whileTap:{scale:l?1:.97},disabled:l,children:l?"Saving...":"Save Update"}),e.jsx("button",{type:"button",onClick:t,className:"px-5 py-3 rounded-full bg-white/80 dark:bg-white/10 text-foreground font-semibold border border-border/60 disabled:opacity-60",disabled:l,children:"Cancel"})]})]})]})]})});X.displayName="QuickUpdateModal";const Ie=s.lazy(()=>E(()=>import("./DashboardOverview-BW60yn5e.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),Me=s.lazy(()=>E(()=>import("./StudentsPanel-q0vqqcJy.js"),__vite__mapDeps([12,1,2,3,4,13,14,15,16,17,18,19,20,21]))),De=s.lazy(()=>E(()=>import("./InterventionFormPanel-DSSjECr9.js"),__vite__mapDeps([22,1,2]))),Ue=s.lazy(()=>E(()=>import("./ProgressFormPanel-BLMn-igH.js"),__vite__mapDeps([23,1,2,18,16,19]))),Ve=()=>e.jsx("div",{className:"glass glass-card p-8 text-center text-muted-foreground animate-pulse",children:"Loading panel..."}),Z=s.memo(({activeTab:a,statCards:t,students:r,progressData:l,interventionForm:m,progressForm:d,handleInterventionChange:h,handleProgressChange:i,handleSavePlan:b,handleProgressSubmitForm:n,baseFieldClass:g,textareaClass:c,notesTextareaClass:u,submittingPlan:f,submittingProgress:j,onViewStudent:k,onQuickUpdate:y,refresh:v})=>{const N=s.useMemo(()=>{switch(a){case"dashboard":return e.jsx(Ie,{statCards:t,students:r,progressData:l,TierPill:z,ProgressBadge:H,onView:k,onUpdate:y});case"students":return e.jsx(Me,{students:r,TierPill:z,ProgressBadge:H,onRefresh:v});case"create":return e.jsx(De,{formState:m,onChange:h,onSubmit:S=>b(S,m),baseFieldClass:g,textareaClass:c,students:r,submitting:f});case"submit":return e.jsx(Ue,{formState:d,onChange:i,onSubmit:n,baseFieldClass:g,textareaClass:u,students:r,submitting:j});default:return null}},[a,g,h,i,n,b,m,u,y,k,l,d,v,t,r,f,j,c]);return e.jsx(s.Suspense,{fallback:e.jsx(Ve,{}),children:N})});Z.displayName="TeacherDashboardPanels";const Ae=({loading:a,error:t,onRetry:r})=>!a&&!t?null:e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-white/60 dark:bg-white/5 px-4 py-3 flex items-center justify-between gap-4 text-sm text-muted-foreground","data-aos":"fade-up",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx(de,{className:"w-4 h-4 animate-spin text-primary"}),e.jsx("span",{children:t||"Syncing live MTSS data..."})]}),t&&e.jsx("button",{onClick:r,className:"text-primary font-semibold hover:underline",children:"Retry"})]}),Ee=({students:a,progressForm:t,resetProgressForm:r,refresh:l,setSubmittingProgress:m,toast:d,setSavingQuickUpdate:h,onCloseQuickUpdate:i})=>{const b=s.useCallback(async g=>{if(g.preventDefault(),!t.studentId||!t.date||t.scoreValue===""){d({title:"Complete the required fields",description:"Student, date, and score are required to submit progress.",variant:"destructive"});return}const c=a.find(u=>u.id===t.studentId);if(!c){d({title:"Select a student",description:"Choose a student before logging progress.",variant:"destructive"});return}if(!c.assignmentId){d({title:"No active intervention",description:`${c.name} is not linked to an active intervention yet.`,variant:"destructive"});return}try{const u=t.notes?.trim()||"",f=t.scoreValue!==""?Number(t.scoreValue):void 0;m(!0),await q(c.assignmentId,{checkIns:[{date:t.date||new Date,summary:u||"Progress update logged via dashboard",nextSteps:u||void 0,value:Number.isFinite(f)?f:void 0,unit:t.scoreUnit,performed:t.performed==="yes"}]}),d({title:"Progress saved",description:`${c.name}'s update is now on the dashboard.`}),r(),l()}catch(u){d({title:"Failed to save progress",description:u?.response?.data?.message||u.message||"Unable to record update now.",variant:"destructive"})}finally{m(!1)}},[t,a,d,r,l,m]),n=s.useCallback(async(g,c)=>{if(!g?.assignmentId){d({title:"No active intervention",description:`${g?.name||"Student"} isn't linked to an active intervention yet.`,variant:"destructive"});return}h(!0);try{const u=c.notes?.trim()||"",f=c.scoreValue!==""?Number(c.scoreValue):void 0;await q(g.assignmentId,{checkIns:[{date:c.date,summary:u||"Quick update",nextSteps:u||void 0,value:Number.isFinite(f)?f:void 0,unit:c.scoreUnit,performed:c.performed==="yes",celebration:c.badge}]}),d({title:"Progress update saved",description:`${g.name}'s update was recorded!`}),i(),l()}catch(u){d({title:"Failed to save update",description:u?.response?.data?.message||u.message||"Please try again in a moment.",variant:"destructive"})}finally{h(!1)}},[d,i,l,h]);return{handleProgressSubmitForm:b,handleQuickUpdateSubmit:n}},ee=s.memo(()=>{const{toast:a}=J(),t=le(),{statCards:r,students:l,progressData:m,heroBadge:d,loading:h,error:i,refresh:b}=Pe(),{activeTab:n,setActiveTab:g,interventionForm:c,progressForm:u,handleInterventionChange:f,handleProgressChange:j,handleSavePlan:k,resetProgressForm:y,submittingPlan:v,setSubmittingProgress:N,submittingProgress:S}=Ne(G),[x,p]=s.useState(null),[o,T]=s.useState(!1),{base:U,textarea:w,notes:I}=D,C=s.useCallback(P=>{P?.slug&&t(`/mtss/student/${P.slug}`)},[t]),F=s.useCallback(P=>p(P),[]),M=s.useCallback(()=>p(null),[]),{handleProgressSubmitForm:V,handleQuickUpdateSubmit:A}=Ee({students:l,progressForm:u,resetProgressForm:y,refresh:b,setSubmittingProgress:N,toast:a,setSavingQuickUpdate:T,onCloseQuickUpdate:M});return e.jsxs("div",{className:"mtss-theme mtss-animated-bg min-h-screen relative overflow-hidden text-foreground dark:text-white transition-colors",children:[(v||S||o)&&e.jsx(ce,{}),e.jsx("div",{className:"mtss-bg-overlay"}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 h-64 bg-gradient-to-b from-white/70 via-[#fef2f2]/40 to-transparent dark:from-white/10 dark:via-white/5"}),e.jsx("div",{className:"absolute -bottom-24 left-12 w-[28rem] h-[28rem] bg-gradient-to-br from-[#22d3ee]/35 via-[#a855f7]/25 to-[#f472b6]/20 dark:from-[#0ea5e9]/25 dark:via-[#a855f7]/20 dark:to-[#f472b6]/15 blur-[200px]"})]}),e.jsxs("div",{className:"relative z-20 container-tight px-4 sm:px-6 py-8 lg:py-14 space-y-8 lg:space-y-10",children:[e.jsx("section",{className:"mtss-gradient-border overflow-hidden rounded-3xl border border-white/40 dark:border-white/10 shadow-[0_25px_60px_rgba(148,163,184,0.25)]","data-aos":"fade-up","data-aos-duration":"700",children:e.jsx(_e,{heroBadge:d,tabs:G,activeTab:n,onTabChange:g})}),e.jsx(Ae,{loading:h,error:i,onRetry:b}),e.jsx(Z,{activeTab:n,statCards:r,students:l,progressData:m,interventionForm:c,progressForm:u,handleInterventionChange:f,handleProgressChange:j,handleSavePlan:k,handleProgressSubmitForm:V,baseFieldClass:U,textareaClass:w,notesTextareaClass:I,submittingPlan:v,submittingProgress:S,onViewStudent:C,onQuickUpdate:F,refresh:b})]}),x&&e.jsx(X,{student:x,onClose:M,onSubmit:A,submitting:o})]})});ee.displayName="TeacherDashboardPage";const He=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{X as Q,He as T};
