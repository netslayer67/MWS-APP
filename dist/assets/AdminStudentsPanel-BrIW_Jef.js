import{e as P,r as a,j as e,aQ as D,aR as _,aS as E,aT as F,aY as O,aZ as U}from"./index-C2UXQ8jH.js";import{S as $}from"./StudentsTable-CvPrdVIu.js";import{P as I,T as q}from"./StatusPills-GbhvPgSH.js";import{d as B}from"./mtssService-BJ4S8av5.js";import{S as R}from"./search-B6bavH_W.js";import{U as z}from"./users-C5NPhcJm.js";const G=[{label:"Tier 2 - Targeted",value:"tier2"},{label:"Tier 3 - Intensive",value:"tier3"}],A=({open:n,onClose:x,students:c=[],mentors:d=[],onAssigned:v})=>{const{toast:b}=P(),[f,j]=a.useState("tier2"),[o,w]=a.useState(()=>d?.[0]?._id||""),[r,S]=a.useState(""),[u,g]=a.useState(""),[y,p]=a.useState(!1),m=a.useMemo(()=>c.map(s=>s.id||s._id),[c]),l=m.length<2||!o||y;a.useEffect(()=>{!o&&d?.length&&w(d[0]._id)},[d,o]);const N=async s=>{if(s.preventDefault(),!l){p(!0);try{const i=r?r.split(",").map(t=>t.trim()).filter(Boolean):["Targeted Support"];await B({mentorId:o,studentIds:m,tier:f,focusAreas:i,notes:u}),b({title:"Assignment created",description:"Selected students were assigned to the mentor."}),v?.()}catch(i){b({title:"Failed to assign",description:i?.response?.data?.message||i.message||"Unable to create mentor assignment",variant:"destructive"})}finally{p(!1)}}};return e.jsx(D,{open:n,onOpenChange:s=>!s&&x?.(),children:e.jsxs(_,{className:"max-w-2xl",children:[e.jsxs(E,{children:[e.jsx(F,{children:"Assign selected students"}),e.jsxs(O,{children:["Create a new MTSS assignment for ",e.jsx("strong",{children:c.length})," students. Select a tier and mentor to continue."]})]}),e.jsxs("form",{className:"space-y-4",onSubmit:N,children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs uppercase tracking-[0.4em] text-muted-foreground",children:"Students"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:c.map(s=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-primary/10 text-sm font-semibold text-primary",children:s.name},s.id))})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsx("span",{children:"Tier"}),e.jsx("select",{value:f,onChange:s=>j(s.target.value),className:"w-full rounded-2xl border border-border/60 bg-white/80 dark:bg-white/10 px-4 py-3",children:G.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsx("span",{children:"Mentor"}),e.jsx("select",{value:o,onChange:s=>w(s.target.value),className:"w-full rounded-2xl border border-border/60 bg-white/80 dark:bg-white/10 px-4 py-3",children:d.map(s=>e.jsxs("option",{value:s._id,children:[s.name," · ",s.jobPosition||s.role]},s._id))})]})]}),e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsx("span",{children:"Focus areas (comma separated)"}),e.jsx("input",{value:r,onChange:s=>S(s.target.value),placeholder:"Fluency boost, SEL routines",className:"w-full rounded-2xl border border-border/60 bg-white/80 dark:bg-white/10 px-4 py-3"})]}),e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsx("span",{children:"Notes"}),e.jsx("textarea",{value:u,onChange:s=>g(s.target.value),placeholder:"Add optional context for the mentor…",className:"w-full h-24 rounded-2xl border border-border/60 bg-white/80 dark:bg-white/10 px-4 py-3 resize-none"})]}),e.jsxs(U,{className:"pt-4",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 rounded-full border border-border/60 text-sm font-semibold text-foreground dark:text-white",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:`px-5 py-2.5 rounded-full text-sm font-semibold text-white ${l?"bg-muted cursor-not-allowed opacity-60":"bg-gradient-to-r from-[#22d3ee] to-[#3b82f6] shadow hover:-translate-y-0.5 transition"}`,children:y?"Assigning…":"Create assignment"})]})]})]})})};A.displayName="AdminAssignmentModal";const k=({filters:n,onFilterChange:x,gradeOptions:c,tierOptions:d,typeOptions:v,mentorOptions:b,filteredStudents:f,allStudents:j,onViewStudent:o,onUpdateStudent:w,selectedIds:r,onToggleSelect:S,onResetSelection:u,mentorDirectory:g,onRefresh:y})=>{const[p,m]=a.useState(!1),l=a.useMemo(()=>r?.length?j.filter(t=>r.includes(t.id||t._id)):[],[r,j]),N="px-4 py-3 rounded-2xl bg-white/70 dark:bg-white/10 border border-white/40 dark:border-white/10 text-sm text-foreground dark:text-white focus:outline-none focus:ring-2 focus:ring-primary/40",s=(t,T,C,M)=>e.jsx("select",{className:N,value:t,onChange:h=>x(C,h.target.value),children:T.map(h=>e.jsx("option",{value:h,children:M(h)},h))}),i=l.length<2||g.length===0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"glass glass-card mtss-card-surface p-6 rounded-[36px]","data-aos":"fade-up",children:e.jsxs("div",{className:"grid gap-4 lg:grid-cols-5",children:[s(n.grade,c,"grade",t=>t==="all"?"All Grades":t),s(n.tier,d,"tier",t=>t==="all"?"All Tiers":t),s(n.type,v,"type",t=>t==="all"?"All Types":t),s(n.mentor,b,"mentor",t=>t==="all"?"All Mentors":t),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",className:`${N} pl-10`,placeholder:"Search students",value:n.query,onChange:t=>x("query",t.target.value)})]})]})}),e.jsxs("div",{className:"glass glass-card mtss-card-surface p-6 rounded-[36px]","data-aos":"fade-up","data-aos-delay":"150",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-muted-foreground",children:"Roster"}),e.jsx("h3",{className:"text-xl font-black text-foreground dark:text-white",children:"All students in MTSS"})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{children:[l.length," selected · ",g.length," mentors available"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l.length>0&&e.jsx("button",{onClick:u,className:"px-4 py-2 rounded-full border border-border/60 text-sm font-semibold text-foreground dark:text-white hover:bg-white/70 dark:hover:bg-white/10 transition",children:"Clear selection"}),e.jsx("button",{disabled:i,onClick:()=>m(!0),className:`px-4 py-2 rounded-full text-sm font-semibold text-white shadow ${i?"bg-muted cursor-not-allowed opacity-60":"bg-gradient-to-r from-[#7dd3fc] to-[#60a5fa] hover:-translate-y-0.5 transition"}`,children:"Assign Selected"})]})]})]}),e.jsx($,{students:f,TierPill:q,ProgressBadge:I,showActions:!0,onView:o,onUpdate:w,selectable:!0,selectedIds:r,onSelect:S})]}),p&&e.jsx(A,{open:p,onClose:()=>m(!1),students:l,mentors:g,onAssigned:()=>{u(),m(!1),y?.()}})]})};k.displayName="AdminStudentsPanel";const J=a.memo(k);export{J as default};
