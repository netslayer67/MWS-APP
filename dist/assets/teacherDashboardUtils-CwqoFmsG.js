import{c as N,af as G,ae as P}from"./index-B1azmWwg.js";import{S as U}from"./shield-check-DDGHQKx1.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],z=N("clipboard-check",_),p=e=>e?.data?.data||{},S=(e={},r={})=>({params:r,...e}),re=(e={},r={})=>G.get("/mtss/mentor-assignments",S(r,e)).then(p),ae=(e={},r={})=>G.get("/mtss/strategies",S(r,e)).then(p),te=(e={},r={})=>G.get("/mtss/students",S(r,e)).then(p),ne=(e,r={})=>G.get(`/mtss/students/${e}`,r).then(p),se=(e={},r={})=>G.get("/mtss/mentors",S(r,e)).then(p),ie=(e,r={})=>G.post("/mtss/mentor-assignments",e,r).then(p),oe=(e,r,a={})=>G.put(`/mtss/mentor-assignments/${e}`,r,a).then(p),A=[{key:"active",label:"Active Interventions",sub:"Kids in a boost bubble",icon:U,accent:"from-[#0ea5e9]/90 via-[#818cf8]/85 to-[#34d399]/80"},{key:"due",label:"Updates Due",sub:"Check-ins waiting today",icon:z,accent:"from-[#fcd34d]/90 via-[#fb923c]/85 to-[#38bdf8]/80"},{key:"success",label:"Success Rate",sub:"Kids hitting targets",icon:P,accent:"from-[#22d3ee]/90 via-[#a855f7]/85 to-[#f472b6]/80"}],B={active:"On Track",paused:"Needs Attention",completed:"Completed",closed:"Closed"},w={active:4,paused:3,completed:2,closed:1},x={"Junior High":["Grade 7","Grade 8","Grade 9"],Elementary:["Grade 1","Grade 2","Grade 3","Grade 4","Grade 5","Grade 6"],Kindergarten:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],Pelangi:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"]},R={"Grade 7":["Grade 7","Grade 7 - Helix"],"Grade 8":["Grade 8","Grade 8 - Cartwheel"],"Grade 9":["Grade 9","Grade 9 - Messier 87"]},$=["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2","Kindergarten"],L=["Kindergarten - Milky Way","Kindergarten - Bear Paw","Kindergarten - Starlight"],b=(e="")=>{if(!e)return"";const r=e.toString().replace(/\s+/g," ").trim();if(!r)return"";const a=r.match(/^kind(?:ergarten)?(?:\s*-\s*(.*))?$/i);if(a){const s=a[1]?.trim();return s?`Kindergarten - ${s.split(/\s+/).map(l=>l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()).join(" ")}`:"Kindergarten"}return r},v={abu:["Grade 7"],yosa:["Grade 7"],nadia:["Grade 7"],novan:["Grade 7"],rifqi:["Grade 8"],"rizki nurul hayati":["Grade 8"],anggie:["Grade 8"],dhaffa:["Grade 9"],tyas:["Grade 9"],vicki:["Grade 9"],zolla:["Grade 9"],hasan:["Grade 7","Grade 8","Grade 9"],hadi:["Grade 7","Grade 8","Grade 9"],himawan:["Grade 7","Grade 8","Grade 9"],"aria wisnuwardana":["Grade 7","Grade 8","Grade 9"],gundah:["Grade 1"],"krisalyssa esna rehulina tarigan":["Grade 1"],almia:["Grade 1"],romasta:["Grade 1"],"zavier cloudya mashareen":["Grade 1"],novia:["Grade 1"],alin:["Grade 2"],bela:["Grade 2"],maria:["Grade 2"],tria:["Grade 2"],laras:["Grade 2"],dini:["Grade 2"],restia:["Grade 2"],reza:["Grade 2"],berliana:["Grade 3"],raisa:["Grade 3"],cecil:["Grade 3"],putri:["Grade 3"],galen:["Grade 3"],salsabila:["Grade 3"],dien:["Grade 3"],ika:["Grade 3"],eva:["Grade 4"],nathasya:["Grade 4"],rike:["Grade 4"],prisy:["Grade 4"],risma:["Grade 4"],galuh:["Grade 4"],annisa:["Grade 4"],iis:["Grade 4"],tri:["Grade 5"],robby:["Grade 5"],nazmi:["Grade 5"],fadholi:["Grade 5"],devi:["Grade 6"],pipiet:["Grade 6"],afi:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],ayunda:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],diya:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],nanda:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],widya:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],yohana:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],ferlyna:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],vinka:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"],kholi:["Grade 1","Grade 2","Grade 3","Grade 4","Grade 5","Grade 6"],latifah:["Kindergarten Pre-K","Kindergarten K1","Kindergarten K2"]},m=e=>{if(!e)return"";const r=e.toString().trim(),a=r.toLowerCase(),s=r.match(/grade\s*\d+/i);return s?s[0].replace(/grade/i,"Grade").replace(/\s+/g," ").trim():a.includes("kindergarten")||a.includes("kindy")?/(pre[-\s]?k|prekind)/i.test(r)?"Kindergarten Pre-K":/\bk\s*1\b/i.test(r)?"Kindergarten K1":/\bk\s*2\b/i.test(r)?"Kindergarten K2":"Kindergarten":r.split("-")[0].trim()},j=(e={})=>{const r=new Set;(e.classes||[]).forEach(s=>{if(s?.className){const i=b(s.className),l=s.className.toLowerCase(),g=/kindy|kindergarten|pre[-\s]?k|k\s*1|k\s*2/.test(l),n=i.toLowerCase()==="kindergarten"||!i.startsWith("Kindergarten -");g&&n?L.forEach(o=>r.add(o)):i&&r.add(i)}});const a=(e.unit||"").toLowerCase();return!r.size&&(a==="kindergarten"||a==="pelangi")&&L.forEach(s=>r.add(s)),Array.from(r).filter(Boolean)},de=(e={})=>Array.from(new Set((e.allowedClasses||[]).map(b).filter(Boolean))),F=(e={})=>{const r=[];if(e.username&&r.push(e.username.toLowerCase()),e.name){r.push(e.name.toLowerCase());const a=e.name.split(/[\s,]+/)[0];a&&r.push(a.toLowerCase())}if(e.email){const a=e.email.split("@")[0];a&&r.push(a.toLowerCase())}for(const a of r)if(v[a])return v[a];return[]},W=(e="")=>{if(!e)return[];const r=[],a=e.match(/grade\s*\d+/gi);if(a&&a.forEach(s=>r.push(s.trim().replace(/\s+/g," ").replace(/grade/i,"Grade").trim())),/kindy|kindergarten/i.test(e)){const s=e.match(/kindy\s*[a-z0-9'\-\s]+/i);s?r.push(s[0].trim()):r.push("Kindergarten Pre-K","Kindergarten K1","Kindergarten K2")}return r},ce=(e={})=>{const a=(Array.isArray(e?.classes)?e.classes:[]).map(c=>m(c.grade)).filter(Boolean),s=W(e?.jobPosition).map(m).filter(Boolean),i=x[e?.unit]||[],l=(e?.username||e?.name||"").toLowerCase(),g=v[l]||[],n=g.length?g:F(e);let o="all",t=[];a.length?(o="classes",t=a):s.length?(o="job",t=s):n.length?(o="fallback",t=n):i.length?(o="unit",t=i):t=[];let d=Array.from(new Set(t.map(m).filter(Boolean)));!d.some(c=>/^grade\s*\d+/i.test(c)||c.toLowerCase().startsWith("kindergarten")||c.toLowerCase().startsWith("kindy"))&&i.length&&(d=i.slice());const f=new Set(j(e)),u=(e?.unit||"").toLowerCase();(u==="kindergarten"||u==="pelangi")&&!d.some(c=>c.toLowerCase()==="kindergarten")&&d.push("Kindergarten"),(u==="kindergarten"||u==="pelangi")&&!f.size&&L.forEach(c=>f.add(c));const h=Array.from(f),C=!!h.length||!!(d.length&&(o==="classes"||o==="job"));return{allowedGrades:d,allowedClasses:h,source:o,shouldFilterServer:C,unit:e?.unit||"",label:d.length?d.join(", "):e?.unit||"All Grades"}},le=(e={})=>{const r=new Set,a=s=>{if(!s)return;const i=m(s);if(!i)return;if(r.add(i),i.toLowerCase()==="kindergarten"){$.forEach(g=>r.add(g));return}const l=R[i];l?.length&&l.forEach(g=>r.add(g))};return(e.allowedGrades||[]).forEach(a),!r.size&&e.unit==="Junior High"&&["Grade 7","Grade 8","Grade 9"].forEach(a),Array.from(r)},y=(e,r={month:"short",day:"numeric"})=>{if(!e)return"—";try{return new Intl.DateTimeFormat("en-US",r).format(new Date(e))}catch{return"—"}},M=e=>e?e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""):`student-${Math.random().toString(36).slice(2,6)}`,H=(e,r)=>{if(!e)return"Ongoing";const a=new Date(e),s=r?new Date(r):new Date,i=Math.max(1,Math.round((s-a)/(1e3*60*60*24*7)));return`${i} wk${i>1?"s":""}`},J=e=>{if(!e)return"Tier 2";const r=e.toString().toLowerCase();return r.includes("3")?"Tier 3":r.includes("1")?"Tier 1":"Tier 2"},O=e=>e?.focusAreas?.length?e.focusAreas[0]:e?.tier==="tier3"?"Intensive Support":"Literacy & SEL",V=(e,r)=>{const a=[e?.metricLabel,e?.notes,e?.focusAreas?.join(" "),r?.type].filter(Boolean).join(" ").toLowerCase();return/attendance|present|absen/.test(a)?"%":/reading|fluency|literacy|wpm/.test(a)?"wpm":/math|numeracy|accuracy|score/.test(a)?"score":/behavior|sel|conduct|check-in|checkin/.test(a)?"pts":"score"},q=e=>{if(e?.status!=="active")return!1;const r=e?.checkIns?.slice(-1)[0]?.date;return r?(Date.now()-new Date(r).getTime())/(1e3*60*60*24)>=7:!0},Q=(e={})=>{const r=e.checkIns||[];if(r.length){const l=r.length;return r.map((g,n)=>{const o=Math.round((n+1)/l*100),t=y(g.date);return{label:t,date:t,reading:o,goal:100,value:o}})}const a=e.goals||[];if(a.length){const l=a.length;let g=0;return a.map((n,o)=>{n.completed&&(g+=1);const t=Math.round(g/l*100),d=n.description||`Goal ${o+1}`;return{label:d,date:d,reading:t,goal:100,value:t}})}const s=e.status==="completed"?100:0,i=y(e.startDate);return[{label:i,date:i,reading:s,goal:100,value:s}]},Y=(e={})=>(e.checkIns||[]).slice(-6).reverse().map(r=>({date:y(r.date,{month:"short",day:"numeric",year:"numeric"}),score:"—",notes:r.summary||r.nextSteps||"Check-in recorded"})),X=e=>{const r=e?.checkIns?.slice(-1)[0]?.date||e?.startDate;if(!r)return"Awaiting update";const a=new Date(r);return a.setDate(a.getDate()+7),y(a)},ge=(e=[])=>{const r=e.filter(o=>o.status==="active").length,a=e.filter(q).length,s=e.reduce((o,t)=>o+(t.goals?.length||0),0),i=e.reduce((o,t)=>o+(t.goals?.filter(d=>d.completed).length||0),0),l=s||e.length||1,g=e.filter(o=>o.status==="completed").length,n=Math.round((i||g)/l*100);return[{...A[0],value:r},{...A[1],value:a},{...A[2],value:`${Number.isFinite(n)?n:0}%`}]},ue=(e=[],r="MTSS Mentor")=>{const a=new Map;e.forEach(n=>{const o=O(n),t=J(n.tier),d=n.status||"active",K=X(n),f=Q(n),u=Y(n),h=n.goals||[],C=h.filter(c=>c.completed).length;(n.studentIds||[]).forEach(c=>{const k=c?._id?.toString?.()||c?.id||c;if(!k)return;const T=m(c?.currentGrade||c?.classes?.[0]?.grade||c?.unit||c?.class||"-"),E=V(n,c),I={id:k,assignmentId:n._id?.toString?.()||null,slug:c?.slug||M(c?.name),name:c?.name||"Student",grade:T,type:o,tier:t,progress:B[d]||"On Track",nextUpdate:K,statusKey:d,profile:{teacher:r,mentor:n.mentorId?.name||r,type:o,strategy:n.focusAreas?.join(", ")||`Support focus - ${t}`,started:y(n.startDate),duration:H(n.startDate,n.endDate),baseline:h.length?0:null,current:h.length?C:n.checkIns?.length||(d==="completed"?1:0),target:h.length||Math.max(n.checkIns?.length||1,1),progressUnit:E,chart:f,history:u}},D=a.get(k);(!D||w[d]>w[D.statusKey])&&a.set(k,I)})});const i=Array.from(a.values()).sort((n,o)=>w[o.statusKey]-w[n.statusKey]),l=i[0]?.profile?.chart||[],g=i[0]?`${i[0].tier} ${i[0].type}`:null;return{students:i.map(({statusKey:n,...o})=>o),spotlightChart:l,focusLabel:g}},fe=(e=[],r=[],a={allowedGrades:[]})=>{const s=new Map(r.map(t=>[t.id?.toString?.()||t.slug||t.name,t])),i=a.allowedGrades||[],l=a.allowedClasses||[],g=t=>!i.length||i.includes(m(t)),n=t=>{if(!l.length)return!0;const d=b(t);return d?l.includes(d):!1},o=e.map(t=>{const d=t.id?.toString?.()||t._id?.toString?.()||t.slug||t.name,K=m(t.grade||t.currentGrade||t.className||"-"),f=b(t.className||t.currentGrade||t.unit);if(!g(K)||!n(f))return null;const u=s.get(d);return{id:d,slug:t.slug||M(t.name),name:t.name,grade:K,className:f||t.className,type:u?.type||t.type||"Universal Supports",tier:u?.tier||t.tier||"Tier 1",progress:u?.progress||t.progress||"Not Assigned",nextUpdate:u?.nextUpdate||t.nextUpdate||"Not scheduled",assignmentId:u?.assignmentId||null,profile:u?.profile||t.profile}}).filter(Boolean);return!o.length&&r.length?r:o},he=()=>{try{return JSON.parse(localStorage.getItem("auth_user")||"null")}catch{return null}};export{z as C,le as a,ge as b,de as c,ce as d,te as e,re as f,he as g,fe as h,b as i,se as j,ie as k,ne as l,ue as m,m as n,ae as o,oe as u};
