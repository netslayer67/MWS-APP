import{r as m,j as e,G as u,a6 as j}from"./index-4xPcSaBT.js";import{R as f}from"./CategoricalChart-C5G9NeyF.js";import{A as g,a as x}from"./AreaChart-C0Mh5yp3.js";import{C as N,X as b,T as C}from"./CartesianChart-C_n6pRxu.js";import{Y as y}from"./YAxis-Cu0WibJb.js";import"./ActivePoints-DGL0hbmG.js";const v=m.memo(({data:d={},period:h="week"})=>{const c=m.useMemo(()=>{if(!d?.recentActivity||d.recentActivity.length===0)return[];const s={};return d.recentActivity.forEach(a=>{const t=new Date(a.submittedAt).toLocaleDateString();s[t]||(s[t]={date:t,totalCheckins:0,moodCounts:{},weatherCounts:{},avgPresence:0,avgCapacity:0,presenceSum:0,capacitySum:0}),s[t].totalCheckins++,s[t].presenceSum+=a.presenceLevel,s[t].capacitySum+=a.capacityLevel,a.selectedMoods?.forEach(o=>{s[t].moodCounts[o]=(s[t].moodCounts[o]||0)+1});const r=a.weatherType;s[t].weatherCounts[r]=(s[t].weatherCounts[r]||0)+1}),Object.values(s).map(a=>({date:a.date,totalCheckins:a.totalCheckins,avgPresence:Math.round(a.presenceSum/a.totalCheckins*10)/10,avgCapacity:Math.round(a.capacitySum/a.totalCheckins*10)/10,topMood:Object.entries(a.moodCounts).sort(([,t],[,r])=>r-t)[0]?.[0]||"none",topMoodCount:Object.entries(a.moodCounts).sort(([,t],[,r])=>r-t)[0]?.[1]||0,topWeather:Object.entries(a.weatherCounts).sort(([,t],[,r])=>r-t)[0]?.[0]||"none",topWeatherCount:Object.entries(a.weatherCounts).sort(([,t],[,r])=>r-t)[0]?.[1]||0,moodDistribution:a.moodCounts,weatherDistribution:a.weatherCounts})).sort((a,t)=>new Date(a.date)-new Date(t.date))},[d]),i=m.useMemo(()=>{if(c.length===0)return null;const s={},n={};c.forEach(r=>{Object.entries(r.moodDistribution).forEach(([o,l])=>{s[o]=(s[o]||0)+l}),Object.entries(r.weatherDistribution).forEach(([o,l])=>{n[o]=(n[o]||0)+l})});const a=Object.entries(s).sort(([,r],[,o])=>o-r).slice(0,3).map(([r,o])=>({mood:r,count:o})),t=Object.entries(n).sort(([,r],[,o])=>o-r).slice(0,3).map(([r,o])=>({weather:r,count:o}));return{topMoods:a,topWeather:t}},[c]),p=({active:s,payload:n,label:a})=>{if(s&&n&&n.length){const t=n[0].payload;return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:a}),e.jsxs("p",{className:"text-sm text-emerald-600",children:["Presence: ",t.avgPresence,"/10"]}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Capacity: ",t.avgCapacity,"/10"]}),e.jsxs("p",{className:"text-sm text-purple-600",children:["Check-ins: ",t.totalCheckins]}),e.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:["Top Mood: ",t.topMood," (",t.topMoodCount,")"]}),e.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:["Top Weather: ",t.topWeather," (",t.topWeatherCount,")"]})]})}return null};return c.length===0?e.jsxs("div",{className:"glass glass-card p-6 text-center",children:[e.jsx(u,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No trend data available for analysis"})]}):e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(j,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:"Mood & Weather Trends Analysis"})]}),i&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-card/40 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Mood"}),e.jsx("p",{className:"font-semibold text-foreground capitalize",children:i.topMoods[0]?.mood||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.topMoods[0]?.count||0," times"]})]}),e.jsxs("div",{className:"text-center p-3 bg-card/40 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Weather"}),e.jsx("p",{className:"font-semibold text-foreground capitalize",children:i.topWeather[0]?.weather||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.topWeather[0]?.count||0," times"]})]}),e.jsxs("div",{className:"text-center p-3 bg-card/40 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Check-ins/Day"}),e.jsx("p",{className:"font-semibold text-foreground",children:Math.round(c.reduce((s,n)=>s+n.totalCheckins,0)/c.length*10)/10})]}),e.jsxs("div",{className:"text-center p-3 bg-card/40 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trend Period"}),e.jsx("p",{className:"font-semibold text-foreground capitalize",children:h})]})]}),e.jsx("div",{className:"h-64 md:h-80 mb-6",children:e.jsx(f,{width:"100%",height:"100%",children:e.jsxs(g,{data:c,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"presenceGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"capacityGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})]}),e.jsx(N,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(b,{dataKey:"date",className:"text-xs",tick:{fill:"currentColor"},tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(y,{domain:[0,10],className:"text-xs",tick:{fill:"currentColor"}}),e.jsx(C,{content:e.jsx(p,{})}),e.jsx(x,{type:"monotone",dataKey:"avgPresence",stroke:"#10b981",fillOpacity:1,fill:"url(#presenceGradient)",strokeWidth:2,name:"Avg Presence"}),e.jsx(x,{type:"monotone",dataKey:"avgCapacity",stroke:"#3b82f6",fillOpacity:1,fill:"url(#capacityGradient)",strokeWidth:2,name:"Avg Capacity"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Daily Mood Patterns"}),e.jsx("div",{className:"space-y-2",children:c.slice(-7).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/20 rounded",children:[e.jsx("span",{className:"text-sm text-foreground",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:s.topMood}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary"})]})]},n))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Weather Patterns"}),e.jsx("div",{className:"space-y-2",children:c.slice(-7).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/20 rounded",children:[e.jsx("span",{className:"text-sm text-foreground",children:new Date(s.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:s.topWeather}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-secondary"})]})]},n))})]})]})]})]})});v.displayName="MoodTrendAnalysis";export{v as default};
