import{r as s,a as C,d as S,j as e,o as w,m as i,H as I,C as y,B as f,y as b}from"./index-BeQwOtyQ.js";import{T as A}from"./textarea-DOJHMy-6.js";import{A as M}from"./AnimatedPage-C0IhUWUM.js";import{S as E}from"./smile-DJldyzQg.js";import{M as T}from"./meh-Bb69F4_i.js";import{F as B}from"./frown-D5EpuXn-.js";import{C as v}from"./circle-x-C0NMzfRv.js";import{S as F}from"./save-D1LHQOhS.js";import{S as P}from"./send-6JRRJPNy.js";import{B as $}from"./brain-CmhU-ZHC.js";import{C as H}from"./camera-CVijIn_U.js";const L=[{icon:E,label:"Happy",value:"happy",color:"text-green-500"},{icon:I,label:"Excited",value:"excited",color:"text-red-500"},{icon:T,label:"Okay",value:"okay",color:"text-yellow-500"},{icon:B,label:"Sad",value:"sad",color:"text-blue-500"}],u=s.memo(({className:o,animate:n})=>e.jsx(i.div,{className:`absolute rounded-full blur-3xl ${o}`,animate:n?{scale:[1,1.1,1],opacity:[.3,.5,.3]}:{},transition:{duration:8,repeat:1/0,ease:"easeInOut"}})),O=o=>String(o||"").replace(/<[^>]*>?/gm,"").replace(/https?:\/\/\S+/g,"").replace(/(script|onerror|onload|data:|vbscript:)/gi,"").trim().slice(0,500),Y=s.memo(function(){const[n,h]=s.useState(null),[d,x]=s.useState(""),[m,p]=s.useState(!1),[a,j]=s.useState(null),[z,N]=s.useState(!0),g=C(),{toast:l}=S();s.useEffect(()=>{(async()=>{try{const r=await b.getTodayCheckinStatus();j(r.data.status)}catch(r){console.error("Failed to load check-in status:",r),l({title:"Error",description:"Failed to load check-in status. Please refresh the page.",variant:"destructive"})}finally{N(!1)}})()},[l]);const k=async()=>{if(n){p(!0);try{const t={weatherType:"sunny",selectedMoods:[n],details:d,presenceLevel:7,capacityLevel:7,supportContactUserId:"no_need",needsSupport:!1},c=(await b.submitCheckin(t)).data.data.checkin.id;l({title:"Check-in Successful",description:"Your manual check-in has been saved successfully!"}),setTimeout(()=>{console.log("Navigating to rating page after manual check-in submission:",c),g(`/emotional-checkin/rate/${c}`)},2e3),h(null),x("")}catch(t){console.error("Check-in submission failed:",t),l({title:"Check-in Failed",description:t.response?.data?.message||"Failed to save your check-in. Please try again.",variant:"destructive"})}finally{p(!1)}}};return e.jsxs(M,{children:[e.jsx(w,{children:e.jsx("title",{children:"Student Emotional Check-in â€” Kerjain"})}),e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsx(u,{className:"-top-40 -left-40 w-96 h-96 bg-primary/10",animate:!0}),e.jsx(u,{className:"-bottom-40 -right-40 w-80 h-80 bg-accent/10",animate:!0}),e.jsx(u,{className:"top-1/2 left-1/2 w-64 h-64 bg-gold/10",animate:!0}),e.jsx("div",{className:"absolute inset-0 bg-grid-small opacity-5 dark:opacity-10"}),e.jsx("div",{className:"container mx-auto px-4 py-8 relative z-10",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2 bg-clip-text text-transparent bg-gradient-to-r from-primary to-accent",children:"ðŸŒŸ How are you feeling today?"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your feelings matter! Share how you're doing so we can support you."})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"glass-strong rounded-2xl p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Select your mood"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:L.map(t=>{const r=t.icon,c=n===t.value;return e.jsxs(i.button,{whileTap:{scale:.95},onClick:()=>h(t.value),className:`p-4 rounded-xl border-2 transition-all duration-300 ${c?"border-primary bg-primary/10 shadow-lg":"border-border/40 bg-card/50 hover:border-border/60"}`,children:[e.jsx(r,{className:`w-8 h-8 mx-auto mb-2 ${t.color}`}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:t.label})]},t.value)})})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},className:"glass-strong rounded-2xl p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Share your thoughts (optional)"}),e.jsx(A,{value:d,onChange:t=>x(O(t.target.value)),placeholder:"What's on your mind today?",className:"min-h-[100px] resize-none transition-all duration-300",maxLength:500}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:[d.length,"/500 characters"]})]}),a&&e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.25},className:"glass-strong rounded-2xl p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Today's Check-in Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg ${a.hasManualCheckin?"bg-green-500/10 border border-green-500/30":"bg-muted/50 border border-border/40"}`,children:[a.hasManualCheckin?e.jsx(y,{className:"w-4 h-4 text-green-500"}):e.jsx(v,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-foreground",children:"Manual Check-in"})]}),e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg ${a.hasAICheckin?"bg-green-500/10 border border-green-500/30":"bg-muted/50 border border-border/40"}`,children:[a.hasAICheckin?e.jsx(y,{className:"w-4 h-4 text-green-500"}):e.jsx(v,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-medium text-foreground",children:"AI Analysis"})]})]})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{onClick:k,disabled:!n||m||a&&a.hasManualCheckin,className:"w-full bg-gradient-to-r from-primary to-accent text-primary-foreground hover-card transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:[m?e.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(P,{className:"w-4 h-4 mr-2"}),m?"Saving...":a?.hasManualCheckin?"Manual Check-in Completed":"Manual Check-in"]}),a?.hasManualCheckin&&e.jsx("p",{className:"text-xs text-green-600 text-center font-medium",children:"âœ… You have already completed manual check-in today"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 h-px bg-border"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"OR"}),e.jsx("div",{className:"flex-1 h-px bg-border"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(f,{onClick:()=>g("/emotional-checkin/face-scan"),disabled:a&&a.hasAICheckin,className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white hover:opacity-90 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",variant:"outline",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),e.jsx(H,{className:"w-4 h-4 mr-2"}),a?.hasAICheckin?"AI Analysis Completed":"AI Emotional Analysis"]}),a?.hasAICheckin&&e.jsx("p",{className:"text-xs text-green-600 text-center font-medium",children:"âœ… You have already completed AI analysis today"}),!a?.hasAICheckin&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Advanced AI facial analysis for accurate emotional insights"})]})]})]})})]})]})});Y.displayName="EmotionalCheckinPage";export{Y as default};
