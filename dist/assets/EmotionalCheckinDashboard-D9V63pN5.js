const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PrimaryNavButtons-BP1nQs5T.js","assets/index-CLT2i22S.js","assets/index-D2nyVmn2.css","assets/target-DUzh33rr.js","assets/DashboardHeader-B2U5fM0c.js","assets/utils-NGAVZCJh.js","assets/ContentSections-DUYKgcz9.js","assets/DecorativeElements-B_wrD7XM.js","assets/PerformanceMonitor-Xb9cLgJy.js"])))=>i.map(i=>d[i]);
import{c as B,r as a,j as e,X as U,T as W,C as A,a as Y,b as X,d as F,h as G,i as J,w as K,v as Q,U as E,V as y,W as Z,Y as ee,_ as D}from"./index-CLT2i22S.js";import{s as x}from"./socketService-B4WowktR.js";import{F as se}from"./funnel-ydcR4heg.js";import{U as ae}from"./users-B4Smd7PH.js";import{B as te}from"./building-Dn97F2ly.js";import{S as re}from"./shield-check-CZ57xY7y.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oe=B("triangle-alert",le),T=a.memo(({onFiltersChange:h,currentFilters:l={}})=>{const[n,r]=a.useState(!1),[m,b]=a.useState(l),v=[{value:"student",label:"Students"},{value:"staff",label:"Staff"},{value:"teacher",label:"Teachers"},{value:"admin",label:"Admins"},{value:"directorate",label:"Directorate"}],o=[{value:"Academic",label:"Academic"},{value:"Student Affairs",label:"Student Affairs"},{value:"Finance",label:"Finance"},{value:"HR",label:"Human Resources"},{value:"IT",label:"Information Technology"},{value:"Operations",label:"Operations"}],i=[{value:"happy",label:"Happy"},{value:"excited",label:"Excited"},{value:"calm",label:"Calm"},{value:"hopeful",label:"Hopeful"},{value:"tired",label:"Tired"},{value:"anxious",label:"Anxious"},{value:"sad",label:"Sad"},{value:"overwhelmed",label:"Overwhelmed"}],t=[{value:"sunny",label:"Sunny"},{value:"cloudy",label:"Cloudy"},{value:"rain",label:"Rain"},{value:"storm",label:"Storm"},{value:"tornado",label:"Tornado"},{value:"snow",label:"Snow"}],d=(s,j)=>{const u={...m};u[s]||(u[s]=[]),u[s].includes(j)?u[s]=u[s].filter(N=>N!==j):u[s].push(j),u[s].length===0&&delete u[s],b(u),h(u)},f=()=>{b({}),h({})},p=Object.values(m).reduce((s,j)=>s+j.length,0);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!n),className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors ${p>0?"bg-primary text-primary-foreground border-primary":"bg-card text-foreground border-border hover:bg-card/80"}`,children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Advanced Filters"}),p>0&&e.jsx("span",{className:"bg-destructive text-destructive-foreground text-xs px-2 py-1 rounded-full",children:p})]}),n&&e.jsxs("div",{className:"absolute top-full mt-2 right-0 z-50 w-96 bg-card border border-border rounded-xl shadow-2xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Filter Dashboard Data"}),e.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-muted rounded",children:e.jsx(U,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ae,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Role"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.role?.includes(s.value)||!1,onChange:()=>d("role",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(te,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Department"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:o.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.department?.includes(s.value)||!1,onChange:()=>d("department",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Moods"})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.mood?.includes(s.value)||!1,onChange:()=>d("mood",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Weather Types"})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.map(s=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.weather?.includes(s.value)||!1,onChange:()=>d("weather",s.value),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Support Status"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.needsSupport?.includes("true")||!1,onChange:()=>d("needsSupport","true"),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:"Needs Support"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m.needsSupport?.includes("false")||!1,onChange:()=>d("needsSupport","false"),className:"rounded border-border"}),e.jsx("span",{className:"text-sm text-foreground",children:"No Support Needed"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-border",children:[e.jsx("button",{onClick:f,className:"px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:"Clear All"}),e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Apply Filters"})]})]})]})});T.displayName="AdvancedFilters";const R=a.memo(({socketService:h,user:l})=>{const[n,r]=a.useState([]),[m,b]=a.useState(!1);a.useEffect(()=>{if(!h||!l)return;const t=p=>{const s={id:Date.now(),type:"info",title:"New Check-in Submitted",message:`${p.userName||"Someone"} just submitted their emotional check-in`,timestamp:new Date,icon:A,color:"text-blue-500",bgColor:"bg-blue-50",borderColor:"border-blue-200"};v(s)},d=p=>{const s={id:Date.now(),type:"warning",title:"Support Needed",message:`${p.userName} has indicated they need support`,timestamp:new Date,icon:oe,color:"text-red-500",bgColor:"bg-red-50",borderColor:"border-red-200"};v(s)},f=p=>{const s={id:Date.now(),type:"success",title:"Dashboard Updated",message:"New data has been added to the dashboard",timestamp:new Date,icon:A,color:"text-green-500",bgColor:"bg-green-50",borderColor:"border-green-200"};v(s)};return h.onNewCheckin(t),h.onUserFlagged(d),h.onDashboardUpdate(f),()=>{h.offNewCheckin(t),h.offUserFlagged(d),h.offDashboardUpdate(f)}},[h,l]);const v=t=>{r(d=>[t,...d].slice(0,10)),b(!0),setTimeout(()=>{b(!1)},5e3)},o=t=>{r(d=>d.filter(f=>f.id!==t)),n.length<=1&&b(!1)},i=()=>{r([]),b(!1)};return n.length===0?null:e.jsxs("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs("button",{onClick:()=>b(!m),className:"relative p-2 bg-primary text-primary-foreground rounded-full shadow-lg hover:bg-primary/90 transition-colors",children:[e.jsx(W,{className:"w-4 h-4"}),n.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs rounded-full w-5 h-5 flex items-center justify-center",children:n.length})]})}),m&&e.jsxs("div",{className:"glass glass-card shadow-2xl max-h-96 overflow-hidden",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Notifications"}),e.jsx("button",{onClick:i,className:"text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Clear all"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto",children:n.map(t=>{const d=t.icon;return e.jsx("div",{className:`p-4 border-b border-border/50 last:border-b-0 ${t.bgColor} transition-all duration-300`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(d,{className:`w-4 h-4 mt-0.5 ${t.color}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:t.title}),e.jsx("button",{onClick:()=>o(t.id),className:"ml-2 p-1 rounded transition-colors hover:bg-secondary/25",children:e.jsx(U,{className:"w-3 h-3 text-muted-foreground"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:t.timestamp.toLocaleTimeString()})]})]})},t.id)})}),e.jsx("div",{className:"p-3 bg-muted/20 border-t border-border",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Real-time updates active"})})]})]})]})});R.displayName="RealTimeNotifications";a.lazy(()=>D(()=>import("./PrimaryNavButtons-BP1nQs5T.js"),__vite__mapDeps([0,1,2,3])));const de=a.lazy(()=>D(()=>import("./DashboardHeader-B2U5fM0c.js"),__vite__mapDeps([4,1,2,5]))),ne=a.lazy(()=>D(()=>import("./ContentSections-DUYKgcz9.js"),__vite__mapDeps([6,1,2]))),ie=a.lazy(()=>D(()=>import("./DecorativeElements-B_wrD7XM.js"),__vite__mapDeps([7,1,2]))),ce=a.lazy(()=>D(()=>import("./PerformanceMonitor-Xb9cLgJy.js"),__vite__mapDeps([8,1,2]))),O=a.memo(function(){const l=Y(),n=X(),{user:r}=F(c=>c.auth),{stats:m,loading:b,error:v,selectedPeriod:o,selectedDate:i}=F(c=>c.dashboard),[t,d]=a.useState(i),f=a.useMemo(()=>G(r),[r]),p=a.useMemo(()=>J(r),[r]),s=a.useMemo(()=>K(r),[r]),j=Q(r),u=f==="head_unit",N=["directorate","admin","superadmin"].includes(f||""),[me,I]=a.useState(!1),[P,z]=a.useState({}),C=a.useRef(!1);a.useEffect(()=>{const c=setTimeout(()=>I(!0),100);return()=>clearTimeout(c)},[]),a.useEffect(()=>{d(i)},[i]),a.useEffect(()=>{if(r){if(p){if(N&&o==="today"&&!C.current){C.current=!0,l(E("all"));return}console.log("Fetching dashboard stats for period:",o,"User:",r),l(y({period:o,date:i})),x.connect(),x.joinDashboard(r.id);const c=g=>{console.log("Real-time dashboard update:",g),l(y({period:o,date:i}))},k=g=>{console.log("New check-in received:",g),l(y({period:o,date:i,force:!0})),console.log("Dashboard updated with new check-in data")},_=g=>{console.log("User flagged for support:",g)},S=g=>{console.log("Support request handled, removing from flagged users:",g),l(ee(g))};return x.onDashboardUpdate(c),x.onNewCheckin(k),x.onUserFlagged(_),x.onSupportRequestHandled(S),()=>{x.offDashboardUpdate(c),x.offNewCheckin(k),x.offUserFlagged(_),x.offSupportRequestHandled(S),x.leaveDashboard()}}console.log("User not authorized for dashboard:",{user:r}),n("/support-hub",{replace:!0})}},[p,l,N,n,o,i,r]);const L=a.useCallback(c=>{l(E(c))},[l]),M=a.useCallback(c=>{z(c),l(y({period:o,date:i,filters:c}))},[l,i,o]);a.useCallback(()=>{n("/mtss")},[n]),a.useCallback(()=>{n("/support-hub")},[n]);const w=a.memo(()=>e.jsxs("div",{className:"glass glass-card",children:[e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted/30 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-2/3"})]})]}));w.displayName="LoadingFallback";const H=a.useMemo(()=>typeof window<"u"?window.innerWidth<768:!1,[]),V=a.useCallback(c=>{d(c)},[]),$=a.useCallback(()=>{t&&(l(Z(t)),l(y({period:o,date:t})))},[l,t,o]),q=a.useMemo(()=>o==="all"||!t?!0:t===i,[t,i,o]);return e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsx(a.Suspense,{fallback:null,children:e.jsx(ie,{isMobile:H})}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[j&&s&&e.jsxs("div",{className:"glass glass-card p-4 mb-4 flex items-start gap-3 border border-amber-200/70 bg-amber-50/70 dark:bg-amber-500/10",children:[e.jsx(re,{className:"w-5 h-5 text-amber-600 dark:text-amber-300 mt-0.5"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Delegated dashboard access"}),e.jsxs("p",{children:["You're viewing the Emotional Check-in Dashboard with the same visibility as"," ",e.jsx("span",{className:"font-medium text-foreground",children:s.delegatedFromName||s.delegatedFromEmail||"the assigned directorate lead"}),". All actions remain logged under your account."]})]})]}),e.jsx(a.Suspense,{fallback:e.jsx(w,{}),children:e.jsx(de,{selectedPeriod:o,onPeriodChange:L,selectedDate:t,onDateChange:V,onApplyDate:$,isApplyDisabled:q,isHeadUnit:u,userUnit:r?.unit||r?.department,isDirectorate:N})}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(T,{onFiltersChange:M,currentFilters:P})}),e.jsx(a.Suspense,{fallback:e.jsx(w,{})}),m?e.jsx(a.Suspense,{fallback:e.jsx(w,{}),children:e.jsx(ne,{realData:m,loading:b,selectedPeriod:o,userId:r?.id,isHeadUnit:u,isDirectorate:N})}):e.jsx(w,{})]}),e.jsx(R,{socketService:x,user:r}),e.jsx(a.Suspense,{fallback:null,children:e.jsx(ce,{})})]})});O.displayName="EmotionalCheckinDashboard";const ge=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}));export{ge as E,oe as T};
