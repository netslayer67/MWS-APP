import{c as b,r as i,j as e,Q as N,T as A}from"./index-BeQwOtyQ.js";import{a as R,R as _}from"./CategoricalChart-BMqhUz2Q.js";import{C as S,a as L,X as Y,Y as E,T as I}from"./CartesianChart-BRX7XIZz.js";import{B as C}from"./barSelectors-cWraKwqT.js";import"./tooltipContext-DiIpVtEU.js";import"./ErrorBarContext-BLoWLUfG.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M5 12h14",key:"1ays0h"}]],W=b("minus",K);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],$=b("trending-down",F);var B=["axis"],X=i.forwardRef((d,x)=>i.createElement(S,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:B,tooltipPayloadSearcher:R,categoricalChartProps:d,ref:x}));const q=i.memo(({data:d={},currentPeriod:x="today"})=>{const[z,G]=i.useState("week"),[o,w]=i.useState("period-over-period"),t=i.useMemo(()=>{if(!d?.recentActivity||d.recentActivity.length===0)return null;const r=d.recentActivity,s=new Date,n={"day-over-day":{current:{start:new Date(s.getTime()-1440*60*1e3),end:s},previous:{start:new Date(s.getTime()-2880*60*1e3),end:new Date(s.getTime()-1440*60*1e3)}},"week-over-week":{current:{start:new Date(s.getTime()-10080*60*1e3),end:s},previous:{start:new Date(s.getTime()-336*60*60*1e3),end:new Date(s.getTime()-10080*60*1e3)}},"month-over-month":{current:{start:new Date(s.getFullYear(),s.getMonth(),1),end:s},previous:{start:new Date(s.getFullYear(),s.getMonth()-1,1),end:new Date(s.getFullYear(),s.getMonth(),0)}}}[o];if(!n)return null;const P=r.filter(a=>{const c=new Date(a.submittedAt);return c>=n.current.start&&c<=n.current.end}),k=r.filter(a=>{const c=new Date(a.submittedAt);return c>=n.previous.start&&c<=n.previous.end}),y=a=>{if(a.length===0)return{count:0,avgPresence:0,avgCapacity:0,supportRate:0};const c=a.reduce((m,h)=>m+h.presenceLevel,0),M=a.reduce((m,h)=>m+h.capacityLevel,0),D=a.filter(m=>m.needsSupport).length;return{count:a.length,avgPresence:Math.round(c/a.length*10)/10,avgCapacity:Math.round(M/a.length*10)/10,supportRate:Math.round(D/a.length*100)}},l=y(P),u=y(k),p=(a,c)=>c===0?a>0?100:0:Math.round((a-c)/c*100);return{current:{...l,period:o==="day-over-day"?"Today":o==="week-over-week"?"This Week":"This Month"},previous:{...u,period:o==="day-over-day"?"Yesterday":o==="week-over-week"?"Last Week":"Last Month"},changes:{count:p(l.count,u.count),avgPresence:p(l.avgPresence,u.avgCapacity),avgCapacity:p(l.avgCapacity,u.avgCapacity),supportRate:p(l.supportRate,u.supportRate)}}},[d,o]),v=i.useMemo(()=>t?[{metric:"Check-ins",current:t.current.count,previous:t.previous.count,change:t.changes.count},{metric:"Avg Presence",current:t.current.avgPresence,previous:t.previous.avgPresence,change:t.changes.avgPresence},{metric:"Avg Capacity",current:t.current.avgCapacity,previous:t.previous.avgCapacity,change:t.changes.avgCapacity},{metric:"Support Rate %",current:t.current.supportRate,previous:t.previous.supportRate,change:t.changes.supportRate}]:[],[t]),g=r=>r>0?e.jsx(A,{className:"w-3 h-3 text-green-500"}):r<0?e.jsx($,{className:"w-3 h-3 text-red-500"}):e.jsx(W,{className:"w-3 h-3 text-gray-500"}),f=r=>r>0?"text-green-600":r<0?"text-red-600":"text-gray-600",T=({active:r,payload:s,label:j})=>{if(r&&s&&s.length){const n=s[0].payload;return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:j}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Current: ",n.current]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Previous: ",n.previous]}),e.jsxs("p",{className:`text-sm font-medium ${f(n.change)}`,children:["Change: ",n.change>0?"+":"",n.change,"%"]})]})}return null};return t?e.jsxs("div",{className:"glass glass-card transition-all duration-300",children:[e.jsx("div",{className:"glass__refract"}),e.jsx("div",{className:"glass__noise"}),e.jsxs("div",{className:"relative z-10 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-primary"}),e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:"Comparative Analysis"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:o,onChange:r=>w(r.target.value),className:"px-3 py-1 text-sm bg-card border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"day-over-day",children:"Day over Day"}),e.jsx("option",{value:"week-over-week",children:"Week over Week"}),e.jsx("option",{value:"month-over-month",children:"Month over Month"})]})})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:v.map((r,s)=>e.jsxs("div",{className:"glass glass-card p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:r.metric}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-foreground",children:r.current}),e.jsxs("div",{className:`flex items-center gap-1 text-xs ${f(r.change)}`,children:[g(r.change),e.jsxs("span",{children:[r.change>0?"+":"",r.change,"%"]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["vs ",r.previous," prev"]})]},s))}),e.jsx("div",{className:"h-64 md:h-80 mb-6",children:e.jsx(_,{width:"100%",height:"100%",children:e.jsxs(X,{data:v,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(L,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(Y,{dataKey:"metric",className:"text-xs",tick:{fill:"currentColor"}}),e.jsx(E,{className:"text-xs",tick:{fill:"currentColor"}}),e.jsx(I,{content:e.jsx(T,{})}),e.jsx(C,{dataKey:"current",fill:"#3b82f6",radius:[2,2,0,0],name:"Current Period"}),e.jsx(C,{dataKey:"previous",fill:"#e5e7eb",radius:[2,2,0,0],name:"Previous Period"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Key Insights"}),e.jsxs("div",{className:"space-y-2",children:[t.changes.count!==0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-card/40 rounded",children:[g(t.changes.count),e.jsxs("span",{className:"text-sm text-foreground",children:["Check-in volume ",t.changes.count>0?"increased":"decreased"," by ",Math.abs(t.changes.count),"%"]})]}),t.changes.avgPresence!==0&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-card/40 rounded",children:[g(t.changes.avgPresence),e.jsxs("span",{className:"text-sm text-foreground",children:["Team presence ",t.changes.avgPresence>0?"improved":"declined"," by ",Math.abs(t.changes.avgPresence),"%"]})]}),t.changes.supportRate>10&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 rounded",children:[e.jsx(AlertTriangle,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:"text-sm text-red-700",children:["Support requests increased by ",t.changes.supportRate,"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Period Comparison"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-card/20 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:t.current.period}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.current.count," check-ins"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-card/20 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:t.previous.period}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.previous.count," check-ins"]})]})]})]})]})]})]}):e.jsxs("div",{className:"glass glass-card p-6 text-center",children:[e.jsx(N,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Insufficient data for comparative analysis"})]})});q.displayName="ComparativeAnalysis";export{q as default};
