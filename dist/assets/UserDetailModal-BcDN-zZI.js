import{c as k,r as n,b as T,aV as P,j as e,U as M,X as L,Q as W,a0 as h,T as D}from"./index-BbI_y0ug.js";import{T as u}from"./EmotionalCheckinDashboard-CKyxXx8k.js";import{R as U}from"./CategoricalChart-DeOqwc46.js";import{L as A,a as p}from"./LineChart-QRAW8dAR.js";import{C as E,X as F,T as q}from"./CartesianChart-DeKkCZ2O.js";import{Y as R}from"./YAxis-CxQEuk6W.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],O=k("external-link",z),$=n.memo(({user:a,isOpen:o,onClose:g})=>{const f=T(),[t,c]=n.useState(null),[j,x]=n.useState(!1),[i,N]=n.useState("month");n.useEffect(()=>{o&&a?.id&&b()},[o,a,i]);const b=async()=>{if(a?.id){x(!0);try{console.log("Fetching trends for user:",a.id,"period:",i);const s=await P(a.id,i);console.log("User trends response:",s.data),c(s.data?.data||s.data)}catch(s){console.error("Error fetching user trends:",s),c(null)}finally{x(!1)}}},d=n.useMemo(()=>{if(t?.summary)return t.summary;if(a?.periodSummary){const s=a.periodSummary.submissions||0,r=a.periodSummary.needsSupportDays||0;return{averagePresence:a.periodSummary.avgPresence||0,averageCapacity:a.periodSummary.avgCapacity||0,supportNeededCount:r,emotionalStability:s?Math.max(0,1-r/s):null}}return null},[t?.summary,a?.periodSummary]);if(!o||!a)return null;const v=[a.role,a.department||a.unit].filter(Boolean).join(" â€¢ "),y=({active:s,payload:r,label:C})=>{if(s&&r&&r.length){const l=r[0]?.payload;return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 shadow-lg max-w-xs",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:new Date(C).toLocaleDateString()}),r.map((m,S)=>e.jsxs("p",{className:"text-sm",style:{color:m.color},children:[m.name,": ",m.value,"/10"]},S)),l&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-border/50",children:[l.selectedMoods&&l.selectedMoods.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Moods: ",l.selectedMoods.join(", ")]}),l.weatherType&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Weather: ",l.weatherType]}),l.needsSupport&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:"Support requested"})]})]})}return null},w=[{id:"week",label:"Week"},{id:"month",label:"Month"},{id:"semester",label:"Semester"}];return e.jsx("div",{className:"fixed inset-0 bg-foreground/70 dark:bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center",children:e.jsx(M,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:v||"Team member"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>f(`/emotional-wellness/${a.id}`),className:"flex items-center gap-2 px-3 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors text-sm",title:"View full individual report",children:[e.jsx(O,{className:"w-4 h-4"}),"Full Report"]}),e.jsx("button",{onClick:g,className:"p-2 hover:bg-muted rounded-lg transition-colors",title:"Close modal",children:e.jsx(L,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)] space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(W,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Period:"}),e.jsx("div",{className:"flex gap-1",children:w.map(s=>e.jsx("button",{onClick:()=>N(s.id),className:`px-3 py-1 text-xs rounded-full transition-colors ${i===s.id?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:s.label},s.id))})]}),d&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Avg Presence"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[Number(d.averagePresence||0).toFixed(1),"/10"]})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(D,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Avg Capacity"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[Number(d.averageCapacity||0).toFixed(1),"/10"]})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Support Needed"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[d.supportNeededCount||0," times"]})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Emotional Stability"})]}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:[d.emotionalStability?(d.emotionalStability*100).toFixed(0):0,"%"]})]})]}),t&&t.summary&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground mb-3",children:"Mood Patterns"}),t.summary.moodPatterns&&Object.keys(t.summary.moodPatterns).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(t.summary.moodPatterns).sort(([,s],[,r])=>r-s).slice(0,5).map(([s,r])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${r/Math.max(...Object.values(t.summary.moodPatterns))*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground w-6 text-right",children:r})]})]},s))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No mood data available"})]}),e.jsxs("div",{className:"glass glass-card p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground mb-3",children:"Weather Patterns"}),t.summary.weatherPatterns&&Object.keys(t.summary.weatherPatterns).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(t.summary.weatherPatterns).sort(([,s],[,r])=>r-s).slice(0,5).map(([s,r])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:s.replace("-"," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${r/Math.max(...Object.values(t.summary.weatherPatterns))*100}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground w-6 text-right",children:r})]})]},s))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No weather data available"})]})]}),t&&t.summary&&t.summary.insights&&t.summary.insights.length>0&&e.jsxs("div",{className:"glass glass-card p-4 mb-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-foreground mb-3",children:"AI Insights"}),e.jsx("div",{className:"space-y-2",children:t.summary.insights.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-muted/20 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-foreground",children:s})]},r))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Emotional Trends"}),j?e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading trends..."})}):t?.trends&&t.trends.length>0?e.jsx("div",{className:"h-64",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(A,{data:t.trends,children:[e.jsx(E,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(F,{dataKey:"date",className:"text-xs",tick:{fill:"currentColor"},tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(R,{domain:[0,10],className:"text-xs",tick:{fill:"currentColor"}}),e.jsx(q,{content:e.jsx(y,{})}),e.jsx(p,{type:"monotone",dataKey:"presenceLevel",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2},name:"Presence"}),e.jsx(p,{type:"monotone",dataKey:"capacityLevel",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2},name:"Capacity"})]})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-40 flex items-center justify-center text-sm text-muted-foreground bg-muted/20 rounded-lg",children:"No trend data available for this period."}),a.lastCheckin?e.jsxs("div",{className:"rounded-lg border border-border/60 p-4 bg-card/40",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground mb-2",children:"Latest check-in"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:new Date(a.lastCheckin.date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Presence: ",a.lastCheckin.presenceLevel,"/10"]}),e.jsxs("span",{children:["Capacity: ",a.lastCheckin.capacityLevel,"/10"]}),a.lastCheckin.weatherType&&e.jsx("span",{children:a.lastCheckin.weatherType}),a.lastCheckin.moods?.length>0&&e.jsxs("span",{children:["Moods: ",a.lastCheckin.moods.slice(0,3).join(", ")]})]})]}):e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"This team member has not submitted any check-ins in the selected period."})]})]}),t?.weeklyAverages&&t.weeklyAverages.length>0&&e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Weekly Emotional Trends"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:t.weeklyAverages.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-card/40 rounded-lg border border-border/40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-lg",children:s.dominantWeather==="sunny"?"â˜€ï¸":s.dominantWeather==="cloudy"?"â˜ï¸":s.dominantWeather==="rain"?"ðŸŒ§ï¸":s.dominantWeather==="storm"?"â›ˆï¸":s.dominantWeather==="tornado"?"ðŸŒªï¸":"â„ï¸"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-foreground",children:["Week of ",s.week]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.dominantMoods?.join(", ")," â€¢ ",s.checkinCount," check-ins"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["P: ",s.avgPresence,"/10"]}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["C: ",s.avgCapacity,"/10"]})]})]},r))})]}),t?.trends&&t.trends.length>0&&e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-4",children:"Recent Check-ins"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:t.trends.slice(-10).reverse().map((s,r)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-card/40 rounded-lg border border-border/40",children:[e.jsx("div",{className:"text-lg flex-shrink-0",children:s.weatherType==="sunny"?"â˜€ï¸":s.weatherType==="cloudy"?"â˜ï¸":s.weatherType==="rain"?"ðŸŒ§ï¸":s.weatherType==="storm"?"â›ˆï¸":s.weatherType==="tornado"?"ðŸŒªï¸":"â„ï¸"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"font-medium text-foreground",children:new Date(s.date).toLocaleDateString()}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["P: ",s.presenceLevel,"/10"]}),e.jsxs("p",{className:"text-sm font-medium text-foreground",children:["C: ",s.capacityLevel,"/10"]})]})]}),s.selectedMoods&&s.selectedMoods.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Moods: ",s.selectedMoods.join(", ")]}),s.details&&e.jsxs("p",{className:"text-sm text-foreground italic",children:['"',s.details.length>100?s.details.substring(0,100)+"...":s.details,'"']}),s.needsSupport&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:[e.jsx(u,{className:"w-3 h-3 mr-1"}),"Support requested"]})})]})]},r))})]})]})]})})});$.displayName="UserDetailModal";export{$ as U};
