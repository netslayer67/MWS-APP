import{e as P,r as i,j as e,aQ as L,aR as $,aS as D,aT as O,aY as q,aZ as F,x as M,m as B}from"./index-Cnj6MzVP.js";import{d as H}from"./mtssService-uugoVs1o.js";import{S as V}from"./search-B1o0cIR0.js";const z=[{label:"Tier 2 - Targeted",value:"tier2"},{label:"Tier 3 - Intensive",value:"tier3"}],T=({open:b,onClose:f,mentor:x,students:h=[],onAssigned:w})=>{const{toast:N}=P(),[S,A]=i.useState("tier2"),[n,o]=i.useState(""),[l,v]=i.useState([]),[u,g]=i.useState(""),[j,m]=i.useState(""),[p,_]=i.useState(!1);i.useEffect(()=>{b||(v([]),g(""),m(""),o(""),A("tier2"))},[b]);const t=i.useMemo(()=>{const s=n.trim().toLowerCase();return s?h.filter(d=>d.name?.toLowerCase().includes(s)):h},[h,n]),a=s=>{v(d=>d.includes(s)?d.filter(k=>k!==s):[...d,s])},r=i.useMemo(()=>h.filter(s=>l.includes(s.id||s._id)),[h,l]),c=async s=>{if(s.preventDefault(),!(!x?._id||l.length<2)){_(!0);try{const d=u?u.split(",").map(k=>k.trim()).filter(Boolean):[];await H({mentorId:x._id,studentIds:l,tier:S,focusAreas:d,notes:j?.trim()||""}),N({title:"Assignment created",description:`Paired ${x.name} with ${l.length} students.`}),w?.()}catch(d){N({title:"Failed to assign",description:d?.response?.data?.message||d.message||"Unable to create assignment",variant:"destructive"})}finally{_(!1)}}};return e.jsx(L,{open:b,onOpenChange:s=>!s&&f?.(),children:e.jsx($,{className:"max-w-3xl border-none bg-transparent p-0",children:e.jsxs("div",{className:"rounded-[32px] glass glass-card overflow-hidden",children:[e.jsxs(D,{className:"bg-gradient-to-r from-[#f472b6] via-[#a855f7] to-[#6366f1] px-6 py-5 text-white",children:[e.jsx(O,{className:"text-2xl font-black tracking-tight",children:"Assign students"}),e.jsxs(q,{className:"text-white/80",children:["Pair ",e.jsx("strong",{children:x?.name})," with collaborative Tier 2/3 groups. At least two students are required."]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3 text-sm font-semibold",children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-white/20 backdrop-blur text-white",children:x?.jobPosition||x?.role||"Teacher"}),e.jsxs("span",{className:"px-3 py-1 rounded-full bg-white/20 backdrop-blur text-white",children:[l.length," selected"]})]})]}),e.jsxs("form",{onSubmit:c,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsxs("span",{className:"flex items-center justify-between uppercase tracking-[0.3em] text-[11px] text-muted-foreground",children:["Tier ",e.jsx("span",{className:"text-[10px] text-white/70 bg-primary/70 px-2 py-0.5 rounded-full",children:"Required"})]}),e.jsx("select",{value:S,onChange:s=>A(s.target.value),className:"w-full rounded-2xl border border-border/50 bg-white/90 dark:bg-white/10 px-4 py-3 focus:ring-2 focus:ring-primary/40",children:z.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsxs("span",{className:"flex items-center justify-between uppercase tracking-[0.3em] text-[11px] text-muted-foreground",children:["Focus areas ",e.jsx("span",{className:"text-[10px] text-muted-foreground px-2 py-0.5 rounded-full border border-border/40",children:"Optional"})]}),e.jsx("input",{value:u,onChange:s=>g(s.target.value),placeholder:"Fluency boost, SEL routines",className:"w-full rounded-2xl border border-border/50 bg-white/90 dark:bg-white/10 px-4 py-3 focus:ring-2 focus:ring-primary/40"})]})]}),e.jsxs("label",{className:"space-y-2 text-sm font-semibold text-foreground dark:text-white",children:[e.jsxs("span",{className:"flex items-center justify-between uppercase tracking-[0.3em] text-[11px] text-muted-foreground",children:["Notes ",e.jsx("span",{className:"text-[10px] text-muted-foreground px-2 py-0.5 rounded-full border border-border/40",children:"Optional"})]}),e.jsx("textarea",{value:j,onChange:s=>m(s.target.value),placeholder:"Add optional context or next steps for this mentor...",className:"w-full h-24 rounded-2xl border border-border/50 bg-white/90 dark:bg-white/10 px-4 py-3 resize-none focus:ring-2 focus:ring-primary/40"})]}),r.length>0&&e.jsxs("div",{className:"rounded-[24px] bg-gradient-to-r from-[#e0f2fe]/80 to-[#fef9c3]/70 dark:from-white/5 dark:to-white/5 border border-white/40 dark:border-white/5 p-4 flex flex-wrap gap-2 text-sm","data-aos":"fade-up","data-aos-delay":"250",children:[r.slice(0,6).map(s=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-white/70 dark:bg-white/10 border border-white/60 dark:border-white/20 text-foreground dark:text-white",children:s.name},s.id||s._id)),r.length>6&&e.jsxs("span",{className:"px-3 py-1 rounded-full bg-white/60 dark:bg-white/10 border border-white/40 dark:border-white/20 text-muted-foreground",children:["+",r.length-6," more"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-foreground dark:text-white",children:"Choose at least two students for this mentor"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use the search to quickly filter by name or focus type."})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",value:n,onChange:s=>o(s.target.value),placeholder:"Search students...",className:"w-full pl-10 pr-4 py-2.5 rounded-full border border-border/60 bg-white/90 dark:bg-white/10 text-sm focus:ring-2 focus:ring-primary/40"})]})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto rounded-2xl border border-border/50 bg-white/90 dark:bg-white/10 p-4 space-y-2 custom-scroll","data-aos":"fade-up","data-aos-delay":"300",children:[t.map(s=>{const d=s.id||s._id;return e.jsxs("label",{className:"flex items-center gap-3 text-sm text-foreground dark:text-white",children:[e.jsx("input",{type:"checkbox",checked:l.includes(d),onChange:()=>a(d),className:"rounded border-border/60 accent-primary"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold",children:s.name}),e.jsxs("span",{className:"text-muted-foreground text-xs",children:[s.grade," · ",s.type]})]})]},d)}),!t.length&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No students match the search."})]})]}),e.jsxs(F,{className:"pt-4",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 rounded-full border border-border/60 text-sm font-semibold text-foreground dark:text-white bg-white/70 dark:bg-white/5 hover:shadow",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:p||l.length<2,className:`px-5 py-2.5 rounded-full text-sm font-semibold text-white ${p||l.length<2?"bg-muted cursor-not-allowed opacity-60":"bg-gradient-to-r from-[#22d3ee] via-[#3b82f6] to-[#a855f7] shadow-xl hover:-translate-y-0.5 transition"}`,children:p?"Assigning…":"Assign Selected"})]})]})]})})})};T.displayName="AdminMentorAssignModal";const K=["teacher","homeroom","subject","special"],C=[{glass:"from-[#fdf2f8]/95 via-[#f5f3ff]/70 to-[#e0f2fe]/80 dark:from-white/10 dark:via-white/5 dark:to-[#0f172a]/60",accent:"from-[#ec4899] via-[#f97316] to-[#facc15]",tag:"from-[#ffe4e6]/85 via-[#fef3c7]/80 to-[#dbeafe]/80 text-rose-600",halo:"from-[#f472b6]/35 via-[#fef08a]/25 to-transparent"},{glass:"from-[#e0f2fe]/95 via-[#ccfbf1]/70 to-[#f5f5ff]/80 dark:from-[#0f172a]/70 dark:via-[#0b1220]/70 dark:to-[#111827]/80",accent:"from-[#3b82f6] via-[#22d3ee] to-[#a855f7]",tag:"from-[#bae6fd]/80 via-[#ccfbf1]/80 to-[#ede9fe]/80 text-sky-700",halo:"from-[#22d3ee]/30 via-[#6366f1]/30 to-transparent"},{glass:"from-[#fff7ed]/95 via-[#fef9c3]/70 to-[#e0f2fe]/80 dark:from-[#1f2937]/80 dark:via-[#0f172a]/80 dark:to-[#0f172a]/60",accent:"from-[#f97316] via-[#facc15] to-[#4ade80]",tag:"from-[#ffedd5]/90 via-[#fef3c7]/80 to-[#e0f2fe]/80 text-amber-700",halo:"from-[#fb923c]/30 via-[#fde047]/25 to-transparent"},{glass:"from-[#ede9fe]/95 via-[#e0f2fe]/70 to-[#fef3c7]/80 dark:from-[#0f172a]/70 dark:via-[#111827]/70 dark:to-[#1f2937]/70",accent:"from-[#a855f7] via-[#ec4899] to-[#f472b6]",tag:"from-[#ddd6fe]/90 via-[#f9a8d4]/80 to-[#fef3c7]/80 text-fuchsia-700",halo:"from-[#c084fc]/35 via-[#fb7185]/25 to-transparent"}],R=["fade-up","zoom-in","flip-left","fade-up-right","zoom-out-up","fade-up-left"],y=9,E=({mentorRoster:b=[],mentorDirectory:f=[],students:x=[],onRefresh:h})=>{const w=t=>(t?._id||t?.id||t?.email||t?.name||"").toString().toLowerCase(),N=t=>{const a=(t.jobPosition||"").toLowerCase(),r=(t.role||"").toLowerCase(),c=Array.isArray(t.classes)?t.classes.some(s=>(s.role||"").toLowerCase().includes("teacher")):!1;return K.some(s=>a.includes(s))||c||r.includes("teacher")},S=f.filter(N),A=new Map(b.map(t=>[w(t),{activeStudents:t.activeStudents||t.students||0,successRate:t.successRate||"0%"}])),n=new Map;S.forEach(t=>{const a=w(t),r=A.get(a)||{activeStudents:0,successRate:"0%"};n.set(a,{_id:t._id||t.id||null,name:t.name,role:t.jobPosition||t.role||"Teacher",activeStudents:r.activeStudents,successRate:r.successRate})}),b.forEach(t=>{const a=w(t),r=n.get(a);n.set(a,{_id:t._id||t.id||n.get(a)?._id||null,name:t.name,role:t.role||r?.role||"Teacher",activeStudents:t.activeStudents||t.students||r?.activeStudents||0,successRate:t.successRate||r?.successRate||"0%"})});const o=Array.from(n.values()).sort((t,a)=>t.name.localeCompare(a.name)),[l,v]=i.useState(y),u=i.useRef(null);i.useEffect(()=>{v(y)},[o.length]),i.useEffect(()=>{if(!u.current)return;const t=new IntersectionObserver(a=>{const[r]=a;r.isIntersecting&&v(c=>c>=o.length?c:Math.min(o.length,c+y))},{threshold:.4});return t.observe(u.current),()=>t.disconnect()},[o.length]);const g=i.useMemo(()=>o.slice(0,Math.min(l,o.length)),[o,l]),[j,m]=i.useState(null),p=i.useMemo(()=>f.find(t=>t._id===j),[f,j]),_=i.useCallback(t=>{if(t._id){m(t._id);return}const a=f.find(r=>r.name===t.name);a?._id&&m(a._id)},[f]);return e.jsx("div",{className:"space-y-8","data-aos":"fade-up","data-aos-delay":"100",children:e.jsxs("div",{className:"glass glass-card mtss-card-surface p-8 rounded-[40px] shadow-[0_30px_90px_rgba(15,23,42,0.32)] border border-white/10 bg-gradient-to-br from-white/80 via-white/60 to-white/40 dark:from-white/5 dark:via-white/10 dark:to-white/5 backdrop-blur-2xl",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-8","data-aos":"fade-up","data-aos-delay":"150",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 px-4 py-2 rounded-full bg-gradient-to-r from-[#e0f2fe] via-[#fef3c7] to-[#fbcfe8] text-sm font-semibold text-slate-700 dark:text-white shadow-inner",children:[e.jsx(M,{className:"w-4 h-4 text-rose-500"}),"Mentor Squad"]}),e.jsxs("div",{className:"rounded-[28px] bg-gradient-to-r from-white/95 via-white/70 to-white/40 dark:from-white/10 dark:via-white/5 dark:to-white/5 p-5 border border-white/60 dark:border-white/10 shadow-inner backdrop-blur-xl space-y-2",children:[e.jsx("h3",{className:"text-3xl font-black text-foreground dark:text-white bg-gradient-to-r from-[#14b8a6] via-[#3b82f6] to-[#a855f7] text-transparent bg-clip-text",children:"Manage Mentors"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-white/70 max-w-2xl",children:"Assign caseloads, check success rates, and celebrate wins without losing the playful flow. Liquid-glass cards keep the data airy and joyful."}),e.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-[#fee2e2]/80 via-[#fef9c3]/80 to-[#cffafe]/80 dark:from-white/10 dark:via-white/5 dark:to-white/5 px-4 py-2 text-xs font-semibold text-rose-500 flex items-center gap-2 shadow-sm",children:[e.jsx(M,{className:"w-4 h-4"}),"Tap “Assign students” to pair mentors with multiple kids instantly."]})]})]}),e.jsx("button",{className:"px-5 py-3 rounded-full bg-gradient-to-r from-[#fde68a] via-[#fca5a5] to-[#f472b6] text-sm font-semibold text-rose-700 shadow-lg hover:-translate-y-0.5 transition border border-white/70",children:"Add Mentor"})]}),e.jsx("div",{className:"grid gap-5 lg:gap-6 md:grid-cols-2 xl:grid-cols-3","data-aos":"fade-up","data-aos-delay":"180",children:g.map((t,a)=>{const r=C[a%C.length],c=R[(a+2)%R.length],s=Number(t.activeStudents)||0,d=Number(String(t.successRate??"0").replace(/[^\d.]/g,""))||0,k=d>=85?"text-emerald-400":d>=60?"text-amber-400":"text-rose-400";return e.jsxs(B.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:a%y*.05},className:`relative group overflow-hidden rounded-[24px] border border-white/40 dark:border-white/5 p-5 shadow-[0_18px_55px_rgba(15,23,42,0.16)] backdrop-blur-xl bg-gradient-to-br ${r.glass}`,"data-aos":c,"data-aos-delay":200+a%y*60,"data-aos-duration":650+a%4*120,children:[e.jsx("div",{className:`absolute -top-14 right-3 w-32 h-32 bg-gradient-to-br ${r.halo} blur-3xl opacity-60 group-hover:opacity-80 transition`}),e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-15 group-hover:opacity-30 transition bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.35),_transparent_60%)]"}),e.jsxs("div",{className:"relative space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-2xl bg-white/85 text-slate-900 font-black flex items-center justify-center shadow-inner shadow-white/40",children:t.name.split(" ").map(I=>I[0]).slice(0,2).join("")}),e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-semibold text-slate-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-xs font-medium text-slate-600 dark:text-white/70",children:t.role})]})]}),e.jsx("div",{className:"text-[0.6rem] font-semibold uppercase tracking-[0.3em] text-slate-500 dark:text-white/60",children:e.jsx("span",{className:`px-3 py-1 rounded-full shadow-inner shadow-white/20 bg-gradient-to-r ${r.tag}`,children:"Trusted"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs font-semibold text-slate-600 dark:text-white/70",children:[e.jsxs("div",{className:"rounded-2xl border border-white/40 dark:border-white/10 px-3 py-3 bg-white/80 dark:bg-white/5 backdrop-blur text-center",children:[e.jsx("p",{className:"text-[0.55rem] uppercase tracking-[0.35em] text-slate-500 dark:text-white/60",children:"Active"}),e.jsx("p",{className:"text-2xl font-black text-slate-900 dark:text-white",children:s})]}),e.jsxs("div",{className:"rounded-2xl border border-white/40 dark:border-white/10 px-3 py-3 bg-white/80 dark:bg-white/5 backdrop-blur text-center",children:[e.jsx("p",{className:"text-[0.55rem] uppercase tracking-[0.35em] text-slate-500 dark:text-white/60",children:"Success"}),e.jsx("p",{className:`text-2xl font-black ${k}`,children:t.successRate})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-[0.65rem] font-semibold text-slate-600 dark:text-white/70",children:[e.jsx("span",{className:"px-3 py-1 rounded-full border border-white/60 dark:border-white/20 bg-white/80 dark:bg-white/5",children:s>=12?"High load":"Balanced load"}),e.jsx("span",{className:"px-3 py-1 rounded-full border border-white/60 dark:border-white/20 bg-white/80 dark:bg-white/5",children:"SEL friendly"}),e.jsx("span",{className:"px-3 py-1 rounded-full border border-white/60 dark:border-white/20 bg-white/80 dark:bg-white/5",children:d>=90?"Spotlight":"Steady growth"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`flex-1 px-4 py-2.5 rounded-full text-sm font-semibold text-white shadow-lg shadow-primary/30 hover:-translate-y-0.5 transition bg-gradient-to-r ${r.accent}`,children:"Pulse profile"}),e.jsx("button",{className:"flex-1 px-4 py-2.5 rounded-full border border-white/60 dark:border-white/20 text-slate-900 dark:text-white bg-white/85 dark:bg-white/5 shadow-inner hover:-translate-y-0.5 transition",onClick:()=>_(t),children:"Assign"})]})]})]},t.name)})}),e.jsxs("div",{ref:u,className:"mt-8 flex flex-col items-center gap-2 text-xs font-semibold text-muted-foreground","data-aos":"fade-up",children:[e.jsxs("span",{children:["Showing ",g.length," of ",o.length," mentors"]}),g.length<o.length?e.jsx("span",{className:"px-3 py-1 rounded-full border border-white/60 dark:border-white/10 bg-white/70 dark:bg-white/5 text-[0.65rem] uppercase tracking-[0.3em]",children:"Scroll to load more"}):e.jsx("span",{className:"px-3 py-1 rounded-full border border-emerald-200/60 bg-emerald-50 text-emerald-600 text-[0.65rem] uppercase tracking-[0.3em]",children:"All mentors loaded"})]}),p&&e.jsx(T,{open:!!p,mentor:p,students:x,onClose:()=>m(null),onAssigned:()=>{m(null),h?.()}})]})})};E.displayName="AdminMentorsPanel";const Q=i.memo(E);export{Q as default};
