import{r as i,u as L,b,N as E,O as H,j as e,U as k,T as A,Q as R,S as _,H as $,a as V,v as O,m as P,B as W,V as z}from"./index-BeQwOtyQ.js";import{C as p,a as N,b as y,c as g}from"./card-D-goIzvr.js";import{S as F,a as Q,b as q,c as Y,d as G}from"./select-8ieQIdtG.js";import{B as U}from"./badge-CKD0dT5b.js";import{P as T}from"./progress-DgT_-UGw.js";import{M as I}from"./message-circle-CTFW4W9G.js";import"./index-CZajb2CL.js";import"./chevron-down-B-g9NK3J.js";const B=i.memo(({selectedUser:u,onUserSelect:w,selectedPeriod:d,loading:v})=>{const x=L(),{users:o}=b(s=>s.users),{checkinHistory:m}=b(s=>s.checkin),[n,M]=i.useState(u?.id||"");i.useEffect(()=>{o.length===0&&x(E())},[x,o.length]),i.useEffect(()=>{n&&x(H({page:1,limit:50}))},[x,n]);const D=s=>{M(s);const t=o.find(a=>a.id===s);w(t)},r=i.useMemo(()=>!n||!m?[]:m.filter(s=>s.userId===n),[n,m]),l=i.useMemo(()=>{if(r.length===0)return null;const s=r.slice(0,7),t=s.reduce((j,h)=>j+h.presenceLevel,0)/s.length,a=s.reduce((j,h)=>j+h.capacityLevel,0)/s.length,c={};s.forEach(j=>{j.selectedMoods?.forEach(h=>{c[h]=(c[h]||0)+1})});const S=Object.entries(c).sort(([,j],[,h])=>h-j).slice(0,3);return{avgPresence:Math.round(t*10)/10,avgCapacity:Math.round(a*10)/10,topMoods:S,checkinCount:s.length,trend:t>6?"improving":t<4?"concerning":"stable"}},[r]),C=i.useMemo(()=>r.filter(s=>s.details).slice(0,5).map(s=>({date:new Date(s.date).toLocaleDateString(),details:s.details,weatherType:s.weatherType,moods:s.selectedMoods})),[r]),f=o.find(s=>s.id===n);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),"Select User for Individual Analysis"]})}),e.jsx(g,{children:e.jsxs(F,{value:n,onValueChange:D,children:[e.jsx(Q,{className:"w-full",children:e.jsx(q,{placeholder:"Choose a user to analyze..."})}),e.jsx(Y,{children:o.map(s=>e.jsxs(G,{value:s.id,children:[s.name," â€” ",s.role," ",s.department&&`(${s.department})`]},s.id))})]})})]}),f&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),f.name,"'s Emotional Wellness Overview"]})}),e.jsxs(g,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:r.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Check-ins"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l?.avgPresence||"N/A"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Presence (7d)"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l?.avgCapacity||"N/A"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Capacity (7d)"})]})]}),l&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Weekly Trend:"}),e.jsx(U,{variant:l.trend==="improving"?"default":l.trend==="concerning"?"destructive":"secondary",children:l.trend})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Presence Level"}),e.jsxs("span",{children:[l.avgPresence,"/10"]})]}),e.jsx(T,{value:l.avgPresence*10,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Capacity Level"}),e.jsxs("span",{children:[l.avgCapacity,"/10"]})]}),e.jsx(T,{value:l.avgCapacity*10,className:"h-2"})]})]}),l.topMoods.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"font-medium text-sm",children:"Most Common Moods (7 days):"}),e.jsx("div",{className:"flex gap-2 mt-2",children:l.topMoods.map(([s,t])=>e.jsxs(U,{variant:"outline",children:[s," (",t,")"]},s))})]})]})]})]}),e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Recent Reflections & Thoughts"]})}),e.jsx(g,{children:C.length>0?e.jsx("div",{className:"space-y-4",children:C.map((s,t)=>e.jsxs("div",{className:"border-l-4 border-primary/20 pl-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.date}),e.jsx(U,{variant:"outline",className:"text-xs",children:s.weatherType})]}),e.jsx("p",{className:"text-sm mb-2",children:s.details}),s.moods&&s.moods.length>0&&e.jsx("div",{className:"flex gap-1",children:s.moods.map(a=>e.jsx(U,{variant:"secondary",className:"text-xs",children:a},a))})]},t))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(I,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No reflections recorded yet"})]})})]}),e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Emotional Patterns & Insights"]})}),e.jsx(g,{children:r.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Weather Patterns"}),e.jsx("div",{className:"space-y-1 text-sm",children:Object.entries(r.reduce((s,t)=>(s[t.weatherType]=(s[t.weatherType]||0)+1,s),{})).sort(([,s],[,t])=>t-s).slice(0,3).map(([s,t])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:s}),e.jsxs("span",{className:"text-muted-foreground",children:[t," times"]})]},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Common Challenges"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[r.filter(s=>s.capacityLevel<5).length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Low capacity days"}),e.jsxs("span",{className:"text-muted-foreground",children:[r.filter(s=>s.capacityLevel<5).length," times"]})]}),r.filter(s=>s.presenceLevel<5).length>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Low presence days"}),e.jsxs("span",{className:"text-muted-foreground",children:[r.filter(s=>s.presenceLevel<5).length," times"]})]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium mb-2",children:"AI Insights Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.length>0?`${f.name} has completed ${r.length} emotional check-ins. `+(l?.trend==="improving"?"Recent trends show positive emotional progress.":l?.trend==="concerning"?"Recent patterns suggest additional support may be beneficial.":"Emotional patterns appear stable overall."):"No check-in data available yet."})]})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx($,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No emotional pattern data available"}),e.jsx("p",{className:"text-xs mt-2",children:"User hasn't completed any check-ins yet"})]})})]})]}),!n&&e.jsx(p,{children:e.jsxs(g,{className:"text-center py-12",children:[e.jsx(k,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select a User"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose a user from the dropdown above to view their detailed emotional wellness analysis"})]})})]})});B.displayName="IndividualView";const J=i.memo(()=>{const u=L(),w=V(),{userId:d}=O(),{user:v}=b(a=>a.auth),{checkinHistory:x}=b(a=>a.checkin),{users:o}=b(a=>a.users),[m,n]=i.useState(null),[M,D]=i.useState("week"),[r,l]=i.useState(!1);i.useEffect(()=>{if(o.length>0){if(d){const a=o.find(c=>c.id===d);a&&n(a)}else if(v){const a=o.find(c=>c.id===v.id);a&&n(a)}}},[v,o,d]),i.useEffect(()=>{(async()=>{l(!0);try{await Promise.all([u(E()),u(H({page:1,limit:100}))])}catch(c){console.error("Error loading dashboard data:",c)}finally{l(!1)}})()},[u]);const C=a=>{n(a)},f=()=>{w("/emotional-checkin/dashboard")},s=()=>{w("/emotional-wellness")},t=a=>{if(!a?.gender)return a?.name||"User";const c=a.gender==="male"?"Mr.":a.gender==="female"?"Ms.":"",S=a.username||a.name||"User";return c?`${c} ${S}`:S};return e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-gold/5"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_30%_20%,rgba(120,119,198,0.1),transparent_50%)]"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-full h-full bg-[radial-gradient(circle_at_70%_80%,rgba(255,215,0,0.05),transparent_50%)]"}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[e.jsxs(P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(W,{variant:"ghost",onClick:d?s:f,className:"flex items-center gap-2 hover:bg-primary/10",children:[e.jsx(z,{className:"w-4 h-4"}),d?"Back to My Dashboard":"Back to Main Dashboard"]})}),e.jsxs("div",{className:"text-right",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-primary to-gold bg-clip-text text-transparent",children:d?"User Report":"Individual Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:d?"Detailed emotional wellness report":"Your personal emotional wellness overview"})]})]}),e.jsx(p,{className:"glass glass-card border-primary/20",children:e.jsx(g,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-gold flex items-center justify-center",children:e.jsx(k,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:d?`Report for ${t(m)}`:`Welcome back, ${t(v)}!`}),e.jsx("p",{className:"text-muted-foreground",children:d?"Detailed emotional wellness analysis for this user":"Here's your comprehensive emotional wellness analysis"})]})]})})})]}),e.jsx(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsx(B,{selectedUser:m,onUserSelect:C,selectedPeriod:M,loading:r,isPersonalView:!0})}),m&&e.jsx(P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"mt-6",children:e.jsxs(p,{className:"glass glass-card",children:[e.jsx(N,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Quick Summary"]})}),e.jsx(g,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:x?.filter(a=>a.userId===m.id).length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Check-ins"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x?.filter(a=>a.userId===m.id&&a.presenceLevel>=7).length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"High Presence Days"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x?.filter(a=>a.userId===m.id&&a.capacityLevel>=7).length||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"High Capacity Days"})]})]})})]})})]})]})});J.displayName="IndividualDashboard";export{J as default};
