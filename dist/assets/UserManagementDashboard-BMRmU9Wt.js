const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UserStatsOverview-DDClpNnK.js","assets/index-By89xKr2.js","assets/index-BIij6wor.css","assets/users-DVOWKIDY.js","assets/crown-C4evLXne.js","assets/graduation-cap-CdYH18kJ.js","assets/user-check-CvQCSpkr.js","assets/building-XOT6oT02.js","assets/UserTable-_ITKRw4n.js","assets/button-CxFXEbtd.js","assets/Combination-DVP7oUno.js","assets/chevron-right-BsIuLt-o.js","assets/badge-Cuwsx3AA.js","assets/eye-DXXiEsU-.js","assets/UserFilters-MAkcLeGL.js","assets/input-MSmqLRGH.js","assets/select-Bxsj9Vap.js","assets/chevron-down-Csr-J5s7.js","assets/funnel-9gagQDpy.js","assets/plus-DX90lGge.js","assets/download-BnkN9bfu.js","assets/search-CIoI1Mov.js","assets/UserForm-DPGf43x_.js","assets/dialog-DZIhk9tM.js","assets/user-C8RE51YT.js","assets/calendar-BB_Xw2y-.js","assets/save-Di-wYj8u.js","assets/OrganizationChart-Clp1-8Lo.js","assets/UserDetailsModal-2gmukrII.js","assets/clock-Lwcydpfn.js"])))=>i.map(i=>d[i]);
import{r as a,u as L,d as M,b as w,E as h,F as p,G as E,I,J as V,K as H,N as G,j as e,H as J,m as n,A as v,_ as c}from"./index-By89xKr2.js";import{A as S}from"./AnimatedPage-BSSlZpHn.js";const K=a.lazy(()=>c(()=>import("./UserStatsOverview-DDClpNnK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),W=a.lazy(()=>c(()=>import("./UserTable-_ITKRw4n.js"),__vite__mapDeps([8,1,2,9,10,11,12,13]))),Y=a.lazy(()=>c(()=>import("./UserFilters-MAkcLeGL.js"),__vite__mapDeps([14,1,2,9,15,16,10,17,12,18,19,20,21]))),$=a.lazy(()=>c(()=>import("./UserForm-DPGf43x_.js"),__vite__mapDeps([22,1,2,9,15,23,10,16,17,24,25,26]))),q=a.lazy(()=>c(()=>import("./OrganizationChart-Clp1-8Lo.js"),__vite__mapDeps([27,1,2,7,4,24,5,3]))),B=a.lazy(()=>c(()=>import("./UserDetailsModal-2gmukrII.js"),__vite__mapDeps([28,1,2,9,12,23,10,15,16,17,7,5,3,19,24,25,29]))),m=a.memo(()=>e.jsx("div",{className:"glass glass-card p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-muted/30 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-muted/20 rounded w-2/3"})]})}));m.displayName="LoadingFallback";const Q=a.memo(()=>{const t=L(),{toast:r}=M(),{users:y,organizationStructure:l,pagination:f,filters:i,loading:D,error:N,lastUpdated:A}=w(s=>s.users),{user:x}=w(s=>s.auth),[z,u]=a.useState(!1),[g,j]=a.useState(null),[_,U]=a.useState(null),[d,k]=a.useState("overview"),b=x&&(x.role==="directorate"||x.role==="superadmin"||x.role==="admin");a.useEffect(()=>{b&&(t(h(i)),t(p()))},[t,b,i]);const C=a.useCallback(s=>{t(E(s))},[t]),F=a.useCallback(async s=>{try{await t(I(s)).unwrap(),r({title:"Success",description:"User created successfully"}),u(!1),t(h(i)),t(p())}catch(o){r({title:"Error",description:o||"Failed to create user",variant:"destructive"})}},[t,r,i]),O=a.useCallback(async(s,o)=>{try{await t(V({userId:s,userData:o})).unwrap(),r({title:"Success",description:"User updated successfully"}),j(null),u(!1),t(h(i)),t(p())}catch(T){r({title:"Error",description:T||"Failed to update user",variant:"destructive"})}},[t,r,i]),P=a.useCallback(async s=>{if(window.confirm("Are you sure you want to deactivate this user?"))try{await t(H(s)).unwrap(),r({title:"Success",description:"User deactivated successfully"}),t(h(i)),t(p())}catch(o){r({title:"Error",description:o||"Failed to deactivate user",variant:"destructive"})}},[t,r,i]),R=a.useCallback(s=>{t(E({...i,page:s}))},[t,i]);return a.useEffect(()=>()=>{t(G())},[t]),b?e.jsxs(S,{children:[e.jsxs(J,{children:[e.jsx("title",{children:"User Management â€” Millennia World School"}),e.jsx("meta",{name:"description",content:"Advanced user management system for school administration"})]}),e.jsxs("div",{className:"min-h-screen text-foreground relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 left-0 w-64 h-64 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-96 h-96 bg-accent/5 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative z-10 container-tight py-4 md:py-6",children:[e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"User Management Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users, roles, and organizational structure"})]}),e.jsx(v,{children:N&&e.jsx(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:e.jsx("p",{className:"text-destructive text-sm",children:N})})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex space-x-1 bg-muted/30 p-1 rounded-lg",children:[{id:"overview",label:"Overview",icon:"ðŸ“Š"},{id:"users",label:"Users",icon:"ðŸ‘¥"},{id:"organization",label:"Organization",icon:"ðŸ¢"},{id:"analytics",label:"Analytics",icon:"ðŸ“ˆ"}].map(s=>e.jsxs("button",{onClick:()=>k(s.id),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all ${d===s.id?"bg-background shadow-sm text-foreground":"text-muted-foreground hover:text-foreground"}`,children:[e.jsx("span",{className:"mr-2",children:s.icon}),s.label]},s.id))})}),e.jsxs(v,{mode:"wait",children:[d==="overview"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(K,{organizationStructure:l,totalUsers:f.totalUsers,lastUpdated:A})})},"overview"),d==="users"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{filters:i,onFiltersChange:C,onAddUser:()=>u(!0)})}),e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(W,{users:y,loading:D,pagination:f,onPageChange:R,onEditUser:j,onDeleteUser:P,onViewUser:U})})]})},"users"),d==="organization"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsx(a.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(q,{organizationStructure:l,users:y})})},"organization"),d==="analytics"&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Department Analytics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l?.stats?.byDepartment?.map(s=>e.jsxs("div",{className:"p-4 bg-muted/30 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s._id}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"members"})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Role Distribution"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:l?.stats?.byRole?.map(s=>e.jsxs("div",{className:"text-center p-4 bg-muted/20 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s._id})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Employment Status"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:l?.stats?.byEmploymentStatus?.map(s=>e.jsxs("div",{className:"text-center p-4 bg-muted/20 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:s.count}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s._id})]},s._id))})]}),e.jsxs("div",{className:"glass glass-card p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Management Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-700 mb-2",children:"Leadership Structure"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Directorate members oversee ",l?.stats?.totalUsers||0," total users across ",l?.stats?.byDepartment?.length||0," departments."]})]}),e.jsxs("div",{className:"p-4 bg-green/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-700 mb-2",children:"Teaching Staff"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l?.stats?.byRole?.find(s=>s._id==="teacher")?.count||0," teachers and ",l?.stats?.byRole?.find(s=>s._id==="se_teacher")?.count||0," SE teachers are actively managing classroom assignments."]})]})]})]})]})},"analytics")]}),e.jsxs(v,{children:[(z||g)&&e.jsx(a.Suspense,{fallback:null,children:e.jsx($,{user:g,onSubmit:g?O:F,onCancel:()=>{u(!1),j(null)}})}),_&&e.jsx(a.Suspense,{fallback:null,children:e.jsx(B,{user:_,onClose:()=>U(null)})})]})]})]})]}):e.jsx(S,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"glass glass-card p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to access the User Management Dashboard."})]})})})});Q.displayName="UserManagementDashboard";export{Q as default};
